<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>E-Learning: Quản lý Hóa đơn đầu vào - KiotViet</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800;900&family=Playfair+Display:wght@700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>

    <style>
        body { font-family: 'Inter', sans-serif; background-color: #f0f9ff; overflow-x: hidden; }
        ::-webkit-scrollbar { width: 6px; }
        ::-webkit-scrollbar-track { background: transparent; }
        ::-webkit-scrollbar-thumb { background: #93c5fd; border-radius: 3px; }
        ::-webkit-scrollbar-thumb:hover { background: #3b82f6; }
        
        /* Background */
        .soft-glow-background { position: fixed; top: 0; left: 0; width: 100%; height: 100%; z-index: -10; background: linear-gradient(135deg, #ffffff 0%, #e0f2fe 50%, #dcfce7 100%); }
        .soft-glow-background .shape { position: absolute; filter: blur(120px); opacity: 0.6; }
        .soft-glow-background .shape1 { height: 300px; width: 300px; background: #bae6fd; border-radius: 50%; top: -50px; left: -50px; animation: moveInCircle 25s ease-in-out infinite; }
        .soft-glow-background .shape2 { height: 350px; width: 350px; background: #bbf7d0; border-radius: 50%; bottom: -50px; right: -50px; animation: moveVertical 30s ease-in-out infinite; }
        @keyframes moveInCircle { 0% { transform: rotate(0deg); } 50% { transform: rotate(180deg); } 100% { transform: rotate(360deg); } }
        @keyframes moveVertical { 0% { transform: translateY(-20%); } 50% { transform: translateY(20%); } 100% { transform: translateY(-20%); } }

        /* UI Elements */
        .nav-link { transition: all 0.2s ease; border-left: 3px solid transparent; }
        .nav-link:hover { color: #2563eb; background: rgba(255, 255, 255, 0.6); }
        .nav-link.active { color: #1e3a8a; border-left: 3px solid #2563eb; background: #eff6ff; font-weight: 600; box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.05); }

        /* Card Flip */
        .perspective-1000 { perspective: 1000px; }
        .card-inner { position: relative; width: 100%; height: 100%; transition: transform 0.6s cubic-bezier(0.4, 0, 0.2, 1); transform-style: preserve-3d; }
        .card-inner.flipped { transform: rotateY(180deg); }
        .card-face { position: absolute; top: 0; left: 0; width: 100%; height: 100%; backface-visibility: hidden; border-radius: 1rem; box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1); }
        .card-back { transform: rotateY(180deg); }
        
        /* Chat */
        .chat-bubble { max-width: 85%; padding: 0.75rem 1rem; border-radius: 1rem; position: relative; font-size: 0.9rem; line-height: 1.5; }
        .chat-bubble-customer { background-color: #f1f5f9; color: #334155; border-bottom-left-radius: 0.25rem; margin-left: 2.5rem; }
        .chat-bubble-consultant { background-color: #eff6ff; color: #1e40af; border-bottom-right-radius: 0.25rem; margin-right: 2.5rem; border: 1px solid #dbeafe; }
        .chat-avatar { position: absolute; bottom: 0; width: 2rem; height: 2rem; border-radius: 50%; background-size: cover; border: 2px solid white; box-shadow: 0 2px 4px rgba(0,0,0,0.1); }
        
        /* Animation & Effects */
        .animate-fade-in-up { animation: fadeInUp 0.5s ease-out; }
        @keyframes fadeInUp { from { opacity: 0; transform: translateY(20px); } to { opacity: 1; transform: translateY(0); } }
        .shake-effect { animation: shake 0.5s cubic-bezier(.36,.07,.19,.97) both; }
        @keyframes shake { 10%, 90% { transform: translate3d(-1px, 0, 0); } 20%, 80% { transform: translate3d(2px, 0, 0); } 30%, 50%, 70% { transform: translate3d(-4px, 0, 0); } 40%, 60% { transform: translate3d(4px, 0, 0); } }
        .pop-effect { animation: pop 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275); }
        @keyframes pop { 0% { transform: scale(1); } 50% { transform: scale(1.05); } 100% { transform: scale(1); } }

        /* Mobile Sidebar Overlay */
        #mobile-overlay { transition: opacity 0.3s ease; }
        #sidebar { transition: transform 0.3s ease; }
        .sidebar-open #sidebar { transform: translateX(0); }
        .sidebar-open #mobile-overlay { opacity: 1; pointer-events: auto; }
        .sidebar-closed #sidebar { transform: translateX(-100%); }
        .sidebar-closed #mobile-overlay { opacity: 0; pointer-events: none; }
        @media (min-width: 768px) { .sidebar-closed #sidebar { transform: translateX(0); } }

        /* Certificate */
        .certificate-border { border: 2px solid #e2e8f0; background-color: #fff; background-image: radial-gradient(circle at center, #ffffff 0%, #f0f9ff 100%); }
        .watermark { position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%) rotate(-30deg); font-size: 4rem; font-weight: 900; color: rgba(200, 0, 0, 0.1); pointer-events: none; z-index: 0; white-space: nowrap; }
        @media (min-width: 768px) { .watermark { font-size: 8rem; } }
    </style>
</head>
<body class="text-slate-700 antialiased h-screen flex flex-col overflow-hidden sidebar-closed" id="app-body">
    <div class="soft-glow-background"><div class="shape shape1"></div><div class="shape shape2"></div></div>

    <!-- Header -->
    <header class="sticky top-0 z-40 bg-white/80 backdrop-blur-md border-b border-white/50 h-16 shadow-sm flex-shrink-0">
        <div class="max-w-7xl mx-auto px-4 h-full flex items-center justify-between">
            <div class="flex items-center gap-4">
                <!-- Mobile Menu Button -->
                <button onclick="toggleSidebar()" class="md:hidden text-slate-600 hover:text-blue-600 p-1">
                    <i class="fa-solid fa-bars text-xl"></i>
                </button>
                <!-- Logo -->
                <a href="#" class="flex items-center gap-2 select-none">
                    <img src="https://logo.kiotviet.vn/KiotViet-Logo-Horizontal.svg" alt="Logo" class="h-6">
                    <span class="hidden sm:inline text-slate-300 text-xl">|</span>
                    <span class="hidden sm:inline font-bold text-transparent bg-clip-text bg-gradient-to-r from-blue-700 to-green-700 text-base uppercase">Learning</span>
                </a>
            </div>
            <!-- Back Button -->
            <a href="https://kiotvietlnd.github.io/elearning/thuehkd/" class="flex items-center gap-2 text-xs sm:text-sm font-bold text-slate-600 hover:text-blue-700 bg-white/50 px-3 py-1.5 rounded-full border border-slate-100 shadow-sm">
                <i class="fa-solid fa-arrow-left"></i> <span class="hidden xs:inline">Quay lại Cẩm nang</span>
            </a>
        </div>
    </header>

    <!-- Main Container -->
    <div class="flex-1 flex overflow-hidden relative">
        <!-- Mobile Overlay -->
        <div id="mobile-overlay" class="fixed inset-0 bg-black/20 z-40 md:hidden" onclick="toggleSidebar()"></div>

        <!-- Sidebar -->
        <aside id="sidebar" class="absolute inset-y-0 left-0 z-50 w-72 bg-white/95 backdrop-blur-xl border-r border-white/60 shadow-2xl md:static md:bg-white/60 md:shadow-lg md:rounded-r-2xl flex flex-col transform transition-transform duration-300">
            <div class="p-5 border-b border-slate-100 flex-shrink-0">
                <div class="flex justify-between items-start mb-4 md:hidden">
                     <img src="https://logo.kiotviet.vn/KiotViet-Logo-Horizontal.svg" alt="Logo" class="h-5">
                     <button onclick="toggleSidebar()" class="text-slate-400"><i class="fa-solid fa-xmark text-xl"></i></button>
                </div>
                <h2 class="font-black text-blue-800 text-lg leading-tight mb-2 uppercase">QUẢN LÝ HÓA ĐƠN ĐẦU VÀO</h2>
                <h3 class="font-bold text-blue-900 text-sm uppercase tracking-wider mb-2">MỤC LỤC BÀI HỌC</h3>
                <div class="w-full bg-slate-200 rounded-full h-1.5"><div id="totalProgress" class="bg-gradient-to-r from-blue-500 to-green-500 h-1.5 rounded-full transition-all duration-500" style="width: 0%"></div></div>
                <div class="flex justify-between mt-1 text-[10px] text-slate-500 font-medium"><span id="completedCount">0/0</span><span>Đã hoàn thành</span></div>
            </div>
            <nav class="flex-1 overflow-y-auto p-3 space-y-1 custom-scrollbar">
                <button onclick="switchTab('cheatsheet')" id="nav-cheatsheet" class="nav-link w-full text-left px-3 py-3 rounded-lg flex items-center gap-3 active">
                    <div class="w-8 h-8 rounded-full bg-yellow-100 text-yellow-600 flex items-center justify-center flex-shrink-0"><i class="fa-solid fa-bolt"></i></div>
                    <span class="font-bold text-sm">Tóm tắt nhanh</span>
                </button>
                <div class="py-2 px-3 text-[11px] font-bold text-slate-500 uppercase tracking-widest mt-2">Nội dung học tập</div>
                
                <button onclick="switchTab('part1')" id="nav-part1" class="nav-link w-full text-left px-3 py-3 rounded-lg flex items-center gap-3">
                    <span class="w-6 h-6 rounded bg-blue-100 text-blue-600 flex items-center justify-center flex-shrink-0 text-xs font-bold">1</span>
                    <span class="font-medium text-sm">Tổng quan & Lợi ích</span>
                </button>
                <button onclick="switchTab('part2')" id="nav-part2" class="nav-link w-full text-left px-3 py-3 rounded-lg flex items-center gap-3">
                    <span class="w-6 h-6 rounded bg-blue-100 text-blue-600 flex items-center justify-center flex-shrink-0 text-xs font-bold">2</span>
                    <span class="font-medium text-sm">Kết nối & Đồng bộ</span>
                </button>
                <button onclick="switchTab('part3')" id="nav-part3" class="nav-link w-full text-left px-3 py-3 rounded-lg flex items-center gap-3">
                    <span class="w-6 h-6 rounded bg-blue-100 text-blue-600 flex items-center justify-center flex-shrink-0 text-xs font-bold">3</span>
                    <span class="font-medium text-sm">Khớp dữ liệu thông minh</span>
                </button>
                <button onclick="switchTab('part4')" id="nav-part4" class="nav-link w-full text-left px-3 py-3 rounded-lg flex items-center gap-3">
                    <span class="w-6 h-6 rounded bg-blue-100 text-blue-600 flex items-center justify-center flex-shrink-0 text-xs font-bold">4</span>
                    <span class="font-medium text-sm">Tạo phiếu & Nâng cao</span>
                </button>

                <div class="py-2 px-3 text-[11px] font-bold text-slate-500 uppercase tracking-widest mt-2">Ôn tập</div>
                <button onclick="switchTab('summary')" id="nav-summary" class="nav-link w-full text-left px-3 py-3 rounded-lg flex items-center gap-3">
                    <div class="w-6 h-6 rounded bg-purple-100 text-purple-600 flex items-center justify-center flex-shrink-0 text-xs"><i class="fa-solid fa-table-columns"></i></div>
                    <span class="font-medium text-sm">Bảng so sánh</span>
                </button>
                <button onclick="switchTab('game')" id="nav-game" class="nav-link w-full text-left px-3 py-3 rounded-lg flex items-center gap-3">
                    <div class="w-6 h-6 rounded bg-orange-100 text-orange-600 flex items-center justify-center flex-shrink-0 text-xs"><i class="fa-solid fa-gamepad"></i></div>
                    <span class="font-bold text-sm text-orange-600">Quiz Game</span>
                </button>
            </nav>
            <div class="p-4 bg-slate-50 border-t border-slate-100 text-center text-[10px] text-slate-400">© KiotViet Learning & Development Department</div>
        </aside>

        <!-- Main Content -->
        <main class="flex-1 overflow-y-auto scroll-smooth p-4 md:p-8" id="contentArea">
            <div class="max-w-4xl mx-auto pb-20">
                
                <!-- CHEATSHEET -->
                <div id="tab-cheatsheet" class="tab-content block animate-fade-in-up">
                    <div class="mb-6 text-center">
                        <span class="bg-blue-100 text-blue-700 px-3 py-1 rounded-full text-[10px] sm:text-xs font-bold uppercase tracking-wider">Đào tạo Sản phẩm</span>
                        <h1 class="text-2xl sm:text-3xl font-black text-blue-900 mt-3 mb-2">QUẢN LÝ HÓA ĐƠN ĐẦU VÀO</h1>
                        <p class="text-slate-500 text-sm italic">Tự động đồng bộ hóa đơn từ Cơ quan Thuế về KiotViet.</p>
                    </div>

                    <div class="grid md:grid-cols-2 gap-6">
                        <!-- Benefits -->
                        <div class="bg-white p-6 rounded-2xl shadow-sm border border-slate-100">
                            <h2 class="text-lg font-bold text-blue-800 mb-4 flex items-center gap-2"><i class="fa-solid fa-star text-yellow-400"></i> Lợi ích cốt lõi</h2>
                            <ul class="space-y-4">
                                <li class="flex gap-3">
                                    <div class="w-8 h-8 rounded-full bg-blue-50 text-blue-600 flex items-center justify-center flex-shrink-0"><i class="fa-solid fa-gauge-high"></i></div>
                                    <div>
                                        <h3 class="font-bold text-slate-800 text-sm">Tốc độ vượt trội</h3>
                                        <p class="text-xs text-slate-500 mt-1">Loại bỏ thao tác nhập tay, tiết kiệm đáng kể thời gian tạo phiếu nhập hàng.</p>
                                    </div>
                                </li>
                                <li class="flex gap-3">
                                    <div class="w-8 h-8 rounded-full bg-green-50 text-green-600 flex items-center justify-center flex-shrink-0"><i class="fa-solid fa-shield-halved"></i></div>
                                    <div>
                                        <h3 class="font-bold text-slate-800 text-sm">Chuẩn xác & Hợp pháp</h3>
                                        <p class="text-xs text-slate-500 mt-1">Đồng bộ trực tiếp từ CQT, loại bỏ sai sót nhập liệu và rủi ro hóa đơn giả.</p>
                                    </div>
                                </li>
                                <li class="flex gap-3">
                                    <div class="w-8 h-8 rounded-full bg-purple-50 text-purple-600 flex items-center justify-center flex-shrink-0"><i class="fa-solid fa-brain"></i></div>
                                    <div>
                                        <h3 class="font-bold text-slate-800 text-sm">Thông minh & Tự động</h3>
                                        <p class="text-xs text-slate-500 mt-1">Hệ thống ghi nhớ thói quen khớp dữ liệu Nhà cung cấp & Hàng hóa cho lần sau.</p>
                                    </div>
                                </li>
                            </ul>
                        </div>

                        <!-- Process -->
                        <div class="bg-white p-6 rounded-2xl shadow-sm border border-slate-100">
                             <h2 class="text-lg font-bold text-blue-800 mb-4 flex items-center gap-2"><i class="fa-solid fa-list-check text-blue-500"></i> Quy trình 4 bước</h2>
                             <div class="relative pl-4 border-l-2 border-slate-200 space-y-6">
                                <div class="relative">
                                    <div class="absolute -left-[21px] top-0 w-4 h-4 rounded-full bg-white border-2 border-blue-500"></div>
                                    <h3 class="text-sm font-bold text-slate-800">1. Kết nối</h3>
                                    <p class="text-xs text-slate-500 mt-0.5">Dùng tài khoản CQT cấp để đăng nhập.</p>
                                </div>
                                <div class="relative">
                                    <div class="absolute -left-[21px] top-0 w-4 h-4 rounded-full bg-white border-2 border-blue-500"></div>
                                    <h3 class="text-sm font-bold text-slate-800">2. Đồng bộ</h3>
                                    <p class="text-xs text-slate-500 mt-0.5">Tải hóa đơn về theo khoảng thời gian.</p>
                                </div>
                                <div class="relative">
                                    <div class="absolute -left-[21px] top-0 w-4 h-4 rounded-full bg-white border-2 border-blue-500"></div>
                                    <h3 class="text-sm font-bold text-slate-800">3. Khớp dữ liệu</h3>
                                    <p class="text-xs text-slate-500 mt-0.5">Ghép nối Nhà cung cấp và Hàng hóa (Hệ thống gợi ý).</p>
                                </div>
                                <div class="relative">
                                    <div class="absolute -left-[21px] top-0 w-4 h-4 rounded-full bg-white border-2 border-blue-500"></div>
                                    <h3 class="text-sm font-bold text-slate-800">4. Tạo phiếu</h3>
                                    <p class="text-xs text-slate-500 mt-0.5">Xác nhận số lượng và hoàn tất Phiếu nhập/Phiếu chi.</p>
                                </div>
                             </div>
                        </div>
                    </div>
                </div>

                <!-- PART 1 -->
                <div id="tab-part1" class="tab-content hidden animate-fade-in-up">
                    <div class="flex flex-col gap-4 mb-8">
                        <div class="chat-bubble chat-bubble-customer">
                            <div class="chat-avatar bg-[url('https://img.freepik.com/free-vector/businessman-character-avatar-isolated_24877-60111.jpg')] left-[-3rem]"></div>
                            <span class="font-bold block mb-1 text-[10px] uppercase text-slate-400">Chủ cửa hàng</span>
                            Ngày nào cũng nhập tay cả chồng hóa đơn giấy thế này, vừa lâu vừa dễ sai sót quá em ạ.
                        </div>
                        <div class="chat-bubble chat-bubble-consultant self-end">
                            <div class="chat-avatar bg-[url('https://cdn-icons-png.flaticon.com/512/4233/4233830.png')] right-[-3rem]"></div>
                            <span class="font-bold block mb-1 text-[10px] uppercase text-blue-300 text-right">Chuyên viên KiotViet</span>
                            Anh yên tâm! Với tính năng "Hóa đơn đầu vào", KiotViet sẽ tự động lấy dữ liệu từ Cơ quan Thuế về, anh chỉ cần kiểm tra và bấm nút là xong phiếu nhập ngay.
                        </div>
                    </div>
                    <div id="cards-part1" class="grid sm:grid-cols-2 gap-6"></div>
                </div>

                <!-- PART 2 -->
                <div id="tab-part2" class="tab-content hidden animate-fade-in-up">
                    <div class="flex flex-col gap-4 mb-8">
                        <div class="chat-bubble chat-bubble-customer">
                            <div class="chat-avatar bg-[url('https://img.freepik.com/free-vector/businessman-character-avatar-isolated_24877-60111.jpg')] left-[-3rem]"></div>
                            <span class="font-bold block mb-1 text-[10px] uppercase text-slate-400">Chủ cửa hàng</span>
                            Để bắt đầu dùng thì anh đăng nhập bằng tài khoản KiotViet hiện tại vào trang Thuế là được đúng không?
                        </div>
                        <div class="chat-bubble chat-bubble-consultant self-end">
                            <div class="chat-avatar bg-[url('https://cdn-icons-png.flaticon.com/512/4233/4233830.png')] right-[-3rem]"></div>
                            <span class="font-bold block mb-1 text-[10px] uppercase text-blue-300 text-right">Chuyên viên KiotViet</span>
                            Dạ chưa đúng ạ. Anh cần dùng tài khoản riêng do Cơ quan Thuế cấp cho doanh nghiệp mình để thiết lập kết nối lần đầu trên KiotViet nhé.
                        </div>
                    </div>
                    <div id="cards-part2" class="grid sm:grid-cols-2 gap-6"></div>
                </div>

                <!-- PART 3 -->
                <div id="tab-part3" class="tab-content hidden animate-fade-in-up">
                    <div class="flex flex-col gap-4 mb-8">
                        <div class="chat-bubble chat-bubble-customer">
                            <div class="chat-avatar bg-[url('https://img.freepik.com/free-vector/businessman-character-avatar-isolated_24877-60111.jpg')] left-[-3rem]"></div>
                            <span class="font-bold block mb-1 text-[10px] uppercase text-slate-400">Chủ cửa hàng</span>
                            Nhưng tên hàng nhà cung cấp viết khác với tên hàng trên KiotViet của mình, hệ thống có hiểu được không?
                        </div>
                        <div class="chat-bubble chat-bubble-consultant self-end">
                            <div class="chat-avatar bg-[url('https://cdn-icons-png.flaticon.com/512/4233/4233830.png')] right-[-3rem]"></div>
                            <span class="font-bold block mb-1 text-[10px] uppercase text-blue-300 text-right">Chuyên viên KiotViet</span>
                            Hệ thống có cơ chế khớp thông minh anh nhé. Nó dựa trên độ trùng khớp tên hoặc anh có thể chỉ định lần đầu, lần sau máy sẽ tự nhớ.
                        </div>
                    </div>
                    <div id="cards-part3" class="grid sm:grid-cols-2 gap-6"></div>
                </div>

                <!-- PART 4 -->
                <div id="tab-part4" class="tab-content hidden animate-fade-in-up">
                    <div class="flex flex-col gap-4 mb-8">
                        <div class="chat-bubble chat-bubble-customer">
                            <div class="chat-avatar bg-[url('https://img.freepik.com/free-vector/businessman-character-avatar-isolated_24877-60111.jpg')] left-[-3rem]"></div>
                            <span class="font-bold block mb-1 text-[10px] uppercase text-slate-400">Chủ cửa hàng</span>
                            Hàng điện thoại có IMEI thì nhập thế nào? Với mấy hóa đơn tiền điện nước thì có cần tạo phiếu nhập kho không?
                        </div>
                        <div class="chat-bubble chat-bubble-consultant self-end">
                            <div class="chat-avatar bg-[url('https://cdn-icons-png.flaticon.com/512/4233/4233830.png')] right-[-3rem]"></div>
                            <span class="font-bold block mb-1 text-[10px] uppercase text-blue-300 text-right">Chuyên viên KiotViet</span>
                            Hàng IMEI anh cần nhập chi tiết số lượng thực tế nhé. Còn hóa đơn dịch vụ như điện nước, anh có thể tạo thẳng phiếu chi tiền mà không cần nhập kho ạ.
                        </div>
                    </div>
                    <div id="cards-part4" class="grid sm:grid-cols-2 gap-6"></div>
                </div>

                <!-- SUMMARY -->
                <div id="tab-summary" class="tab-content hidden animate-fade-in-up">
                     <h2 class="text-xl font-bold text-blue-900 mb-4 flex items-center gap-2"><i class="fa-solid fa-table-columns text-blue-500"></i> Bảng so sánh Nhận định</h2>
                     <div class="bg-white rounded-xl shadow-sm border border-slate-200 overflow-x-auto">
                        <table class="min-w-full divide-y divide-slate-100 text-sm">
                            <thead class="bg-slate-50">
                                <tr>
                                    <th class="px-4 py-3 text-left font-bold text-slate-500 w-10">#</th>
                                    <th class="px-4 py-3 text-center font-bold text-red-600 border-r border-slate-100">Lầm tưởng (Sai)</th>
                                    <th class="px-4 py-3 text-center font-bold text-green-600">Sự thật (Đúng)</th>
                                </tr>
                            </thead>
                            <tbody class="divide-y divide-slate-100" id="summaryTableBody"></tbody>
                        </table>
                     </div>
                </div>

                <!-- GAME -->
                <div id="tab-game" class="tab-content hidden animate-fade-in-up">
                    <!-- Start -->
                    <div id="game-start" class="text-center py-12 bg-white/80 backdrop-blur rounded-2xl border border-white shadow-sm">
                        <div class="inline-block p-4 rounded-full bg-orange-100 mb-4"><i class="fa-solid fa-gamepad text-4xl text-orange-500"></i></div>
                        <h2 class="text-2xl font-black text-slate-800 mb-2">Quiz Game</h2>
                        <p class="text-slate-600 mb-6 text-sm">Đạt 80% để nhận Chứng chỉ.</p>
                        <div class="mb-6 flex justify-center px-4">
                            <input type="text" id="player-name" placeholder="Nhập Họ và tên - Phòng ban" class="w-full max-w-xs px-4 py-3 rounded-lg border border-slate-300 focus:outline-none focus:ring-2 focus:ring-blue-400 text-center text-sm shadow-sm">
                        </div>
                        <div class="flex flex-col sm:flex-row justify-center gap-3 px-4">
                            <button onclick="startGame('standard')" class="bg-white border-2 border-blue-100 text-blue-600 px-6 py-3 rounded-xl font-bold hover:bg-blue-50 transition shadow-sm text-sm">Tiêu chuẩn (5 câu)</button>
                            <button onclick="startGame('promax')" class="bg-gradient-to-r from-orange-500 to-red-500 text-white px-6 py-3 rounded-xl font-bold shadow-lg hover:shadow-orange-200 transition text-sm">Promax (Full)</button>
                        </div>
                    </div>

                    <!-- Playing -->
                    <div id="game-playing" class="hidden max-w-2xl mx-auto">
                        <div class="flex justify-between items-center mb-4 px-2">
                            <div class="text-slate-400 text-xs font-bold uppercase">Câu hỏi: <span id="q-progress" class="text-orange-600">1/10</span></div>
                            <div class="text-xs font-bold bg-white px-2 py-1 rounded border shadow-sm">Điểm: <span id="current-score" class="text-green-600">0</span></div>
                        </div>
                        <div id="game-card" class="bg-white rounded-2xl shadow-lg p-6 min-h-[250px] flex items-center justify-center text-center border border-slate-100 mb-6 relative overflow-hidden">
                             <div class="absolute top-0 left-0 w-full h-1.5 bg-gradient-to-r from-blue-400 to-purple-400"></div>
                            <h3 id="question-text" class="text-lg md:text-xl font-bold text-slate-800 leading-snug">Loading...</h3>
                        </div>
                        <div class="grid grid-cols-2 gap-4">
                            <button onclick="answerGame(true)" class="py-4 rounded-xl bg-white border-2 border-green-100 text-green-600 font-bold hover:bg-green-50 shadow-sm">ĐÚNG</button>
                            <button onclick="answerGame(false)" class="py-4 rounded-xl bg-white border-2 border-red-100 text-red-600 font-bold hover:bg-red-50 shadow-sm">SAI</button>
                        </div>
                    </div>

                    <!-- Result -->
                    <div id="game-result" class="hidden text-center">
                        <div id="certificate" class="w-full aspect-video certificate-border p-4 sm:p-8 relative text-blue-900 bg-white shadow-lg flex flex-col justify-center items-center overflow-hidden mx-auto max-w-3xl">
                            <!-- Decor -->
                            <div class="absolute top-3 left-3 w-8 h-8 border-t-2 border-l-2 border-blue-700"></div>
                            <div class="absolute bottom-3 right-3 w-8 h-8 border-b-2 border-r-2 border-blue-700"></div>
                            <div id="fail-watermark" class="watermark hidden">MẪU / SAMPLE</div>
                            
                            <div class="relative z-10 w-full">
                                <h2 class="text-xl sm:text-3xl font-bold text-blue-800 mb-1 uppercase tracking-wide font-sans">GIẤY CHỨNG NHẬN</h2>
                                <p class="text-[10px] sm:text-xs uppercase tracking-widest text-slate-500 mb-2">Trao tặng cho</p>
                                <h3 class="text-lg sm:text-2xl font-bold text-green-600 mb-2 uppercase font-sans line-clamp-1" id="certificate-name">HỌC VIÊN</h3>
                                <p class="text-xs sm:text-sm italic text-slate-600 mb-2">Đã hoàn thành xuất sắc khóa học</p>
                                <p class="text-lg sm:text-2xl font-black text-blue-900 mb-3 uppercase tracking-tight">QUẢN LÝ HÓA ĐƠN ĐẦU VÀO</p>
                                <div class="text-sm sm:text-base font-medium text-blue-700 mb-3 italic" id="final-score-cert">Với kết quả: 100% (5/5)</div>
                                <p class="text-[10px] sm:text-xs text-slate-500 italic">Ngày hoàn thành: <span id="cert-date">...</span></p>
                                <p class="text-[10px] sm:text-xs text-blue-800 font-bold uppercase mt-1">Cấp bởi: KiotViet Learning and Development Department</p>
                            </div>
                        </div>

                        <div id="fail-message-container" class="hidden mt-4 bg-red-50 p-4 rounded-lg border border-red-100 text-sm text-red-600 mb-6">
                            <i class="fa-solid fa-circle-exclamation mr-1"></i> Chưa đạt yêu cầu. Hãy ôn tập và thử lại!
                        </div>

                        <div class="flex flex-wrap justify-center gap-3 mt-6 mb-8">
                            <button onclick="playAgain()" class="bg-blue-600 text-white px-5 py-2.5 rounded-full font-bold shadow hover:bg-blue-700 text-sm flex items-center gap-2"><i class="fa-solid fa-rotate-right"></i> Chơi lại</button>
                            <button onclick="switchTab('cheatsheet')" class="bg-white border border-slate-200 text-slate-600 px-5 py-2.5 rounded-full font-bold shadow hover:bg-slate-50 text-sm"><i class="fa-solid fa-bolt text-yellow-500 mr-1"></i> Xem Tóm tắt</button>
                            <button onclick="switchTab('summary')" class="bg-white border border-slate-200 text-slate-600 px-5 py-2.5 rounded-full font-bold shadow hover:bg-slate-50 text-sm"><i class="fa-solid fa-table-columns text-purple-500 mr-1"></i> Xem So sánh</button>
                            <button id="btn-download" onclick="downloadCertificate()" class="bg-green-600 text-white px-5 py-2.5 rounded-full font-bold shadow hover:bg-green-700 text-sm flex items-center gap-2 hidden"><i class="fa-solid fa-download"></i> Tải chứng nhận</button>
                        </div>
                    </div>
                </div>
            </div>
        </main>
    </div>

    <script>
        // --- DATA ---
        const lessonData = [
            {
                id: 1,
                tabId: "part1",
                questionText: "Việc nhập phiếu nhập hàng thủ công từ hóa đơn giấy hoặc file PDF vẫn đảm bảo tốc độ nhanh và độ chính xác cao nhất.",
                isTrue: false,
                wrong: "Nhập thủ công là nhanh nhất.",
                right: "Nhập thủ công tốn nhiều thời gian và dễ sai sót. Tính năng đồng bộ tự động giúp tiết kiệm thời gian và đảm bảo số liệu chuẩn xác."
            },
            {
                id: 2,
                tabId: "part1",
                questionText: "KiotViet sẽ đồng bộ tất cả các loại hóa đơn, bao gồm cả hóa đơn nháp hoặc chưa được xác thực.",
                isTrue: false,
                wrong: "Đồng bộ cả hóa đơn nháp/chưa xác thực.",
                right: "Hệ thống chỉ tự động kiểm tra và đồng bộ các hóa đơn HỢP LỆ (có mã CQT, đúng MST) đã được Cơ quan Thuế xác thực."
            },
            {
                id: 3,
                tabId: "part2",
                questionText: "Để kết nối với Cơ quan Thuế, bạn sử dụng Tên đăng nhập và Mật khẩu quản trị viên (Admin) của gian hàng KiotViet.",
                isTrue: false,
                wrong: "Dùng tài khoản Admin KiotViet để kết nối.",
                right: "Bạn bắt buộc phải sử dụng tài khoản do CƠ QUAN THUẾ cấp tại trang hoadondientu.gdt.gov.vn."
            },
            {
                id: 4,
                tabId: "part2",
                questionText: "Sau khi kết nối thành công, hóa đơn sẽ tự động chảy về KiotViet ngay lập tức mà không cần thao tác gì thêm.",
                isTrue: false,
                wrong: "Hóa đơn tự về không cần bấm nút.",
                right: "Bạn cần nhấn nút 'Đồng bộ hóa đơn' và chọn khoảng thời gian (Từ ngày - Đến ngày) để tải danh sách về."
            },
            {
                id: 5,
                tabId: "part3",
                questionText: "Bạn phải thực hiện khớp thủ công từng Nhà cung cấp và Hàng hóa cho mỗi lần đồng bộ hóa đơn mới.",
                isTrue: false,
                wrong: "Phải khớp tay lại từ đầu mỗi lần.",
                right: "Hệ thống có cơ chế 'GHI NHỚ THÔNG MINH'. Sau khi khớp thành công 1 lần, các lần sau hệ thống sẽ tự động gợi ý khớp tương tự."
            },
            {
                id: 6,
                tabId: "part3",
                questionText: "Hệ thống chỉ tự động gợi ý khớp Hàng hóa khi tên sản phẩm trên hóa đơn và trên phần mềm giống nhau hoàn toàn 100%.",
                isTrue: false,
                wrong: "Tên hàng phải giống nhau 100%.",
                right: "Hệ thống thông minh sẽ tự động tìm và gợi ý khớp nếu Tên hàng hoặc Tên NCC có độ trùng khớp trên 80%."
            },
            {
                id: 7,
                tabId: "part4",
                questionText: "Khi tạo phiếu nhập, số lượng của hàng quản lý theo Lô/Date hoặc IMEI sẽ được tự động điền đầy đủ.",
                isTrue: false,
                wrong: "Tự điền số lượng hàng Lô/IMEI.",
                right: "Với hàng Lô/Date/IMEI, số lượng mặc định là '0'. Bạn cần nhập thủ công số lượng thực tế và thông tin chi tiết Lô/IMEI."
            },
            {
                id: 8,
                tabId: "part4",
                questionText: "Tất cả hóa đơn đầu vào từ Cơ quan Thuế bắt buộc phải được chuyển đổi thành Phiếu nhập hàng.",
                isTrue: false,
                wrong: "Bắt buộc tạo Phiếu nhập cho mọi hóa đơn.",
                right: "Với hóa đơn dịch vụ (điện, nước...), bạn có thể chọn 'Lập phiếu chi' để ghi nhận thanh toán ngay mà không cần nhập kho."
            }
        ];

        // --- LOGIC ---
        let gameQuestions = [], currentIndex = 0, score = 0, playerName = "HỌC VIÊN", completedCards = new Set();

        function toggleSidebar() { document.body.classList.toggle('sidebar-closed'); document.body.classList.toggle('sidebar-open'); }
        
        function switchTab(tabId) {
            document.querySelectorAll('.tab-content').forEach(el => el.classList.add('hidden'));
            document.getElementById('tab-' + tabId).classList.remove('hidden');
            document.querySelectorAll('.nav-link').forEach(el => { el.classList.remove('active', 'bg-blue-50', 'text-blue-900', 'border-blue-600'); el.classList.add('text-slate-600'); });
            const btn = document.getElementById('nav-' + tabId); if(btn) { btn.classList.add('active'); btn.classList.remove('text-slate-600'); }
            
            // Mobile close sidebar
            if(window.innerWidth < 768) { document.body.classList.add('sidebar-closed'); document.body.classList.remove('sidebar-open'); }
            
            document.getElementById('contentArea').scrollTop = 0;
            if(tabId === 'summary') renderSummary();
        }

        // Render Cards & Summary
        function renderCards() {
            lessonData.forEach(item => {
                const container = document.getElementById('cards-' + item.tabId);
                if (!container) return;
                const html = `
                <div class="perspective-1000 h-72 group" id="card-container-${item.id}">
                    <div class="card-inner h-full type-card rounded-2xl bg-white border border-slate-200">
                        <div class="card-face p-5 flex flex-col justify-between bg-white rounded-2xl">
                            <div><span class="bg-blue-50 text-blue-600 text-[10px] font-bold px-2 py-1 rounded uppercase border border-blue-100">Nhận định...</span><h3 class="mt-3 text-sm md:text-base font-bold text-slate-800 leading-snug">"${item.questionText}"</h3></div>
                            <div class="pt-3 border-t border-slate-50"><p class="text-xs text-center text-slate-400 mb-2 font-bold">Theo bạn thì...</p><div class="grid grid-cols-2 gap-3"><button onclick="flipCard(${item.id}, true)" class="py-2 rounded-lg border border-green-200 text-green-600 font-bold hover:bg-green-50 text-sm">ĐÚNG</button><button onclick="flipCard(${item.id}, false)" class="py-2 rounded-lg border border-red-200 text-red-600 font-bold hover:bg-red-50 text-sm">SAI</button></div></div>
                        </div>
                        <div class="card-face card-back p-4 border-2 flex flex-col justify-center rounded-2xl text-center bg-white"></div>
                    </div>
                </div>`;
                container.innerHTML += html;
            });
            updateProgress();
        }

        function renderSummary() {
            const tbody = document.getElementById('summaryTableBody');
            tbody.innerHTML = lessonData.map((item, idx) => `
                <tr class="hover:bg-slate-50"><td class="px-4 py-3 text-slate-400 font-bold text-center">${idx+1}</td><td class="px-4 py-3 text-slate-600 bg-red-50/30 border-r border-slate-100"><div class="flex gap-2"><i class="fa-solid fa-xmark text-red-400 mt-1 flex-shrink-0"></i><span>${item.wrong}</span></div></td><td class="px-4 py-3 text-slate-800 bg-green-50/30 font-medium"><div class="flex gap-2"><i class="fa-solid fa-check text-green-500 mt-1 flex-shrink-0"></i><span>${item.right}</span></div></td></tr>
            `).join('');
        }

        function flipCard(id, choice) {
            const container = document.getElementById(`card-container-${id}`);
            const backFace = container.querySelector('.card-back');
            const item = lessonData.find(i => i.id === id);
            const isCorrect = (choice === item.isTrue);
            
            const resultHeader = isCorrect ? '<div class="mb-1 font-bold text-base text-green-600"><i class="fa-solid fa-check-circle"></i> Chính xác!</div>' : '<div class="mb-1 font-bold text-base text-red-600"><i class="fa-solid fa-times-circle"></i> Chưa chính xác!</div>';
            const badgeClass = item.isTrue ? 'bg-green-100 text-green-700' : 'bg-red-100 text-red-700';
            const bgClass = isCorrect ? 'border-green-200 bg-green-50/50' : 'border-red-200 bg-red-50/50';

            backFace.className = `card-face card-back p-4 border-2 flex flex-col justify-center rounded-2xl text-center ${bgClass}`;
            backFace.innerHTML = `<div class="overflow-y-auto custom-scrollbar h-full flex flex-col items-center">${resultHeader}<p class="text-slate-600 text-xs italic mb-2">"${item.questionText}"</p><span class="px-2 py-0.5 rounded text-[10px] font-bold ${badgeClass} mb-2">${item.isTrue ? 'ĐÚNG' : 'SAI'}</span><div class="bg-white/80 p-2 rounded border border-blue-100 text-left w-full"><p class="text-[10px] text-blue-600 font-bold uppercase mb-1">Sự thật là:</p><p class="text-slate-700 text-xs leading-relaxed">${item.right}</p></div><button onclick="resetCard(${id})" class="mt-auto pt-2 text-[10px] text-slate-400 underline">Quay lại</button></div>`;
            
            container.querySelector('.card-inner').classList.add('flipped');
            if(!completedCards.has(id)) { completedCards.add(id); updateProgress(); }
        }
        function resetCard(id) { document.getElementById(`card-container-${id}`).querySelector('.card-inner').classList.remove('flipped'); }
        function updateProgress() { document.getElementById('totalProgress').style.width = `${(completedCards.size / lessonData.length) * 100}%`; document.getElementById('completedCount').innerText = `${completedCards.size}/${lessonData.length}`; }

        // Game
        function startGame(mode) {
            const name = document.getElementById('player-name').value.trim();
            if(name) playerName = name;
            let list = [...lessonData].sort(() => 0.5 - Math.random());
            if(mode === 'standard') gameQuestions = list.slice(0, 5);
            else if(mode === 'promax') gameQuestions = list;
            else gameQuestions = list;
            
            score = 0; currentIndex = 0;
            document.getElementById('game-start').classList.add('hidden');
            document.getElementById('game-result').classList.add('hidden');
            document.getElementById('game-playing').classList.remove('hidden');
            showQuestion();
        }
        function showQuestion() {
            const q = gameQuestions[currentIndex];
            document.getElementById('question-text').innerText = q.questionText;
            document.getElementById('q-progress').innerText = `${currentIndex + 1}/${gameQuestions.length}`;
            document.getElementById('current-score').innerText = score;
            const card = document.getElementById('game-card');
            card.classList.remove('shake-effect', 'pop-effect');
        }
        function answerGame(choice) {
            const q = gameQuestions[currentIndex];
            const card = document.getElementById('game-card');
            if(choice === q.isTrue) { score++; card.classList.add('pop-effect'); confetti({ particleCount: 50, spread: 60, origin: { y: 0.7 } }); }
            else { card.classList.add('shake-effect'); }
            setTimeout(() => { currentIndex++; if(currentIndex < gameQuestions.length) showQuestion(); else endGame(); }, 600);
        }
        function endGame() {
            document.getElementById('game-playing').classList.add('hidden');
            document.getElementById('game-result').classList.remove('hidden');
            
            const total = gameQuestions.length;
            const percent = Math.round((score/total)*100);
            const isPass = percent >= 80;
            
            const els = {
                cert: document.getElementById('certificate'),
                name: document.getElementById('certificate-name'),
                score: document.getElementById('final-score-cert'),
                date: document.getElementById('cert-date'),
                watermark: document.getElementById('fail-watermark'),
                failMsg: document.getElementById('fail-message-container'),
                btnDown: document.getElementById('btn-download')
            };

            els.name.innerText = isPass ? playerName.toUpperCase() : "........................................";
            els.score.innerText = isPass ? `Với kết quả: ${percent}% (${score}/${total})` : "";
            const d = new Date();
            els.date.innerText = isPass ? `${String(d.getDate()).padStart(2,'0')}/${String(d.getMonth()+1).padStart(2,'0')}/${d.getFullYear()}` : "..../..../.......";
            
            if(isPass) {
                els.watermark.classList.add('hidden');
                els.failMsg.classList.add('hidden');
                els.btnDown.classList.remove('hidden');
                els.cert.classList.remove('opacity-50');
                confetti({ particleCount: 150, spread: 100, origin: { y: 0.6 } });
            } else {
                els.watermark.classList.remove('hidden');
                els.failMsg.classList.remove('hidden');
                els.btnDown.classList.add('hidden');
                els.cert.classList.add('opacity-50');
            }
        }
        function playAgain() { document.getElementById('game-result').classList.add('hidden'); document.getElementById('game-start').classList.remove('hidden'); }
        function downloadCertificate() {
            html2canvas(document.getElementById('certificate'), { scale: 2 }).then(canvas => {
                const link = document.createElement('a'); link.download = 'ChungNhan_KiotViet.png'; link.href = canvas.toDataURL(); link.click();
            });
        }

        window.onload = function() { switchTab('cheatsheet'); renderCards(); }
    </script>
</body>
</html>
