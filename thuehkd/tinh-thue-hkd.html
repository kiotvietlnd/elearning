<!DOCTYPE html>
<html lang="vi" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Công cụ tính thuế kê khai 2026 (Beta) - KiotViet</title>
    <meta name="description" content="Công cụ tính toán thuế GTGT và TNCN cho Hộ kinh doanh theo quy định mới 2026. Hỗ trợ phương pháp doanh thu và lợi nhuận.">
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Google Fonts: Inter -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800;900&display=swap" rel="stylesheet">
    
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <!-- AOS -->
    <link href="https://unpkg.com/aos@2.3.1/dist/aos.css" rel="stylesheet">

    <style>
        body { 
            font-family: 'Inter', sans-serif;
            background-color: #f0f9ff; /* Sky-50 */
        }

        /* Custom Scrollbar */
        ::-webkit-scrollbar { width: 6px; }
        ::-webkit-scrollbar-track { background: #f0f9ff; }
        ::-webkit-scrollbar-thumb { background: #93c5fd; border-radius: 3px; }
        ::-webkit-scrollbar-thumb:hover { background: #3b82f6; }

        /* Background Animation */
        @keyframes moveInCircle { 0% { transform: rotate(0deg); } 50% { transform: rotate(180deg); } 100% { transform: rotate(360deg); } }
        @keyframes moveVertical { 0% { transform: translateY(-50%); } 50% { transform: translateY(50%); } 100% { transform: translateY(-50%); } }
        @keyframes moveHorizontal { 0% { transform: translateX(-50%); } 50% { transform: translateX(50%); } 100% { transform: translateX(-50%); } }
        
        .soft-glow-background { 
            position: fixed; top: 0; left: 0; width: 100%; height: 100%; z-index: -10; 
            background: linear-gradient(135deg, #ffffff 0%, #e0f2fe 50%, #dcfce7 100%);
        }
        .soft-glow-background .shape { position: absolute; filter: blur(120px); opacity: 0.6; }
        .soft-glow-background .shape1 { height: 400px; width: 400px; background: #bae6fd; border-radius: 50%; top: -50px; left: -100px; animation: moveInCircle 25s ease-in-out infinite; }
        .soft-glow-background .shape2 { height: 450px; width: 450px; background: #bbf7d0; border-radius: 50%; bottom: -100px; right: -100px; animation: moveVertical 30s ease-in-out infinite; }
        .soft-glow-background .shape3 { height: 300px; width: 500px; background: #a5f3fc; border-radius: 50%; top: 50%; left: 50%; animation: moveHorizontal 40s ease-in-out infinite; }

        /* TOC Styling */
        .toc-link.active { 
            color: #1e3a8a; /* Blue-900 */
            border-left: 3px solid #2563eb; /* Blue-600 */
            background: #eff6ff; /* Blue-50 */
            font-weight: 600; 
        }

        /* Table Styling */
        .tax-table { width: 100%; border-collapse: separate; border-spacing: 0; border-radius: 8px; overflow: hidden; border: 1px solid #e2e8f0; font-size: 0.95rem; }
        .tax-table th { background-color: #eff6ff; color: #1e40af; padding: 12px; text-align: left; font-weight: 700; border-bottom: 2px solid #bfdbfe; }
        .tax-table td { padding: 12px; border-bottom: 1px solid #f1f5f9; vertical-align: top; }
        .tax-table tr:nth-child(even) { background-color: #f8fafc; }
        
        /* Calculator Specific Styles */
        .calc-input {
            width: 100%;
            padding: 12px 16px;
            border: 1px solid #e2e8f0;
            border-radius: 12px;
            outline: none;
            transition: all 0.2s;
            background-color: #fff;
            color: #1e293b;
        }
        .calc-input:focus {
            border-color: #3b82f6;
            box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1);
        }
        
        /* Toggle Switch */
        .toggle-checkbox:checked {
            right: 0;
            border-color: #10b981; /* Green-500 */
        }
        .toggle-checkbox:checked + .toggle-label {
            background-color: #10b981; /* Green-500 */
        }
        .formula-box {
            font-family: 'Courier New', Courier, monospace;
            background-color: #f1f5f9;
            border: 1px dashed #94a3b8;
            padding: 10px;
            border-radius: 8px;
            font-size: 0.85rem;
            color: #475569;
            margin-top: 6px;
        }
        
        .float-btn { transition: transform 0.2s; }
        .float-btn:hover { transform: scale(1.1); }
    </style>
</head>
<body id="top" class="text-slate-700 antialiased selection:bg-blue-100 selection:text-blue-900">

    <div class="soft-glow-background">
        <div class="shape shape1"></div>
        <div class="shape shape2"></div>
        <div class="shape shape3"></div>
    </div>

    <!-- Header Navigation -->
    <header class="sticky top-0 z-50 bg-white/80 backdrop-blur-md border-b border-white/50 h-20 shadow-sm">
        <div class="max-w-6xl mx-auto px-4 sm:px-6 lg:px-8 h-full">
            <div class="flex items-center justify-between h-full gap-8">
                <!-- Logo -->
                <a href="index.html" class="flex-shrink-0 flex items-center gap-3 select-none hover:opacity-80 transition-opacity">
                    <img src="https://logo.kiotviet.vn/KiotViet-Logo-Horizontal.svg" alt="KiotViet Logo" class="h-8">
                    <span class="text-slate-300 font-light text-2xl">|</span>
                    <span class="font-bold text-transparent bg-clip-text bg-gradient-to-r from-blue-700 to-green-700 tracking-tight text-lg uppercase">E-Learning</span>
                </a>

                <!-- Back Link -->
                <a href="index.html" class="flex items-center gap-2 text-sm font-bold text-blue-600 hover:text-blue-800 transition-colors">
                    <i class="fa-solid fa-arrow-left"></i> Quay lại Cẩm nang
                </a>
            </div>
        </div>
    </header>

    <main class="max-w-6xl mx-auto px-4 sm:px-6 lg:px-8 py-8 min-h-[80vh]">
        
        <!-- Breadcrumb -->
        <nav class="flex mb-6 text-sm text-slate-500" aria-label="Breadcrumb">
            <ol class="inline-flex items-center space-x-1 md:space-x-3">
                <li class="inline-flex items-center">
                    <a href="index.html" class="inline-flex items-center hover:text-blue-600">
                        <i class="fa-solid fa-home mr-2"></i> Trang chủ
                    </a>
                </li>
                <li>
                    <div class="flex items-center">
                        <i class="fa-solid fa-chevron-right text-slate-400 mx-2"></i>
                        <a href="index.html#tax-cat-4" class="hover:text-blue-600">Công cụ tiện ích</a>
                    </div>
                </li>
                <li>
                    <div class="flex items-center">
                        <i class="fa-solid fa-chevron-right text-slate-400 mx-2"></i>
                        <span class="text-slate-700 font-medium">Tính thuế kê khai 2026</span>
                    </div>
                </li>
            </ol>
        </nav>

        <div class="flex flex-col lg:flex-row gap-10">
            <!-- Sidebar TOC (Sticky) -->
            <aside class="lg:w-1/4 hidden lg:block">
                <div class="sticky top-28 bg-white/80 backdrop-blur p-5 rounded-2xl shadow-md border border-white/60">
                    <h3 class="font-bold text-blue-900 mb-4 border-b border-slate-100 pb-2 uppercase text-xs tracking-wider">Mục lục</h3>
                    <nav class="space-y-1" id="toc">
                        <a href="#cong-cu-tinh" class="toc-link block px-3 py-2 text-sm text-slate-600 hover:text-blue-600 rounded-r-lg transition-all border-l-2 border-transparent">1. Công cụ tính thuế (Beta)</a>
                        <a href="#tong-quan" class="toc-link block px-3 py-2 text-sm text-slate-600 hover:text-blue-600 rounded-r-lg transition-all border-l-2 border-transparent">2. Tổng quan lộ trình</a>
                        <a href="#phan-nhom" class="toc-link block px-3 py-2 text-sm text-slate-600 hover:text-blue-600 rounded-r-lg transition-all border-l-2 border-transparent">3. Phân nhóm & Miễn thuế</a>
                        <a href="#huong-dan-tinh-thue" class="toc-link block px-3 py-2 text-sm text-slate-600 hover:text-blue-600 rounded-r-lg transition-all border-l-2 border-transparent">4. Hướng dẫn chi tiết</a>
                        <a href="#hoa-don-so-sach" class="toc-link block px-3 py-2 text-sm text-slate-600 hover:text-blue-600 rounded-r-lg transition-all border-l-2 border-transparent">5. Hóa đơn & Sổ sách</a>
                        <a href="#rui-ro" class="toc-link block px-3 py-2 text-sm text-slate-600 hover:text-blue-600 rounded-r-lg transition-all border-l-2 border-transparent">6. Rủi ro pháp lý</a>
                    </nav>
                </div>
            </aside>

            <!-- Content Area -->
            <article class="lg:w-3/4 w-full space-y-10 pb-10">
                <!-- Title Block -->
                <div class="text-center lg:text-left border-b border-slate-200 pb-6">
                    <span class="bg-blue-100 text-blue-700 px-3 py-1 rounded-full text-xs font-bold uppercase tracking-wider border border-blue-200">Tiện ích mới</span>
                    <h1 class="text-3xl md:text-4xl font-black text-blue-900 mt-4 mb-4 leading-tight">Công cụ tính thuế kê khai 2026 (Beta)</h1>
                    <div class="flex items-center gap-4 text-sm text-slate-500 italic justify-center lg:justify-start">
                        <span><i class="fa-regular fa-clock mr-1"></i> 30/12/2025</span>
                        <span><i class="fa-solid fa-user-pen mr-1"></i> LND Department</span>
                    </div>
                </div>

                <p class="leading-relaxed text-slate-700 text-lg">
                    Sử dụng công cụ dưới đây để ước tính số thuế phải nộp theo quy định mới áp dụng từ 01/01/2026. Công cụ hỗ trợ cả hai phương pháp tính: theo tỷ lệ doanh thu (không xác định chi phí) và theo lợi nhuận thực tế (xác định được chi phí).
                </p>

                <!-- SECTION 1: CALCULATOR TOOL -->
                <section id="cong-cu-tinh" class="scroll-mt-28" data-aos="fade-up">
                    <div class="bg-white rounded-2xl shadow-xl border border-blue-100 overflow-hidden">
                        <div class="bg-gradient-to-r from-blue-600 to-green-600 px-6 py-4 text-white flex justify-between items-center">
                            <h2 class="font-bold text-lg"><i class="fa-solid fa-calculator mr-2"></i> Tính Thuế HKD 2026</h2>
                            <span class="bg-white/20 px-2 py-1 rounded text-xs font-medium backdrop-blur-sm">BETA</span>
                        </div>
                        
                        <div class="p-6 grid md:grid-cols-2 gap-8">
                            <!-- Input Area -->
                            <div class="space-y-6">
                                <div>
                                    <label class="block text-sm font-bold text-slate-700 mb-2">Doanh thu ước tính (năm)</label>
                                    <div class="relative">
                                        <input type="text" id="revenueInput" class="calc-input pr-12 font-bold text-slate-800" placeholder="Ví dụ: 800,000,000" onkeyup="formatCurrency(this)">
                                        <span class="absolute right-4 top-3 text-slate-400 text-sm font-bold">VND</span>
                                    </div>
                                </div>

                                <div class="flex items-center justify-between bg-slate-50 p-4 rounded-xl border border-slate-200">
                                    <span class="text-sm font-medium text-slate-700">Xác định được chi phí?</span>
                                    <div class="relative inline-block w-12 align-middle select-none transition duration-200 ease-in">
                                        <input type="checkbox" name="toggle" id="expenseToggle" class="toggle-checkbox absolute block w-6 h-6 rounded-full bg-white border-4 appearance-none cursor-pointer border-slate-300 left-0 transition-all duration-300 top-0" onclick="toggleExpenseInput()"/>
                                        <label for="expenseToggle" class="toggle-label block overflow-hidden h-6 rounded-full bg-slate-300 cursor-pointer transition-colors duration-300"></label>
                                    </div>
                                </div>

                                <div id="expenseContainer" class="hidden transition-all duration-300">
                                    <label class="block text-sm font-bold text-slate-700 mb-2">Chi phí ước tính (năm)</label>
                                    <div class="relative">
                                        <input type="text" id="expenseInput" class="calc-input pr-12 font-bold text-slate-800" placeholder="Ví dụ: 600,000,000" onkeyup="formatCurrency(this)">
                                        <span class="absolute right-4 top-3 text-slate-400 text-sm font-bold">VND</span>
                                    </div>
                                    <p class="text-xs text-slate-500 mt-1 italic ml-1">Bao gồm giá vốn, chi phí quản lý, vận hành...</p>
                                </div>

                                <div>
                                    <label class="block text-sm font-bold text-slate-700 mb-2">Ngành nghề kinh doanh</label>
                                    <select id="sectorInput" class="calc-input cursor-pointer">
                                        <option value="1-0.5">Phân phối, cung cấp hàng hoá (VAT 1%, TNCN 0.5%)</option>
                                        <option value="3-1.5">Sản xuất, vận tải, xây dựng có bao thầu (VAT 3%, TNCN 1.5%)</option>
                                        <option value="5-2">Dịch vụ, xây dựng không bao thầu (VAT 5%, TNCN 2%)</option>
                                        <option value="5-5">Cho thuê tài sản, BĐS (VAT 5%, TNCN 5%)</option>
                                        <option value="5-5">Sản phẩm nội dung số (VAT 5%, TNCN 5%)</option>
                                        <option value="2-1">Các ngành nghề khác (VAT 2%, TNCN 1%)</option>
                                    </select>
                                </div>

                                <button onclick="calculateTax()" class="w-full bg-gradient-to-r from-blue-600 to-green-600 hover:from-blue-700 hover:to-green-700 text-white font-bold py-3.5 rounded-xl shadow-lg transition-all active:scale-95 transform hover:-translate-y-0.5">
                                    Tính Toán Ngay
                                </button>
                            </div>

                            <!-- Result Area -->
                            <div class="bg-slate-50 rounded-2xl p-6 border border-slate-200 flex flex-col justify-center relative min-h-[300px]">
                                <div id="resultPlaceholder" class="text-center text-slate-400 flex flex-col items-center">
                                    <i class="fa-solid fa-chart-pie text-5xl mb-4 opacity-30"></i>
                                    <p class="font-medium">Nhập số liệu để xem kết quả</p>
                                </div>
                                
                                <div id="resultContent" class="hidden space-y-5 w-full">
                                    <div class="text-center pb-5 border-b border-slate-200">
                                        <p class="text-sm text-slate-500 mb-2 font-medium uppercase tracking-wide">Phân loại</p>
                                        <span id="groupBadge" class="inline-block px-4 py-1.5 rounded-full text-sm font-bold uppercase tracking-wider bg-green-100 text-green-700 shadow-sm border border-green-200">Nhóm 1 - Miễn Thuế</span>
                                    </div>

                                    <div id="taxDetails" class="space-y-5">
                                        
                                        <!-- VAT Section -->
                                        <div>
                                            <div class="flex justify-between items-center text-sm mb-1">
                                                <span class="text-slate-600 font-bold flex items-center gap-2"><div class="w-2 h-2 rounded-full bg-blue-500"></div> Thuế GTGT (VAT)</span>
                                                <span class="font-bold text-blue-700 text-lg" id="vatResult">0 đ</span>
                                            </div>
                                            <div class="formula-box" id="vatFormula">...</div>
                                        </div>

                                        <!-- TNCN Section -->
                                        <div>
                                            <div class="flex justify-between items-center text-sm mb-1">
                                                <span class="text-slate-600 font-bold flex items-center gap-2"><div class="w-2 h-2 rounded-full bg-green-500"></div> Thuế TNCN</span>
                                                <span class="font-bold text-green-700 text-lg" id="pitResult">0 đ</span>
                                            </div>
                                            <div class="formula-box" id="pitFormula">...</div>
                                        </div>
                                        
                                        <!-- Total -->
                                        <div class="pt-4 border-t-2 border-dashed border-slate-200 flex justify-between items-center bg-white p-4 rounded-xl shadow-sm border border-slate-100 mt-2">
                                            <span class="font-black text-slate-800 uppercase text-sm">TỔNG THUẾ / NĂM</span>
                                            <span class="font-black text-2xl text-transparent bg-clip-text bg-gradient-to-r from-blue-700 to-green-700" id="totalTax">0 đ</span>
                                        </div>
                                    </div>
                                    
                                    <div class="bg-blue-50 p-4 rounded-xl text-xs text-blue-800 border border-blue-100 leading-relaxed">
                                        <strong><i class="fa-solid fa-circle-info mr-1"></i> Giải thích:</strong>
                                        <ul class="list-disc pl-4 mt-1 space-y-1">
                                            <li><strong>VAT:</strong> Tính trên toàn bộ doanh thu.</li>
                                            <li><strong>TNCN (không có chi phí):</strong> Tính trên phần doanh thu vượt 500 triệu.</li>
                                            <li><strong>TNCN (có chi phí):</strong> Tính trên Lợi nhuận = Doanh thu - Chi phí.</li>
                                        </ul>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </section>

                <!-- SECTION 2 -->
                <section id="tong-quan" class="scroll-mt-28" data-aos="fade-up">
                    <h2 class="text-2xl font-bold text-blue-900 mb-6 flex items-center gap-3">
                        <span class="bg-white text-blue-600 w-10 h-10 flex items-center justify-center rounded-full text-lg font-black border border-blue-200 shadow-sm">2</span> 
                        Tổng Quan Về Lộ Trình Thay Đổi
                    </h2>
                    
                    <div class="bg-white p-6 rounded-xl border border-slate-200 shadow-sm mb-6">
                        <h3 class="font-bold text-slate-800 mb-3 flex items-center gap-2 text-lg"><i class="fa-solid fa-flag-checkered text-red-500"></i> Chấm dứt phương pháp Thuế Khoán</h3>
                        <p class="leading-relaxed text-slate-700">
                            Theo quy định mới, phương pháp tính thuế khoán sẽ chính thức được bãi bỏ từ ngày 01/01/2026. Thay vào đó là hình thức kê khai theo doanh thu thực tế.
                        </p>
                    </div>

                    <div class="bg-blue-50 border-l-4 border-blue-500 p-5 rounded-r-xl shadow-sm">
                        <h4 class="font-bold text-blue-800 mb-2 flex items-center gap-2"><i class="fa-solid fa-hand-holding-heart"></i> Hỗ trợ từ Cơ quan Thuế</h4>
                        <p class="text-sm text-slate-700">
                            Ngành thuế cam kết hỗ trợ tối đa, không đặt nặng truy thu hay xử phạt sai sót không cố ý trong giai đoạn đầu.
                        </p>
                    </div>
                </section>

                <!-- SECTION 3 -->
                <section id="phan-nhom" class="scroll-mt-28" data-aos="fade-up">
                    <h2 class="text-2xl font-bold text-blue-900 mb-6 flex items-center gap-3">
                        <span class="bg-white text-blue-600 w-10 h-10 flex items-center justify-center rounded-full text-lg font-black border border-blue-200 shadow-sm">3</span> 
                        Phân Nhóm Hộ Kinh Doanh & Ngưỡng Miễn Thuế
                    </h2>
                    
                    <div class="bg-yellow-50 border-l-4 border-yellow-400 p-5 mb-6 rounded-r-xl shadow-sm">
                        <h3 class="text-lg font-bold text-yellow-800 mb-2 flex items-center gap-2"><i class="fa-solid fa-star text-yellow-500"></i> Tin vui: Nâng ngưỡng doanh thu miễn thuế</h3>
                        <p class="text-slate-700">
                            Từ 01/01/2026, các Hộ Kinh Doanh có tổng doanh thu trong năm từ <strong>500 triệu đồng trở xuống</strong> sẽ được <strong>miễn nộp cả thuế GTGT và TNCN</strong>.
                        </p>
                    </div>

                    <div class="overflow-x-auto rounded-xl border border-slate-200 shadow-sm">
                        <table class="tax-table w-full">
                            <thead>
                                <tr>
                                    <th class="w-1/4">Nhóm Doanh Thu</th>
                                    <th>Đặc Điểm & Phương Pháp Tính</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td class="font-bold text-green-600 bg-green-50">Nhóm 1<br><span class="text-xs text-slate-500 font-normal">≤ 500 triệu/năm</span></td>
                                    <td>
                                        <div class="flex items-center gap-2 mb-1"><i class="fa-solid fa-check text-green-500"></i> Miễn nộp thuế GTGT và TNCN.</div>
                                        <div class="flex items-center gap-2"><i class="fa-solid fa-check text-green-500"></i> Kê khai 01 lần/năm.</div>
                                    </td>
                                </tr>
                                <tr>
                                    <td class="font-bold text-blue-600 bg-blue-50">Nhóm 2<br><span class="text-xs text-slate-500 font-normal">> 500 triệu - 3 tỷ/năm</span></td>
                                    <td>
                                        <ul class="space-y-2">
                                            <li>• <strong>Thuế GTGT:</strong> Tỷ lệ % trên doanh thu.</li>
                                            <li>• <strong>Thuế TNCN:</strong>
                                                <ul class="list-disc pl-5 mt-1 text-xs text-slate-600 bg-slate-50 p-2 rounded">
                                                    <li>Không xác định chi phí: Tỷ lệ % trên (Doanh thu - 500tr).</li>
                                                    <li>Xác định chi phí: 15% trên Lợi nhuận.</li>
                                                </ul>
                                            </li>
                                        </ul>
                                    </td>
                                </tr>
                                <tr>
                                    <td class="font-bold text-purple-600 bg-purple-50">Nhóm 3<br><span class="text-xs text-slate-500 font-normal">> 3 tỷ - 50 tỷ/năm</span></td>
                                    <td>
                                        <ul class="space-y-1">
                                            <li>• <strong>Thuế GTGT:</strong> Tỷ lệ % trên doanh thu.</li>
                                            <li>• <strong>Thuế TNCN:</strong> 17% trên Lợi nhuận.</li>
                                        </ul>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </section>

                <!-- SECTION 4 -->
                <section id="huong-dan-tinh-thue" class="scroll-mt-28" data-aos="fade-up">
                    <h2 class="text-2xl font-bold text-blue-900 mb-6 flex items-center gap-3">
                        <span class="bg-white text-blue-600 w-10 h-10 flex items-center justify-center rounded-full text-lg font-black border border-blue-200 shadow-sm">4</span> 
                        Hướng Dẫn Kê Khai và Tính Thuế
                    </h2>

                    <div class="bg-white p-6 rounded-xl border border-slate-200 mb-6 shadow-sm">
                        <h4 class="font-bold text-blue-800 text-lg mb-4 border-b border-slate-100 pb-2">Công thức tính thuế cơ bản</h4>
                        
                        <div class="grid md:grid-cols-2 gap-4 mb-4">
                            <div class="bg-blue-50 p-5 rounded-xl text-center border border-blue-100">
                                <p class="text-xs uppercase font-bold text-blue-400 mb-2">Thuế GTGT (Mọi trường hợp)</p>
                                <p class="font-bold text-blue-800 text-lg">Doanh thu x Tỷ lệ VAT ngành nghề</p>
                            </div>
                            <div class="bg-green-50 p-5 rounded-xl text-center border border-green-100">
                                <p class="text-xs uppercase font-bold text-green-500 mb-2">Thuế TNCN (Nếu biết chi phí)</p>
                                <p class="font-bold text-green-800 text-lg">Lợi nhuận x Thuế suất (15-20%)</p>
                            </div>
                        </div>
                        <div class="bg-slate-50 p-4 rounded-xl text-sm text-slate-600 italic border border-slate-200 flex items-start gap-2">
                            <i class="fa-solid fa-circle-info text-blue-500 mt-0.5"></i>
                            <span><strong>Lưu ý về TNCN (trường hợp không xác định chi phí):</strong> Công thức là (Doanh thu - 500 triệu) x Tỷ lệ TNCN ngành nghề.</span>
                        </div>
                    </div>

                    <!-- KiotViet Solution -->
                    <div class="bg-gradient-to-r from-blue-50 to-indigo-50 p-6 rounded-xl border border-blue-100 shadow-md">
                        <h4 class="font-bold text-blue-800 mb-4 flex items-center gap-2 text-lg">
                            <i class="fa-solid fa-wand-magic-sparkles text-yellow-500"></i>
                            Giải pháp Kê khai tự động cùng KiotViet
                        </h4>
                        <ul class="space-y-3 text-sm text-slate-700">
                            <li class="flex items-center gap-3 bg-white p-3 rounded-lg shadow-sm border border-slate-100"><i class="fa-solid fa-check-circle text-green-500 text-lg"></i> Tự động tổng hợp doanh thu/chi phí, lập tờ khai mẫu 01/CNKD.</li>
                            <li class="flex items-center gap-3 bg-white p-3 rounded-lg shadow-sm border border-slate-100"><i class="fa-solid fa-check-circle text-green-500 text-lg"></i> Quản lý chi phí không hóa đơn (lập Bảng kê thu mua dễ dàng).</li>
                            <li class="flex items-center gap-3 bg-white p-3 rounded-lg shadow-sm border border-slate-100"><i class="fa-solid fa-check-circle text-green-500 text-lg"></i> Kết nối nộp tờ khai trực tuyến qua cổng Thuế điện tử.</li>
                        </ul>
                    </div>
                </section>

                <!-- SECTION 5 -->
                <section id="hoa-don-so-sach" class="scroll-mt-28" data-aos="fade-up">
                    <h2 class="text-2xl font-bold text-blue-900 mb-6 flex items-center gap-3">
                        <span class="bg-white text-blue-600 w-10 h-10 flex items-center justify-center rounded-full text-lg font-black border border-blue-200 shadow-sm">5</span> 
                        Hóa Đơn Điện Tử & Sổ Sách Kế Toán
                    </h2>

                    <div class="grid md:grid-cols-2 gap-6 mb-6">
                        <div class="bg-white p-6 rounded-xl border border-slate-200 shadow-sm">
                            <h4 class="font-bold text-blue-800 mb-3 flex items-center gap-2"><i class="fa-solid fa-file-invoice"></i> Quy định Hóa đơn điện tử</h4>
                            <ul class="list-disc pl-5 text-sm text-slate-700 space-y-2">
                                <li><strong>Doanh thu ≥ 1 tỷ:</strong> Bắt buộc sử dụng HĐĐT thường xuyên.</li>
                                <li><strong>Doanh thu < 1 tỷ:</strong> Phải xuất hóa đơn khi khách yêu cầu.</li>
                            </ul>
                        </div>
                        <div class="bg-white p-6 rounded-xl border border-slate-200 shadow-sm">
                            <h4 class="font-bold text-green-800 mb-3 flex items-center gap-2"><i class="fa-solid fa-book"></i> Sổ sách & Chứng từ</h4>
                            <ul class="list-disc pl-5 text-sm text-slate-700 space-y-2">
                                <li>Phải ghi chép sổ sách theo <strong>Thông tư 88/2021/TT-BTC</strong>.</li>
                                <li><strong>Chi phí không hóa đơn:</strong> Lập Bảng kê thu mua.</li>
                            </ul>
                        </div>
                    </div>
                </section>

                <!-- SECTION 6 -->
                <section id="rui-ro" class="scroll-mt-28" data-aos="fade-up">
                    <h2 class="text-2xl font-bold text-blue-900 mb-6 flex items-center gap-3">
                        <span class="bg-white text-blue-600 w-10 h-10 flex items-center justify-center rounded-full text-lg font-black border border-blue-200 shadow-sm">6</span> 
                        Nhận Diện Rủi Ro Pháp Lý
                    </h2>

                    <div class="overflow-x-auto rounded-xl border border-slate-200 shadow-sm bg-white">
                        <table class="tax-table w-full text-left">
                            <thead>
                                <tr>
                                    <th>Hành Vi Vi Phạm</th>
                                    <th>Mức Phạt Tham Khảo</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td class="font-medium text-slate-800">Chậm nộp tờ khai thuế</td>
                                    <td class="text-red-600 font-bold">Cảnh cáo hoặc 2 - 25 triệu đồng</td>
                                </tr>
                                <tr>
                                    <td class="font-medium text-slate-800">Không lập hóa đơn khi bán</td>
                                    <td class="text-red-600 font-bold">10 - 20 triệu đồng <span class="text-xs font-normal text-slate-500 block">(nguy cơ bị coi là trốn thuế)</span></td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </section>
                
            </article>
        </div>
    </main>

    <!-- Footer -->
    <footer class="bg-white/60 backdrop-blur-md border-t border-white/50 mt-10 py-8 relative z-10">
        <div class="max-w-6xl mx-auto px-4 sm:px-6 lg:px-8 text-center">
            <div class="inline-block mb-4">
                <img src="https://logo.kiotviet.vn/KiotViet-Logo-Horizontal.svg" alt="KiotViet Logo" class="h-8 mx-auto">
            </div>
            <p class="text-slate-500 font-medium text-sm">Learning and Development Department</p>
            <p class="text-slate-400 text-xs mt-2">© 2026 KiotViet. All rights reserved.</p>
        </div>
    </footer>
    
    <!-- Floating Buttons -->
    <div class="fixed bottom-6 right-6 z-50 flex flex-col items-center space-y-3">
        <a href="https://notebooklm.google.com/notebook/17ae9fc0-6d1b-4ab5-ab0f-3f980651062e" target="_blank" class="float-btn w-12 h-12 bg-gradient-to-br from-indigo-500 to-purple-600 text-white rounded-full flex items-center justify-center shadow-lg border-2 border-white hover:scale-110">
            <i class="fa-solid fa-robot"></i>
        </a>
        <a id="scroll-to-top" href="#top" title="Lên đầu Trang" class="hidden w-12 h-12 bg-white text-slate-600 border border-slate-200 rounded-full items-center justify-center shadow-lg transition-all duration-300 hover:scale-110 hover:bg-slate-50">
            <i class="fas fa-arrow-up"></i>
        </a>
    </div>

    <!-- Scripts -->
    <script src="https://unpkg.com/aos@2.3.1/dist/aos.js"></script>
    <script>
        document.addEventListener('DOMContentLoaded', function () {
            AOS.init({ once: true, duration: 800, easing: 'ease-out-cubic', offset: 50 });
            
            const scrollTopBtn = document.getElementById('scroll-to-top');
            window.onscroll = function() {
                if (document.body.scrollTop > 300 || document.documentElement.scrollTop > 300) {
                    scrollTopBtn.classList.remove('hidden');
                    scrollTopBtn.classList.add('flex'); 
                } else {
                    scrollTopBtn.classList.add('hidden');
                    scrollTopBtn.classList.remove('flex');
                }
            };

            const observer = new IntersectionObserver((entries) => {
                entries.forEach(entry => {
                    if (entry.isIntersecting) {
                        const id = entry.target.getAttribute('id');
                        document.querySelectorAll('.toc-link').forEach(link => {
                            link.classList.remove('active');
                            if (link.getAttribute('href') === `#${id}`) link.classList.add('active');
                        });
                    }
                });
            }, { rootMargin: '-20% 0px -60% 0px' });
            document.querySelectorAll('section').forEach(section => observer.observe(section));
        });

        // --- Calculator Logic ---
        function formatCurrency(input) {
            let value = input.value.replace(/\D/g, '');
            if (value === '') return;
            input.value = parseInt(value).toLocaleString('en-US');
        }

        function formatMoney(amount) {
            return parseInt(amount).toLocaleString('vi-VN') + " đ";
        }

        function toggleExpenseInput() {
            const expenseContainer = document.getElementById('expenseContainer');
            const checkbox = document.getElementById('expenseToggle');
            if (checkbox.checked) {
                expenseContainer.classList.remove('hidden');
            } else {
                expenseContainer.classList.add('hidden');
                document.getElementById('expenseInput').value = '';
            }
        }

        function calculateTax() {
            // 1. Get Inputs
            const revenueStr = document.getElementById('revenueInput').value.replace(/,/g, '');
            const revenue = parseInt(revenueStr);
            const expenseStr = document.getElementById('expenseInput').value.replace(/,/g, '');
            const expense = expenseStr ? parseInt(expenseStr) : 0;
            const hasExpense = document.getElementById('expenseToggle').checked;
            const sectorValue = document.getElementById('sectorInput').value;
            
            // UI Elements
            const resultPlaceholder = document.getElementById('resultPlaceholder');
            const resultContent = document.getElementById('resultContent');
            const groupBadge = document.getElementById('groupBadge');
            const vatResultEl = document.getElementById('vatResult');
            const pitResultEl = document.getElementById('pitResult');
            const totalTaxEl = document.getElementById('totalTax');
            const vatFormulaEl = document.getElementById('vatFormula');
            const pitFormulaEl = document.getElementById('pitFormula');
            const taxDetailsEl = document.getElementById('taxDetails');

            // 2. Validation
            if (isNaN(revenue) || revenue < 0) {
                alert("Vui lòng nhập doanh thu hợp lệ!");
                return;
            }

            // 3. Logic
            resultPlaceholder.classList.add('hidden');
            resultContent.classList.remove('hidden');

            const THRESHOLD = 500000000; // 500 mil

            if (revenue <= THRESHOLD) {
                // Group 1
                groupBadge.className = "inline-block px-4 py-1.5 rounded-full text-sm font-bold uppercase tracking-wider bg-green-100 text-green-700 shadow-sm border border-green-200";
                groupBadge.textContent = "Nhóm 1 - Miễn Thuế";
                
                vatResultEl.textContent = "0 đ";
                pitResultEl.textContent = "0 đ";
                totalTaxEl.textContent = "0 đ";
                
                vatFormulaEl.innerHTML = "Doanh thu (" + formatMoney(revenue) + ") ≤ 500tr => <strong>Miễn VAT</strong>";
                pitFormulaEl.innerHTML = "Doanh thu (" + formatMoney(revenue) + ") ≤ 500tr => <strong>Miễn TNCN</strong>";
                
                taxDetailsEl.classList.add('opacity-70');
            } else {
                // Group 2 or 3
                groupBadge.className = "inline-block px-4 py-1.5 rounded-full text-sm font-bold uppercase tracking-wider bg-blue-100 text-blue-700 shadow-sm border border-blue-200";
                groupBadge.textContent = revenue > 3000000000 ? "Nhóm 3 - Phải Kê Khai (Tháng/Quý)" : "Nhóm 2 - Phải Kê Khai (Quý)";
                taxDetailsEl.classList.remove('opacity-70');

                // Rates
                const [vatRateRatio, pitRateRatio] = sectorValue.split('-').map(Number);
                const vatRate = vatRateRatio / 100;
                const pitRate = pitRateRatio / 100;

                // --- VAT Calculation ---
                // VAT is calculated on FULL revenue (current interpretation of the guide)
                const vatAmount = revenue * vatRate;
                vatFormulaEl.innerHTML = `${formatMoney(revenue)} x ${vatRateRatio}% = <strong>${formatMoney(vatAmount)}</strong>`;

                // --- TNCN Calculation ---
                let pitAmount = 0;
                
                if (hasExpense) {
                    // Method: Profit
                    const profit = revenue - expense;
                    
                    if (profit > 0) {
                        let profitTaxRate = 0.15; // Default < 3B
                        let rateDisplay = "15%";
                        
                        if (revenue > 50000000000) { profitTaxRate = 0.20; rateDisplay = "20%"; }
                        else if (revenue > 3000000000) { profitTaxRate = 0.17; rateDisplay = "17%"; }
                        
                        pitAmount = profit * profitTaxRate;
                        
                        pitFormulaEl.innerHTML = `Lợi nhuận (${formatMoney(profit)}) x ${rateDisplay} = <strong>${formatMoney(pitAmount)}</strong><br><span class='text-[10px] italic text-slate-500'>(Lợi nhuận = ${formatMoney(revenue)} - ${formatMoney(expense)})</span>`;
                    } else {
                        pitAmount = 0;
                        pitFormulaEl.innerHTML = `Lợi nhuận (${formatMoney(profit)}) ≤ 0 => <strong>Không nộp TNCN</strong>`;
                    }
                } else {
                    // Method: Revenue Ratio (with threshold deduction)
                    const taxableRevenueForPIT = revenue - THRESHOLD;
                    if (taxableRevenueForPIT > 0) {
                        pitAmount = taxableRevenueForPIT * pitRate;
                        pitFormulaEl.innerHTML = `(${formatMoney(revenue)} - 500tr) x ${pitRateRatio}% = <strong>${formatMoney(pitAmount)}</strong>`;
                    } else {
                         // Should not happen here as we checked revenue <= threshold earlier, but for safety
                        pitAmount = 0;
                        pitFormulaEl.innerHTML = "Doanh thu chưa vượt ngưỡng chịu thuế TNCN";
                    }
                }

                const totalAmount = vatAmount + pitAmount;

                // Update UI Numbers
                vatResultEl.textContent = formatMoney(vatAmount);
                pitResultEl.textContent = formatMoney(pitAmount);
                totalTaxEl.textContent = formatMoney(totalAmount);
            }
        }
    </script>
</body>
</html>
