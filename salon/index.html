<!DOCTYPE html>
<html lang="vi" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>KiotViet Salon - Hướng dẫn & E-Learning</title>
    <meta name="description" content="Tổng hợp kiến thức và hướng dẫn sử dụng phần mềm KiotViet ngành hàng Salon, Spa, Hair, Nails.">
    
    <script src="https://cdn.tailwindcss.com"></script>
    
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800;900&display=swap" rel="stylesheet">
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

    <style>
        body { 
            font-family: 'Inter', sans-serif;
            background-color: #f0f9ff; /* Sky-50 - Theo chuẩn Template Thuế */
        }

        /* Custom Scrollbar - Standard Blue Theme */
        ::-webkit-scrollbar { width: 6px; }
        ::-webkit-scrollbar-track { background: #f0f9ff; }
        ::-webkit-scrollbar-thumb { background: #93c5fd; border-radius: 3px; }
        ::-webkit-scrollbar-thumb:hover { background: #3b82f6; }

        /* Soft Glow Background - Theo chuẩn Template Thuế */
        .soft-glow-background { 
            position: fixed; top: 0; left: 0; width: 100%; height: 100%; z-index: -10; 
            background: linear-gradient(135deg, #ffffff 0%, #e0f2fe 50%, #dcfce7 100%);
        }
        .soft-glow-background .shape { position: absolute; filter: blur(120px); opacity: 0.6; }
        .soft-glow-background .shape1 { height: 400px; width: 400px; background: #bae6fd; border-radius: 50%; top: -50px; left: -100px; }
        .soft-glow-background .shape2 { height: 450px; width: 450px; background: #bbf7d0; border-radius: 50%; bottom: -100px; right: -100px; }
        .soft-glow-background .shape3 { height: 300px; width: 500px; background: #a5f3fc; border-radius: 50%; top: 50%; left: 50%; }

        /* Sidebar Navigation Active State */
        .sidebar-link.active {
            color: #15803d; /* Green-700 */
            background-color: #f0fdf4; /* Green-50 */
            border-left-color: #15803d;
            font-weight: 700;
        }

        /* Article Link Style */
        .article-item {
            display: flex;
            align-items: center;
            justify-content: space-between; 
            padding: 12px 16px;
            border-bottom: 1px dashed #cbd5e1; 
            transition: background-color 0.2s; 
            gap: 8px; 
            flex-wrap: nowrap; 
        }
        .article-item:last-child {
            border-bottom: none;
        }
        .article-item:hover {
            background-color: #f0f9ff;
        }

        .article-title {
            flex: 1; 
            font-size: 0.875rem;
            font-weight: 500;
            color: #334155;
            line-height: 1.5;
        }
        
        /* Floating Button Simple Transition */
        .float-btn {
            transition: transform 0.2s;
        }
        .float-btn:hover {
            transform: scale(1.05);
        }
        .float-btn:active {
            transform: scale(0.95);
        }

        /* Tooltip CSS */
        .tooltip {
            position: relative;
            display: inline-block;
        }
        .tooltip .tooltiptext {
            visibility: hidden;
            width: 90px;
            background-color: #334155;
            color: #fff;
            text-align: center;
            border-radius: 4px;
            padding: 4px 0;
            position: absolute;
            z-index: 10;
            bottom: 135%;
            left: 50%;
            margin-left: -45px;
            opacity: 0;
            transition: opacity 0.2s;
            font-size: 10px;
            font-weight: 500;
            white-space: nowrap;
        }
        .tooltip .tooltiptext::after {
            content: "";
            position: absolute;
            top: 100%;
            left: 50%;
            margin-left: -5px;
            border-width: 5px;
            border-style: solid;
            border-color: #334155 transparent transparent transparent;
        }
        .tooltip:hover .tooltiptext {
            visibility: visible;
            opacity: 1;
        }

        /* --- NAVBAR PILL STYLES --- */
        .nav-pill {
            display: flex;
            align-items: center;
            gap: 8px;
            padding: 8px 16px;
            border-radius: 9999px;
            font-size: 0.875rem; /* text-sm */
            font-weight: 600;
            border: 1px solid transparent;
            transition: all 0.2s;
            color: #64748b; /* slate-500 */
            border-color: #e2e8f0; /* slate-200 */
            background-color: transparent;
        }
        .nav-pill:hover {
            background-color: #f8fafc;
        }

        /* Retail Hover */
        .nav-pill.retail:hover { color: #2563eb; border-color: #2563eb; background-color: #eff6ff; }
        /* FNB Hover */
        .nav-pill.fnb:hover { color: #ea580c; border-color: #ea580c; background-color: #fff7ed; }
        /* Salon Hover - [SỬA] Đổi sang hồng nhạt hơn (#ec4899 - pink-500) */
        .nav-pill.salon:hover { color: #ec4899; border-color: #ec4899; background-color: #fdf2f8; }
        /* Hotel Hover */
        .nav-pill.hotel:hover { color: #16a34a; border-color: #16a34a; background-color: #f0fdf4; }
        /* Thue Hover */
        .nav-pill.thue:hover { color: #2563eb; border-color: #2563eb; background-color: #eff6ff; }

        /* Active State Styles (Filled) */
        .nav-pill.active {
            color: white;
            border-color: transparent;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
        }
        
        /* [ĐÃ SỬA] Đảm bảo khi hover vào active button chữ vẫn màu trắng */
        .nav-pill.active:hover {
            color: white !important;
        }

        .nav-pill.retail.active { background-color: #2563eb; }
        .nav-pill.fnb.active { background-color: #ea580c; }
        /* [SỬA] Đổi background active sang hồng nhạt hơn (#ec4899) */
        .nav-pill.salon.active { background-color: #ec4899; } 
        .nav-pill.hotel.active { background-color: #16a34a; }
        .nav-pill.thue.active { 
            background: linear-gradient(to right, #2563eb, #15803d); 
            color: white;
            border-color: transparent;
        }

        /* --- MODAL CSS --- */
        #learning-modal {
            display: none; /* Hidden by default */
            position: fixed;
            z-index: 9999; /* Top level */
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            overflow: hidden;
            background-color: rgba(0,0,0,0.6); /* Black background with opacity */
            backdrop-filter: blur(4px);
            opacity: 0;
            transition: opacity 0.3s ease;
        }

        #learning-modal.open {
            display: flex;
            align-items: center;
            justify-content: center;
            opacity: 1;
        }

        .modal-content {
            background-color: #fefefe;
            width: 90%;
            height: 90%;
            border-radius: 12px;
            box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04);
            display: flex;
            flex-direction: column;
            transform: scale(0.95);
            transition: transform 0.3s ease;
            overflow: hidden;
        }

        #learning-modal.open .modal-content {
            transform: scale(1);
        }

        .modal-header {
            padding: 12px 20px;
            background-color: #fff;
            border-bottom: 1px solid #e2e8f0;
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-shrink: 0;
        }

        .modal-body {
            flex-grow: 1;
            background-color: #f1f5f9;
            position: relative;
            overflow: hidden;
        }

        iframe.course-frame {
            width: 100%;
            height: 100%;
            border: none;
            display: block;
        }
    </style>
</head>
<body id="top" class="text-slate-700 antialiased selection:bg-pink-100 selection:text-pink-900">

    <div class="soft-glow-background">
        <div class="shape shape1"></div>
        <div class="shape shape2"></div>
        <div class="shape shape3"></div>
    </div>

    <header class="sticky top-0 z-50 bg-white/80 backdrop-blur-md border-b border-white/50 h-20 shadow-sm">
        <div class="max-w-screen-2xl mx-auto px-4 sm:px-6 lg:px-8 h-full">
            <div class="flex items-center justify-between h-full gap-4 lg:gap-8">
                <!-- Logo Area -->
                <a href="https://kiotvietlnd.github.io/elearning/" class="flex-shrink-0 flex items-center gap-3 select-none hover:opacity-80 transition-opacity" title="Về trang chủ E-Learning">
                    <img src="https://logo.kiotviet.vn/KiotViet-Logo-Horizontal.svg" alt="KiotViet Logo" class="h-6 lg:h-8">
                    <span class="text-slate-300 font-light text-xl lg:text-2xl">|</span>
                    <span class="font-bold text-transparent bg-clip-text bg-gradient-to-r from-blue-700 to-green-700 tracking-tight text-base lg:text-lg uppercase">E-Learning</span>
                </a>

                <!-- New Navigation Menu -->
                <nav class="hidden lg:flex flex-1 justify-end items-center gap-2 xl:gap-3">
                    <a href="https://kiotvietlnd.github.io/elearning/retail" class="nav-pill retail">
                        <i class="fa-solid fa-shop"></i> KiotViet Retail
                    </a>
                    
                    <a href="https://kiotvietlnd.github.io/elearning/fnb" class="nav-pill fnb">
                        <i class="fa-solid fa-utensils"></i> KiotViet FNB
                    </a>
                    
                    <!-- Active Item: Salon (Pink) -->
                    <a href="https://kiotvietlnd.github.io/elearning/salon" class="nav-pill salon active">
                        <i class="fa-solid fa-spa"></i> KiotViet Salon
                    </a>
                    
                    <a href="https://kiotvietlnd.github.io/elearning/hotel" class="nav-pill hotel">
                        <i class="fa-solid fa-hotel"></i> KiotViet Hotel
                    </a>

                    <a href="https://kiotvietlnd.github.io/elearning/thuehkd" class="nav-pill thue">
                        <i class="fa-solid fa-scale-balanced"></i> Cẩm nang Thuế HKD
                    </a>
                </nav>
                
                <!-- Mobile Menu Button -->
                <div class="lg:hidden">
                    <button class="text-slate-600 hover:text-green-700 text-2xl"><i class="fa-solid fa-bars"></i></button>
                </div>
            </div>
        </div>
    </header>

    <main class="max-w-screen-2xl mx-auto px-4 sm:px-6 lg:px-8 py-8 min-h-[80vh]">
        
        <div class="flex flex-col lg:flex-row gap-8">
            <aside class="lg:w-1/4 hidden lg:block">
                <div class="sticky top-28 bg-white/90 backdrop-blur rounded-2xl p-4 shadow-md border border-white/50 overflow-y-auto max-h-[calc(100vh-140px)] custom-scrollbar">
                    <!-- [SỬA] border-pink-500 (giữ nguyên hoặc chỉnh nếu cần, ở đây pink-500 là đẹp) -->
                    <h2 class="font-bold text-slate-800 text-xl uppercase mb-3 px-1 border-b-2 border-pink-500 inline-block pb-1">KiotViet Salon</h2>
                    
                    <div class="mb-4 relative group">
                        <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
                            <!-- [SỬA] text-pink-600 -> text-pink-500 -->
                            <i class="fa-solid fa-magnifying-glass text-slate-400 group-hover:text-pink-500 transition-colors"></i>
                        </div>
                        <input type="text" id="search-input" placeholder="Tìm kiếm nội dung..." 
                            class="w-full pl-10 pr-3 py-2 rounded-lg border border-slate-200 focus:border-pink-500 focus:ring-1 focus:ring-pink-100 shadow-sm transition-all text-sm text-slate-700 bg-slate-50 font-inter">
                    </div>

                    <nav id="salon-sidebar" class="space-y-1">
                        <!-- Sidebar will be injected by JS -->
                    </nav>
                </div>
            </aside>

            <div class="lg:w-3/4 w-full">
                <!-- [SỬA] border-pink-600 -> border-pink-500 -->
                <div class="mb-10 pl-4 border-l-4 border-pink-500">
                    <h1 class="text-3xl font-black text-slate-800 tracking-tight leading-normal pb-2">
                        <!-- [SỬA] text-pink-600 -> text-pink-500 -->
                        <span class="text-pink-500">KiotViet Salon</span> <span class="text-slate-400 font-light mx-2">|</span> <span class="text-slate-600">Hướng dẫn sử dụng & E-Learning</span>
                    </h1>
                    <p class="text-slate-500 mt-1 font-medium text-lg">Hệ thống bài giảng và tài liệu hướng dẫn chi tiết dành cho Salon, Spa, Hair, Nails.</p>
                </div>
                <div id="salon-content">
                    <!-- Content will be injected by JS -->
                </div>
            </div>
        </div>

    </main>
    
    <footer class="bg-white/60 backdrop-blur-md border-t border-white/50 mt-10 py-8 relative z-10">
        <div class="max-w-6xl mx-auto px-4 sm:px-6 lg:px-8 text-center">
            <div class="inline-block mb-4">
                <img src="https://logo.kiotviet.vn/KiotViet-Logo-Horizontal.svg" alt="KiotViet Logo" class="h-8 mx-auto">
            </div>
            <p class="text-slate-500 font-medium text-sm">Learning and Development Department</p>
            <p class="text-slate-400 text-xs mt-2">© 2026 KiotViet. All rights reserved.</p>
        </div>
    </footer>

    <div class="fixed bottom-6 left-6 z-50 flex flex-col items-center space-y-3">
        <button id="scroll-prev-section" title="Lên mục trước" class="float-btn w-10 h-10 bg-white text-slate-500 border border-slate-200 rounded-full flex items-center justify-center shadow-lg hover:bg-slate-50 hover:text-blue-600">
            <i class="fas fa-chevron-up"></i>
        </button>

        <button id="scroll-next-section" title="Xuống mục tiếp" class="float-btn w-10 h-10 bg-white text-slate-500 border border-slate-200 rounded-full flex items-center justify-center shadow-lg hover:bg-slate-50 hover:text-blue-600">
            <i class="fas fa-chevron-down"></i>
        </button>
    </div>

    <div id="learning-modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 id="modal-title" class="font-bold text-lg text-slate-800 flex items-center gap-2">
                    <!-- [SỬA] text-pink-600 -> text-pink-500 -->
                    <i class="fa-solid fa-graduation-cap text-pink-500"></i>
                    <span>Nội dung chi tiết</span>
                </h3>
                <div class="flex items-center gap-2">
                    <a id="open-new-tab-btn" href="#" target="_blank" class="text-xs font-medium text-blue-600 hover:underline mr-2" title="Mở trong tab mới">
                        <i class="fa-solid fa-arrow-up-right-from-square"></i> Mở tab mới
                    </a>
                    <button id="close-modal-btn" class="w-8 h-8 rounded-full bg-slate-100 text-slate-500 hover:bg-red-100 hover:text-red-600 transition-colors flex items-center justify-center">
                        <i class="fa-solid fa-xmark text-lg"></i>
                    </button>
                </div>
            </div>
            <div class="modal-body">
                <iframe id="course-iframe" class="course-frame" src="" allowfullscreen allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture"></iframe>
            </div>
        </div>
    </div>

    <script>
        let currentSectionIndex = 0;

        // --- 1. DATA DEFINITION (SALON) ---
        const salonData = [
            {
                category: "Đào tạo E-Learning",
                sidebarIcon: "fa-graduation-cap",
                topics: [
                    {
                        title: "Làm quen với KiotViet Salon",
                        icon: "fa-rocket",
                        articles: [
                            { 
                                title: "Bước 1 - Khởi tạo dữ liệu", 
                                guideLink: "", 
                                videoLink: "https://www.youtube.com/watch?v=dIKjQ2Plg0Y", 
                                quizLink: "https://kiotvietlnd.github.io/elearning/salon/quiz/b1-khoi-tao-du-lieu", 
                                isNew: true 
                            },
                            { 
                                title: "Bước 2 - Quản lý nhân viên", 
                                guideLink: "", 
                                videoLink: "https://www.youtube.com/watch?v=YpISBeOdtkM", 
                                quizLink: "https://kiotvietlnd.github.io/elearning/salon/quiz/b2-quan-ly-nhan-vien", 
                                isNew: true 
                            },
                            { 
                                title: "Bước 3 - Thêm mới lịch hẹn", 
                                guideLink: "", 
                                videoLink: "https://www.youtube.com/watch?v=TdTU-n3VLgg", 
                                quizLink: "https://kiotvietlnd.github.io/elearning/salon/quiz/b3-them-moi-lich-hen", 
                                isNew: true 
                            },
                            { 
                                title: "Bước 4 - Tư vấn bán hàng", 
                                guideLink: "", 
                                videoLink: "https://www.youtube.com/watch?v=ph8XpaIcR3Q", 
                                quizLink: "https://kiotvietlnd.github.io/elearning/salon/quiz/b4-tu-van-ban-hang", 
                                isNew: true 
                            },
                            { 
                                title: "Bước 5 - Quản lý tài chính", 
                                guideLink: "", 
                                videoLink: "https://www.youtube.com/watch?v=4RumA-ZT4Dk", 
                                quizLink: "https://kiotvietlnd.github.io/elearning/salon/quiz/b5-quan-ly-tai-chinh", 
                                isNew: true 
                            },
                            { 
                                title: "Bước 6 - App KiotViet Salon", 
                                guideLink: "", 
                                videoLink: "https://www.youtube.com/watch?v=352NDMAmyP8", 
                                quizLink: "https://kiotvietlnd.github.io/elearning/salon/quiz/b6-app-kiotviet-salon", 
                                isNew: true 
                            }
                        ]
                    }
                ]
            },
            {
                category: "Công cụ tiện ích",
                sidebarIcon: "fa-toolbox",
                topics: [
                    {
                        title: "Video Playlist HDSD Salon",
                        icon: "fa-video",
                        articles: [
                            { 
                                title: "Playlist - Tổng hợp Giải pháp KiotViet Salon", 
                                guideLink: "https://www.youtube.com/playlist?list=PL3x3GXJzpHzSh1d0ANq3K4t1gVoAP1plT", 
                                isNew: false 
                            },
                            { 
                                title: "Playlist - Làm quen KiotViet Salon", 
                                guideLink: "https://www.youtube.com/playlist?list=PL3x3GXJzpHzRJOhjbuJAkLDCNj4czJgKQ", 
                                isNew: false 
                            },
                            { 
                                title: "Playlist - Giải pháp thanh toán - KiotViet", 
                                guideLink: "https://www.youtube.com/playlist?list=PL3x3GXJzpHzT3GEXv7EVy77awRAEQuWln", 
                                isNew: false 
                            },
                            { 
                                title: "Playlist - Trọn bộ Thiết bị phần cứng - KiotViet", 
                                guideLink: "https://www.youtube.com/playlist?list=PL3x3GXJzpHzT3GEXv7EVy77awRAEQuWln", 
                                isNew: false 
                            },
                            { 
                                title: "Playlist - HĐĐT - Chữ ký số - Phần mềm Kế toán", 
                                guideLink: "https://www.youtube.com/playlist?list=PL3x3GXJzpHzSig3jxKN_M3M7yaxkIoWlY", 
                                isNew: false 
                            }
                        ]
                    }
                ]
            }
        ];

        // --- 2. FUNCTION DEFINITIONS ---

        function renderSalonContent() {
            const sidebar = document.getElementById('salon-sidebar');
            const content = document.getElementById('salon-content');
            let sidebarHtml = '';
            let contentHtml = '';

            salonData.forEach((section, index) => {
                const sectionId = `salon-cat-${index}`;
                const activeClass = index === 0 ? 'active' : '';
                
                const sidebarHighlightClass = 'text-slate-600 hover:text-blue-800 hover:bg-white';
                
                const starIcon = section.category === "Đào tạo E-Learning" 
                    ? '<i class="fa-solid fa-star text-yellow-400 ml-auto order-last"></i>' 
                    : '';

                sidebarHtml += `
                    <a href="#${sectionId}" class="sidebar-link ${activeClass} block px-3 py-2 text-sm font-medium rounded-lg transition-colors border-l-2 border-transparent ${sidebarHighlightClass} flex items-center justify-between">
                        <span><i class="fa-solid ${section.sidebarIcon} mr-2 w-5 text-center text-slate-400 group-hover:text-blue-600"></i>${section.category}</span>
                        ${starIcon}
                    </a>
                `;

                // Section Banner - Alternating Blue/Green (Standard)
                const isEven = index % 2 === 0;
                const bannerBgClass = isEven ? 'bg-blue-700' : 'bg-green-700'; 

                contentHtml += `
                    <div id="${sectionId}" class="scroll-mt-40 mb-16">
                        <div class="relative flex items-center justify-center mb-8">
                            <div class="absolute inset-0 flex items-center">
                                <div class="w-full border-t border-slate-300"></div>
                            </div>
                            <h2 class="relative z-10 ${bannerBgClass} text-white px-8 py-2 rounded-full text-lg font-bold uppercase tracking-wide shadow-md">
                                <span class="mr-2 opacity-80">${index + 1}.</span> ${section.category}
                            </h2>
                        </div>
                        
                        <div class="grid grid-cols-1 gap-6">
                `;

                section.topics.forEach(topic => {
                    const articlesHtml = topic.articles.map(article => {
                        const tagHtml = `<div class="w-8 shrink-0 flex items-center justify-start h-full">
                            ${article.isNew ? '<span class="inline-flex items-center justify-center px-1.5 py-0.5 rounded text-[9px] font-bold bg-orange-500 text-white uppercase tracking-wider shadow-sm w-fit min-w-[30px]">Mới</span>' : ''}
                        </div>`;

                        // Case 1: Full E-Learning Item (HDSD + Video + Quiz)
                        if (article.quizLink) {
                            // HDSD Button (Blue)
                            const hdsdBtn = article.guideLink ? 
                                `<button onclick="openCourse('${article.guideLink}', '${article.title}')" class="w-8 h-8 flex items-center justify-center rounded-full bg-blue-600 text-white hover:bg-blue-700 transition-all shadow-sm" title="Hướng dẫn sử dụng"><i class="fa-solid fa-book-open text-xs"></i></button>` :
                                `<div class="tooltip"><span class="w-8 h-8 flex items-center justify-center rounded-full bg-slate-200 text-slate-400 cursor-not-allowed"><i class="fa-solid fa-book-open text-xs"></i></span><span class="tooltiptext">Đang cập nhật</span></div>`;

                            // Video Button (Red)
                            const videoBtn = article.videoLink ? 
                                `<button onclick="openCourse('${article.videoLink}', '${article.title} - Video')" class="w-8 h-8 flex items-center justify-center rounded-full bg-red-600 text-white hover:bg-red-700 transition-all shadow-sm" title="Video hướng dẫn"><i class="fa-solid fa-play text-xs"></i></button>` :
                                `<div class="tooltip"><span class="w-8 h-8 flex items-center justify-center rounded-full bg-slate-200 text-slate-400 cursor-not-allowed"><i class="fa-solid fa-play text-xs"></i></span><span class="tooltiptext">Đang cập nhật</span></div>`;

                            // Quiz Button (Green)
                            const quizBtn = `<button onclick="openCourse('${article.quizLink}', '${article.title}')" class="px-3 py-1.5 text-xs font-bold text-white bg-[#16a34a] hover:bg-green-700 rounded-full transition-all flex items-center gap-1 whitespace-nowrap shadow-sm hover:shadow-lg" title="Vào bài học"><i class="fa-solid fa-graduation-cap"></i> Vào học ngay</button>`;

                            return `
                                <div class="article-item group/item">
                                    ${tagHtml}
                                    <span class="text-sm font-medium text-slate-700 article-title flex-1 group-hover:text-blue-700 transition-colors">${article.title}</span>
                                    <div class="flex items-center gap-2 shrink-0 mt-2 sm:mt-0">
                                        ${hdsdBtn}
                                        ${videoBtn}
                                        ${quizBtn}
                                    </div>
                                </div>
                            `;
                        } else {
                            // General Sections / Playlist - Gradient Button
                            const linkButton = article.guideLink && article.guideLink !== "#" ? 
                                `<button onclick="openCourse('${article.guideLink}', '${article.title}')" class="shrink-0 px-3 py-1 text-xs font-bold text-white bg-gradient-to-r from-blue-600 to-green-600 hover:from-blue-700 hover:to-green-700 rounded-full transition-all shadow-sm whitespace-nowrap cursor-pointer">
                                    Xem Chi tiết <i class="fa-solid fa-arrow-right ml-1"></i>
                                </button>` : 
                                `<div class="tooltip">
                                    <span class="shrink-0 px-3 py-1 text-xs font-bold text-slate-400 bg-slate-50 rounded-full cursor-not-allowed shadow-sm border border-slate-200">
                                        Đang cập nhật
                                    </span>
                                    <span class="tooltiptext">Nội dung đang được xây dựng</span>
                                </div>`;

                             return `
                                <div class="article-item group/item">
                                    ${tagHtml}
                                    <span class="text-sm font-medium text-slate-700 article-title flex-1">${article.title}</span>
                                    <div class="flex items-center gap-2 shrink-0">
                                        <div class="flex items-center gap-2">
                                            ${linkButton}
                                        </div>
                                    </div>
                                </div>
                            `;
                        }
                    }).join('');

                    const cardBg = 'bg-white shadow-md border-white/60';
                    const cardHeaderBg = 'bg-gradient-to-r from-sky-50 to-white border-sky-100';
                    const iconColor = 'text-blue-600 border-blue-100 bg-white';

                    contentHtml += `
                        <div class="section-card rounded-xl overflow-hidden transition-all hover:shadow-xl ${cardBg}">
                            <div class="${cardHeaderBg} p-4 border-b flex items-center gap-3">
                                <div class="w-10 h-10 rounded-lg flex items-center justify-center shadow-sm border ${iconColor}">
                                    <i class="fa-solid ${topic.icon} text-lg"></i>
                                </div>
                                <h3 class="font-bold text-lg text-slate-700">${topic.title}</h3>
                            </div>
                            <div class="p-0">
                                <div class="flex flex-col">
                                    ${articlesHtml}
                                </div>
                            </div>
                        </div>
                    `;
                });

                contentHtml += `</div></div>`;
            });

            sidebar.innerHTML = sidebarHtml;
            content.innerHTML = contentHtml;
        }

        // --- 3. HELPER FUNCTIONS ---

        function formatUrlForIframe(url) {
            if (!url) return '';
            
            if (url.includes('youtube.com') || url.includes('youtu.be')) {
                if (url.includes('/embed/')) return url;

                let videoId = '';
                if (url.includes('v=')) {
                    videoId = url.split('v=')[1].split('&')[0];
                } else if (url.includes('youtu.be/')) {
                    videoId = url.split('.be/')[1];
                }

                if (url.includes('list=')) {
                    const listId = url.split('list=')[1].split('&')[0];
                    return `https://www.youtube.com/embed/videoseries?list=${listId}`;
                }

                if (videoId) {
                    return `https://www.youtube.com/embed/${videoId}?autoplay=1`;
                }
            }
            return url;
        }

        function openCourse(url, title) {
            const modal = document.getElementById('learning-modal');
            const iframe = document.getElementById('course-iframe');
            const modalTitleSpan = document.querySelector('#modal-title span');
            const openNewTabBtn = document.getElementById('open-new-tab-btn');

            if (modal && iframe) {
                const formattedUrl = formatUrlForIframe(url);
                iframe.src = formattedUrl;
                
                if (modalTitleSpan) modalTitleSpan.innerText = title || "Nội dung chi tiết";
                if (openNewTabBtn) openNewTabBtn.href = url;
                
                modal.classList.add('open');
                document.body.style.overflow = 'hidden'; 
            }
        }

        function closeCourse() {
            const modal = document.getElementById('learning-modal');
            const iframe = document.getElementById('course-iframe');

            if (modal && iframe) {
                modal.classList.remove('open');
                setTimeout(() => {
                    iframe.src = ''; 
                }, 300);
                document.body.style.overflow = ''; 
            }
        }

        function onScrollSpy() {
            const sections = document.querySelectorAll('[id^="salon-cat-"]');
            const scrollPosition = window.scrollY + (window.innerHeight / 3); 

            sections.forEach((section, index) => {
                const sectionTop = section.offsetTop;
                const sectionHeight = section.offsetHeight;
                const sectionId = section.getAttribute('id');

                if (scrollPosition >= sectionTop && scrollPosition < sectionTop + sectionHeight) {
                    currentSectionIndex = index;
                    document.querySelectorAll('.sidebar-link').forEach(link => {
                        link.classList.remove('active');
                        if (link.getAttribute('href') === `#${sectionId}`) {
                            link.classList.add('active');
                        }
                    });
                }
            });
        }

        // --- 4. MAIN EXECUTION ---
        document.addEventListener('DOMContentLoaded', function () {
            renderSalonContent();
            
            // Search
            const searchInput = document.getElementById('search-input');
            searchInput.addEventListener('input', function(e) {
                const term = e.target.value.toLowerCase();
                const articles = document.querySelectorAll('.article-item');
                
                articles.forEach(article => {
                    let title = '';
                    if (article.classList.contains('article-item')) {
                        title = article.querySelector('.article-title') ? article.querySelector('.article-title').innerText.toLowerCase() : '';
                    }
                    if (title.includes(term)) {
                        article.style.display = 'flex'; 
                    } else {
                        article.style.display = 'none';
                    }
                });

                const topicCards = document.querySelectorAll('.section-card');
                topicCards.forEach(card => {
                    const visibleArticles = card.querySelectorAll('.article-item:not([style*="display: none"])');
                    if (visibleArticles.length === 0 && term !== '') {
                        card.style.display = 'none';
                    } else {
                        card.style.display = 'block';
                    }
                });
            });
            
            // ScrollSpy
            setTimeout(onScrollSpy, 100);
            window.addEventListener('scroll', onScrollSpy);

            // Nav Buttons
            setupSectionNavigation();

            // Modal Listeners
            document.getElementById('close-modal-btn').addEventListener('click', closeCourse);
            document.getElementById('learning-modal').addEventListener('click', function(e) {
                if (e.target === this) closeCourse();
            });
            document.addEventListener('keydown', function(e) {
                if (e.key === "Escape" && document.getElementById('learning-modal').classList.contains('open')) {
                    closeCourse();
                }
            });
        });

        function setupSectionNavigation() {
            const sections = document.querySelectorAll('[id^="salon-cat-"]');
            const totalSections = sections.length;
            const nextBtn = document.getElementById('scroll-next-section');
            const prevBtn = document.getElementById('scroll-prev-section');

            if (nextBtn) {
                nextBtn.addEventListener('click', () => {
                    if (currentSectionIndex < totalSections - 1) {
                        const nextId = `salon-cat-${currentSectionIndex + 1}`;
                        scrollToSection(nextId);
                    }
                });
            }

            if (prevBtn) {
                prevBtn.addEventListener('click', () => {
                    if (currentSectionIndex > 0) {
                        const prevId = `salon-cat-${currentSectionIndex - 1}`;
                        scrollToSection(prevId);
                    }
                });
            }
        }

        function scrollToSection(id) {
            const element = document.getElementById(id);
            if (element) {
                const headerOffset = 100;
                const elementPosition = element.getBoundingClientRect().top;
                const offsetPosition = elementPosition + window.pageYOffset - headerOffset;
                window.scrollTo({ top: offsetPosition, behavior: "smooth" });
            }
        }
    </script>
</body>
</html>
