<!DOCTYPE html>
<html lang="vi" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Khóa học: Hàng hóa thường | KiotViet Retail</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800;900&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css"/>
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>
    <style>
        body { font-family: 'Inter', sans-serif; background-color: #f8fafc; color: #334155; }
        ::-webkit-scrollbar { width: 6px; }
        ::-webkit-scrollbar-track { background: #f1f1f1; }
        ::-webkit-scrollbar-thumb { background: #cbd5e1; border-radius: 3px; }
        .soft-glow-background { position: fixed; top: 0; left: 0; width: 100%; height: 100%; z-index: -10; background: linear-gradient(to bottom right, #f8fafc, #e0f2fe); }
        .nav-link { position: relative; transition: color 0.3s; }
        .nav-link.active { color: var(--theme-color); }
        .glass-card { background: rgba(255, 255, 255, 0.9); backdrop-filter: blur(10px); border: 1px solid rgba(255, 255, 255, 0.8); box-shadow: 0 4px 6px -1px rgba(0,0,0,0.05); transition: all 0.3s ease; }
        .glass-card:hover { transform: translateY(-4px); box-shadow: 0 15px 30px -5px rgba(0,0,0,0.1); }
        .perspective-1000 { perspective: 1000px; }
        .flip-card-inner { position: relative; width: 100%; height: 100%; text-align: center; transition: transform 0.6s; transform-style: preserve-3d; cursor: pointer; }
        .flip-card.flipped .flip-card-inner { transform: rotateY(180deg); }
        .flip-card-front, .flip-card-back { position: absolute; width: 100%; height: 100%; backface-visibility: hidden; display: flex; flex-direction: column; align-items: center; justify-content: center; border-radius: 1rem; }
        .flip-card-back { transform: rotateY(180deg); }
        .float-btn { transition: transform 0.2s; }
        .float-btn:hover { transform: scale(1.1); }
        .tab-btn { position: relative; transition: all 0.3s ease; }
        .tab-btn::after { content: ''; position: absolute; bottom: -2px; left: 0; width: 0; height: 2px; background-color: currentColor; transition: width 0.3s ease; }
        .tab-btn.active::after { width: 100%; }
        .modal { transition: opacity 0.3s ease; }
        body.modal-active { overflow: hidden; }
        .knowledge-list li::marker { color: var(--theme-color); font-weight: bold; }
        @media print { body * { visibility: hidden; } #certificate-modal, #certificate-modal * { visibility: visible; } #certificate-modal { position: absolute; left: 0; top: 0; width: 100%; height: 100%; background: white; } .no-print { display: none; } }
    </style>
</head>
<body id="top" class="text-slate-700 antialiased selection:bg-blue-100 selection:text-blue-900">
    <div class="soft-glow-background"></div>

    <header class="sticky top-0 z-50 bg-white/90 backdrop-blur-md border-b border-slate-200 h-20">
        <div class="max-w-6xl mx-auto px-4 sm:px-6 lg:px-8 h-full">
            <div class="flex items-center justify-between h-full gap-8">
                <a href="https://kiotvietlnd.github.io/elearning" class="flex-shrink-0 flex items-center gap-3 hover:opacity-80">
                    <img src="https://logo.kiotviet.vn/KiotViet-Logo-Horizontal.svg" alt="KiotViet Logo" class="h-8">
                    <span class="text-slate-300 font-light text-2xl">|</span>
                    <span class="font-bold text-blue-600 tracking-tight text-lg uppercase">E-Learning</span>
                </a>
                <nav class="hidden lg:flex flex-1 justify-end items-center gap-8">
                    <a href="https://kiotvietlnd.github.io/elearning/retail" class="nav-link text-sm font-bold text-slate-600 hover:text-blue-600 uppercase py-1">Retail</a>
                    <a href="https://kiotvietlnd.github.io/elearning/fnb" class="nav-link text-sm font-bold text-slate-600 hover:text-orange-600 uppercase py-1">FNB</a>
                    <a href="https://kiotvietlnd.github.io/elearning/salon" class="nav-link text-sm font-bold text-slate-600 hover:text-pink-600 uppercase py-1">Salon</a>
                    <a href="https://kiotvietlnd.github.io/elearning/hotel" class="nav-link text-sm font-bold text-slate-600 hover:text-green-600 uppercase py-1">Hotel</a>
                    <div class="h-6 w-px bg-slate-300"></div>
                    <a href="https://kiotvietlnd.github.io/elearning/retail" class="flex items-center gap-2 px-4 py-2 bg-slate-100 text-slate-600 rounded-full font-bold text-sm border border-slate-200 hover:bg-slate-200 hover:text-blue-700 transition-all">
                        <i class="fa-solid fa-arrow-left"></i> Quay lại Danh mục
                    </a>
                </nav>
                <div class="lg:hidden">
                    <button onclick="document.getElementById('mobile-menu').classList.toggle('hidden')" class="text-slate-600 text-2xl p-2"><i class="fa-solid fa-bars"></i></button>
                </div>
            </div>
        </div>
        <div id="mobile-menu" class="hidden lg:hidden bg-white border-b border-slate-200 shadow-lg absolute w-full left-0 top-20 z-50">
            <div class="px-4 pt-2 pb-4 space-y-2">
                <a href="https://kiotvietlnd.github.io/elearning/retail" class="block px-3 py-2 rounded-md text-base font-bold text-blue-600 bg-blue-50">Retail</a>
                <a href="https://kiotvietlnd.github.io/elearning/fnb" class="block px-3 py-2 rounded-md text-base font-medium text-slate-600 hover:text-orange-600 hover:bg-orange-50">FNB</a>
                <a href="https://kiotvietlnd.github.io/elearning/salon" class="block px-3 py-2 rounded-md text-base font-medium text-slate-600 hover:text-pink-600 hover:bg-pink-50">Salon</a>
                <a href="https://kiotvietlnd.github.io/elearning/hotel" class="block px-3 py-2 rounded-md text-base font-medium text-slate-600 hover:text-green-600 hover:bg-green-50">Hotel</a>
                <div class="border-t border-slate-200 my-2 pt-2">
                    <a href="https://kiotvietlnd.github.io/elearning/retail" class="flex items-center gap-2 px-3 py-2 text-base font-bold text-slate-600 hover:text-blue-600">
                        <i class="fa-solid fa-arrow-left"></i> Quay lại Danh mục
                    </a>
                </div>
            </div>
        </div>
    </header>

    <main class="max-w-5xl mx-auto px-4 sm:px-6 lg:px-8 py-10 min-h-[80vh]">
        <div id="view-menu" class="animate__animated animate__fadeIn">
            <div class="text-center mb-12">
                <div class="inline-flex items-center gap-2 px-3 py-1 rounded-full bg-blue-50 text-blue-700 border border-blue-100 mb-4">
                    <i class="fa-solid fa-boxes-stacked text-xs"></i><span class="text-xs font-bold uppercase tracking-wider">Khóa học Retail</span>
                </div>
                <h1 class="text-3xl md:text-5xl font-black text-slate-800 tracking-tight mb-4">Hàng hóa thường</h1>
                <div class="max-w-md mx-auto bg-white rounded-full h-4 shadow-inner border border-slate-200 overflow-hidden relative">
                    <div id="course-progress" class="bg-gradient-to-r from-blue-500 to-blue-400 h-full w-0 transition-all duration-1000"></div>
                </div>
                <p class="text-xs text-slate-400 mt-2 font-bold uppercase">Tiến độ: <span id="progress-text" class="text-blue-600">0%</span></p>
            </div>
            <div class="grid grid-cols-1 md:grid-cols-2 gap-6" id="lesson-grid"></div>
            <div onclick="loadLessonFromMenu(-1)" class="mt-8 bg-gradient-to-r from-indigo-600 to-purple-600 p-1 rounded-2xl cursor-pointer group hover:scale-[1.01] transition-transform shadow-xl">
                <div class="bg-white/10 backdrop-blur-md p-6 rounded-xl flex items-center justify-between h-full">
                    <div class="flex items-center gap-5 text-white">
                        <div class="w-14 h-14 rounded-2xl bg-white/20 flex items-center justify-center text-3xl"><i class="fa-solid fa-graduation-cap"></i></div>
                        <div><h3 class="font-bold text-xl mb-1">Bài kiểm tra Tổng hợp</h3><p class="text-indigo-100 text-sm opacity-90">Hoàn thành để nhận chứng chỉ.</p></div>
                    </div>
                    <div class="w-10 h-10 rounded-full bg-white text-indigo-600 flex items-center justify-center shadow-lg"><i class="fa-solid fa-arrow-right"></i></div>
                </div>
            </div>
        </div>

        <div id="view-learning" class="hidden animate__animated animate__fadeInRight">
            <div class="flex flex-col md:flex-row justify-between items-start md:items-center gap-4 mb-6">
                <button onclick="goBack()" class="group flex items-center gap-2 text-slate-500 hover:text-blue-600 font-bold text-sm bg-white px-4 py-2 rounded-lg border border-slate-200 shadow-sm hover:shadow transition-all">
                    <i class="fa-solid fa-arrow-left group-hover:-translate-x-1 transition-transform"></i> Danh sách mục
                </button>
                <div class="flex items-center gap-3 bg-white px-4 py-2 rounded-lg border border-slate-200 shadow-sm">
                    <i class="fa-solid fa-list-check text-blue-500"></i>
                    <select id="lesson-selector" onchange="switchLessonFromDropdown(this.value)" class="bg-transparent text-sm font-bold text-slate-700 focus:outline-none cursor-pointer w-56"></select>
                </div>
            </div>
            <div class="bg-white p-8 rounded-2xl shadow-sm border border-slate-200 mb-8 relative overflow-hidden">
                <div class="absolute right-0 top-0 w-64 h-64 bg-gradient-to-br from-blue-50 to-transparent rounded-full -mr-16 -mt-16 opacity-70 pointer-events-none"></div>
                <div class="relative z-10 flex items-center gap-6">
                    <div class="w-16 h-16 rounded-2xl bg-gradient-to-br from-blue-500 to-blue-600 text-white flex items-center justify-center shrink-0 shadow-lg">
                        <i id="lesson-icon" class="fa-solid fa-book-open text-2xl"></i>
                    </div>
                    <div>
                        <div class="flex items-center gap-2 mb-1"><span class="text-[10px] font-bold text-white bg-blue-500 px-2 py-0.5 rounded uppercase tracking-wider">Đang học</span></div>
                        <div id="lesson-title-container"></div>
                        <p id="lesson-desc" class="text-slate-500 mt-2 font-medium"></p>
                    </div>
                </div>
            </div>
            <div class="mb-8 bg-white rounded-xl shadow-sm border border-slate-100 p-1 inline-flex w-full md:w-auto overflow-x-auto">
                <button onclick="switchTab('knowledge')" id="btn-tab-knowledge" class="tab-btn flex-1 md:flex-none px-6 py-3 text-sm font-bold text-slate-500 hover:text-blue-600 active:text-blue-600 transition-all whitespace-nowrap"><i class="fa-regular fa-lightbulb"></i> Kiến thức</button>
                <div class="w-px bg-slate-200 my-2"></div>
                <button onclick="switchTab('dialogue')" id="btn-tab-dialogue" class="tab-btn flex-1 md:flex-none px-6 py-3 text-sm font-bold text-slate-500 hover:text-blue-600 active:text-blue-600 transition-all whitespace-nowrap"><i class="fa-regular fa-comments"></i> Hội thoại</button>
                <div class="w-px bg-slate-200 my-2"></div>
                <button onclick="switchTab('vocab')" id="btn-tab-vocab" class="tab-btn flex-1 md:flex-none px-6 py-3 text-sm font-bold text-slate-500 hover:text-blue-600 active:text-blue-600 transition-all whitespace-nowrap"><i class="fa-solid fa-bolt"></i> Flashcard</button>
                <div class="w-px bg-slate-200 my-2"></div>
                <button onclick="switchTab('quiz')" id="btn-tab-quiz" class="tab-btn flex-1 md:flex-none px-6 py-3 text-sm font-bold text-slate-500 hover:text-blue-600 active:text-blue-600 transition-all whitespace-nowrap"><i class="fa-solid fa-clipboard-question"></i> Luyện tập</button>
            </div>
            <div class="min-h-[400px]">
                <div id="content-knowledge" class="space-y-4 max-w-4xl mx-auto pb-10 hidden"></div>
                <div id="content-dialogue" class="space-y-6 max-w-3xl mx-auto pb-10 hidden"></div>
                <div id="content-vocab" class="grid grid-cols-1 md:grid-cols-2 gap-6 pb-10 hidden"></div>
                <div id="content-quiz" class="max-w-2xl mx-auto pb-10 hidden">
                     <div id="quiz-stats" class="bg-indigo-50 rounded-2xl p-5 flex justify-between items-center mb-6 border border-indigo-100">
                        <div class="flex items-center gap-4">
                            <div class="w-12 h-12 rounded-full bg-white text-indigo-600 flex items-center justify-center font-bold text-xl shadow-sm"><i class="fa-solid fa-trophy"></i></div>
                            <div><p class="text-xs text-indigo-500 font-bold uppercase">Kết quả</p><p class="text-xl font-black text-slate-800"><span id="quiz-score">0</span>/<span id="quiz-total">0</span></p></div>
                        </div>
                        <button onclick="resetQuiz()" class="text-xs font-bold text-slate-600 bg-white px-4 py-2 rounded-xl border border-slate-200 hover:bg-slate-50 shadow-sm"><i class="fa-solid fa-rotate-right"></i> Làm lại</button>
                    </div>
                    <div id="quiz-list" class="space-y-6"></div>
                </div>
            </div>
            <div id="lesson-navigation" class="mt-8 pt-6 border-t border-slate-200 flex justify-between items-center"></div>
        </div>
    </main>

    <footer class="bg-white/80 backdrop-blur-md border-t border-slate-200 mt-10 py-8 text-center relative z-10">
        <p class="text-slate-500 font-medium text-sm">Learning and Development Department</p>
        <p class="text-slate-400 text-xs mt-2">© 2026 KiotViet. All rights reserved.</p>
    </footer>

    <div class="fixed bottom-6 right-6 z-50 flex flex-col items-center space-y-3">
        <a href="https://notebooklm.google.com/notebook/a4480a38-2d6e-4974-9880-c45e534f5fa5" target="_blank" title="Hỏi Chatbot AI" class="float-btn w-12 h-12 bg-gradient-to-br from-indigo-500 to-purple-600 text-white rounded-full flex items-center justify-center shadow-lg border-2 border-white"><i class="fa-solid fa-robot"></i></a>
        <a href="https://www.kiotviet.vn/huong-dan-su-dung-kiotviet/retail-hang-hoa/hang-hoa-thuong/" target="_blank" title="Xem Tài liệu" class="float-btn w-12 h-12 bg-blue-600 text-white rounded-full flex items-center justify-center shadow-lg border-2 border-white"><i class="fa-solid fa-book-open"></i></a>
        <a href="https://www.youtube.com/playlist?list=PL3x3GXJzpHzSXXO4aVoriCCGga4hTWsMYFNB" target="_blank" title="Xem Video" class="float-btn w-12 h-12 bg-red-600 text-white rounded-full flex items-center justify-center shadow-lg border-2 border-white"><i class="fa-brands fa-youtube"></i></a>
        <button id="scroll-to-top" onclick="window.scrollTo({top: 0, behavior: 'smooth'})" class="hidden w-12 h-12 bg-white text-slate-600 border border-slate-200 rounded-full items-center justify-center shadow-lg float-btn"><i class="fas fa-arrow-up"></i></button>
    </div>

    <div id="certificate-modal" class="modal opacity-0 pointer-events-none fixed inset-0 z-[100] flex items-center justify-center p-4">
        <div class="absolute inset-0 bg-slate-900/90 backdrop-blur-sm" onclick="toggleModal('certificate-modal')"></div>
        <div class="bg-white w-full max-w-3xl rounded-xl shadow-2xl relative z-10 transform scale-95 transition-all duration-300" id="cert-content">
            <div class="p-2">
                <div class="border-8 border-double border-blue-800 p-8 text-center bg-white relative overflow-hidden">
                    <div class="absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 w-96 h-96 bg-[url('https://cdn-icons-png.flaticon.com/512/2912/2912761.png')] bg-contain bg-no-repeat opacity-5 pointer-events-none"></div>
                    <img src="https://logo.kiotviet.vn/KiotViet-Logo-Horizontal.svg" alt="Logo" class="h-10 mx-auto mb-6">
                    <h2 class="text-4xl font-black font-sans text-blue-900 mb-2 uppercase tracking-widest">Giấy Chứng Nhận</h2>
                    <div class="w-24 h-1 bg-gradient-to-r from-blue-600 to-indigo-600 mx-auto mb-8"></div>
                    <p class="text-slate-500 italic mb-2 font-medium">Chứng nhận nhân viên:</p>
                    <div class="text-3xl font-black text-blue-600 mb-6 uppercase tracking-wider font-sans">Học Viên KiotViet</div>
                    <p class="text-slate-600 mb-2 font-medium">Đã hoàn thành xuất sắc khóa đào tạo:</p>
                    <h3 class="text-2xl font-bold text-slate-800 mb-10 uppercase border-2 border-slate-800 inline-block px-6 py-2">Hàng hóa thường</h3>
                    <div class="flex justify-between items-end mt-12 px-10">
                        <div class="text-center"><p class="text-xs text-slate-400 font-bold uppercase mb-1">Ngày cấp</p><p class="text-lg font-bold text-slate-700" id="cert-date">--/--/----</p></div>
                        <div class="text-center relative"><div class="w-24 h-24 absolute -top-12 -left-6 bg-[url('https://cdn-icons-png.flaticon.com/512/1041/1041166.png')] bg-contain bg-no-repeat opacity-80 rotate-12"></div><p class="text-sm font-bold text-blue-900 mt-10 relative z-10">KiotViet Training Dept.</p></div>
                    </div>
                </div>
            </div>
            <div class="bg-slate-50 p-4 flex justify-end gap-3 rounded-b-xl border-t border-slate-100 no-print">
                <button onclick="toggleModal('certificate-modal')" class="px-5 py-2.5 text-slate-600 font-bold rounded-lg hover:bg-slate-200">Đóng</button>
                <button onclick="window.print()" class="px-5 py-2.5 bg-blue-600 text-white font-bold rounded-lg hover:bg-blue-700 flex items-center gap-2"><i class="fa-solid fa-print"></i> In chứng chỉ</button>
            </div>
        </div>
    </div>

    <script>
        const courseData = [
  {
    "title": "Giới thiệu chung",
    "icon": "fa-solid fa-info-circle",
    "desc": "Hiểu rõ lợi ích cốt lõi của việc quản lý hàng hóa trên KiotViet.",
    "knowledge": [
      {
        "header": "Lợi ích quản lý",
        "content": [
          "Quản lý tập trung: Kiểm soát tên, mã, giá vốn, giá bán, thuộc tính tại một nơi duy nhất.",
          "Tối ưu vận hành: Tìm kiếm nhanh, lên đơn tốc độ, kiểm soát tồn kho chính xác để tránh thất thoát.",
          "Hỗ trợ ra quyết định: Báo cáo chi tiết giúp xác định hàng bán chạy, hàng tồn kho lâu để điều chỉnh chiến lược."
        ]
      }
    ],
    "dialogue": [
      {
        "speaker": "Lan (Chủ shop)",
        "target": "Chào Minh, chị thấy việc quản lý hàng bằng sổ sách hay bị nhầm lẫn giá và tồn kho quá. KiotViet giúp gì được không?"
      },
      {
        "speaker": "Minh (Chuyên viên KiotViet)",
        "target": "Chào chị Lan. KiotViet giúp chị quản lý **tập trung** toàn bộ thông tin sản phẩm. Chị có thể tra cứu giá và tồn kho ngay lập tức, không lo thất thoát đâu ạ."
      },
      {
        "speaker": "Lan (Chủ shop)",
        "target": "Thế còn việc nhập hàng thì sao? Chị sợ nhập sai số lượng lắm."
      },
      {
        "speaker": "Minh (Chuyên viên KiotViet)",
        "target": "Hệ thống có báo cáo và cảnh báo tồn kho, giúp chị ra quyết định nhập hàng chính xác, tối ưu hóa dòng tiền chị nhé."
      }
    ],
    "vocab": [
      {
        "q": "Quản lý danh mục hàng hóa khoa học là nền tảng cho sự __________ của cửa hàng.",
        "full": "Quản lý danh mục hàng hóa khoa học là nền tảng cho sự **thành công** của cửa hàng."
      },
      {
        "q": "Hệ thống giúp theo dõi __________ chính xác để chủ động nhập hàng.",
        "full": "Hệ thống giúp theo dõi **tồn kho** chính xác để chủ động nhập hàng."
      },
      {
        "q": "Báo cáo phân tích giúp nắm bắt sản phẩm nào __________ nhất.",
        "full": "Báo cáo phân tích giúp nắm bắt sản phẩm nào **bán chạy** nhất."
      }
    ],
    "quiz": [
      {
        "q": "Lợi ích lớn nhất của việc quản lý hàng hóa trên KiotViet là gì?",
        "opts": [
          "Chỉ để lưu tên sản phẩm cho vui.",
          "Quản lý tập trung, tối ưu tồn kho và hỗ trợ ra quyết định kinh doanh.",
          "Tăng giá bán sản phẩm tự động."
        ],
        "a": 1
      }
    ]
  },
  {
    "title": "Các thao tác cơ bản",
    "icon": "fa-solid fa-mouse-pointer",
    "desc": "Thành thạo Thêm mới, Sửa, Xóa và Tìm kiếm hàng hóa trên Website.",
    "knowledge": [
      {
        "header": "Thêm mới hàng hóa",
        "content": [
          "Vào menu Hàng hóa -> Danh sách hàng hóa.",
          "Nhấn + Tạo mới -> Chọn Hàng hóa.",
          "Điền: Tên, Mã hàng, Giá vốn, Giá bán, Tồn kho -> Nhấn Lưu."
        ]
      },
      {
        "header": "Cập nhật & Xóa",
        "content": [
          "Sửa: Chọn sản phẩm -> Nhấn Chỉnh sửa (hoặc Sửa nhanh nhóm hàng/điểm tích lũy).",
          "Xóa: Chọn sản phẩm -> Nhấn Xóa. (Lưu ý: Hàng đã xóa sẽ có hậu tố {DEL} trong lịch sử giao dịch).",
          "Ngừng kinh doanh: Dùng khi đã phát sinh giao dịch để giữ lại lịch sử tồn kho."
        ]
      },
      {
        "header": "Tìm kiếm & Lọc",
        "content": [
          "Tìm theo: Mã, tên, ghi chú.",
          "Bộ lọc chi tiết: Nhóm hàng, tồn kho, nhà cung cấp, vị trí..."
        ]
      }
    ],
    "dialogue": [
      {
        "speaker": "Hùng (Quản lý kho)",
        "target": "Anh ơi, em lỡ tạo sai giá vốn cho lô hàng mới nhập, giờ xóa đi tạo lại à?"
      },
      {
        "speaker": "Tú (Cửa hàng trưởng)",
        "target": "Không cần xóa đâu Hùng. Em vào danh sách, tìm sản phẩm đó rồi nhấn **Chỉnh sửa** để cập nhật lại giá là được."
      },
      {
        "speaker": "Hùng (Quản lý kho)",
        "target": "Thế còn mã hàng cũ mình không bán nữa thì sao ạ?"
      },
      {
        "speaker": "Tú (Cửa hàng trưởng)",
        "target": "Nếu mã đó đã từng bán hàng rồi, em hãy chọn **Ngừng kinh doanh** thay vì Xóa, để sau này còn tra cứu lại lịch sử nhé."
      }
    ],
    "vocab": [
      {
        "q": "Để thêm sản phẩm mới, vào menu Hàng hóa và chọn nút __________.",
        "full": "Để thêm sản phẩm mới, vào menu Hàng hóa và chọn nút **+ Tạo mới**."
      },
      {
        "q": "Khi xóa hàng hóa, các giao dịch lịch sử sẽ hiển thị tên hàng kèm hậu tố __________.",
        "full": "Khi xóa hàng hóa, các giao dịch lịch sử sẽ hiển thị tên hàng kèm hậu tố **{DEL}**."
      },
      {
        "q": "Nếu hàng hóa đã phát sinh giao dịch, nên sử dụng tính năng __________ thay vì xóa.",
        "full": "Nếu hàng hóa đã phát sinh giao dịch, nên sử dụng tính năng **Ngừng kinh doanh** thay vì xóa."
      }
    ],
    "quiz": [
      {
        "q": "Khi nào nên sử dụng tính năng \"Ngừng kinh doanh\" thay vì \"Xóa\"?",
        "opts": [
          "Khi hàng hóa vừa được tạo nhầm, chưa bán lần nào.",
          "Khi hàng hóa đã phát sinh giao dịch và muốn giữ lại lịch sử tra cứu.",
          "Khi muốn xóa vĩnh viễn mọi dấu vết của sản phẩm."
        ],
        "a": 1
      },
      {
        "q": "Thao tác nào cho phép thay đổi Nhóm hàng cho nhiều sản phẩm cùng lúc?",
        "opts": [
          "Phải sửa từng sản phẩm một.",
          "Tích chọn các sản phẩm -> Nhấn thao tác (3 chấm) -> Đổi nhóm hàng.",
          "Xóa đi tạo lại tất cả."
        ],
        "a": 1
      }
    ]
  },
  {
    "title": "Các tính năng nâng cao",
    "icon": "fa-solid fa-rocket",
    "desc": "Quản lý Đơn vị tính, Thuộc tính, In tem và Phân tích hiệu quả.",
    "knowledge": [
      {
        "header": "Thuộc tính & Đơn vị tính",
        "content": [
          "Kích hoạt: Thiết lập -> Hàng hóa -> Bật Đơn vị tính / Thuộc tính.",
          "Đơn vị tính: Quy đổi (Ví dụ: 1 Thùng = 24 Lon).",
          "Thuộc tính: Màu sắc, Size, Chất liệu..."
        ]
      },
      {
        "header": "In tem mã vạch",
        "content": [
          "Vào Danh sách hàng hóa -> Tích chọn sản phẩm.",
          "Nhấn In tem mã -> Chọn số lượng và mẫu giấy -> In."
        ]
      },
      {
        "header": "Phân tích hàng hóa",
        "content": [
          "Vào chi tiết sản phẩm -> Chọn Xem phân tích.",
          "Xem: Doanh thu, Lợi nhuận, Xu hướng bán, Khách hàng thường xuyên."
        ]
      }
    ],
    "dialogue": [
      {
        "speaker": "Mai (Thu ngân)",
        "target": "Chị Lan ơi, khách mua cả thùng nước ngọt nhưng máy chỉ quét được mã lon lẻ thôi."
      },
      {
        "speaker": "Lan (Chủ shop)",
        "target": "Để chị cài đặt **Đơn vị tính** quy đổi. Chị sẽ đặt 1 thùng bằng 24 lon. Lần sau em chỉ cần chọn đơn vị Thùng là hệ thống tự trừ 24 lon trong kho."
      },
      {
        "speaker": "Mai (Thu ngân)",
        "target": "Hay quá! Thế em có xem được loại nước nào bán chạy nhất không?"
      },
      {
        "speaker": "Lan (Chủ shop)",
        "target": "Được chứ, em vào chi tiết hàng hóa, chọn **Xem phân tích** là thấy hết doanh thu và lợi nhuận của nó."
      }
    ],
    "vocab": [
      {
        "q": "Để bán sản phẩm theo Lốc hoặc Thùng, cần thiết lập __________ quy đổi.",
        "full": "Để bán sản phẩm theo Lốc hoặc Thùng, cần thiết lập **Đơn vị tính** quy đổi."
      },
      {
        "q": "Tính năng __________ giúp dán mã vạch lên sản phẩm để bán hàng nhanh hơn.",
        "full": "Tính năng **In tem mã** giúp dán mã vạch lên sản phẩm để bán hàng nhanh hơn."
      },
      {
        "q": "Để xem hiệu quả kinh doanh của một sản phẩm, chọn tính năng __________.",
        "full": "Để xem hiệu quả kinh doanh của một sản phẩm, chọn tính năng **Xem phân tích**."
      }
    ],
    "quiz": [
      {
        "q": "Tính năng \"Đơn vị tính\" dùng để làm gì?",
        "opts": [
          "Chỉ để thay đổi tên gọi sản phẩm.",
          "Để quy đổi giá và tồn kho giữa các đơn vị (Ví dụ: Cái -> Hộp -> Thùng).",
          "Để in tem mã vạch."
        ],
        "a": 1
      },
      {
        "q": "Trong màn hình \"Xem phân tích\" của hàng hóa, bạn KHÔNG thể xem chỉ số nào?",
        "opts": [
          "Tổng doanh thu và lợi nhuận gộp.",
          "Thông tin cá nhân chi tiết của người sản xuất.",
          "Danh sách khách hàng thường xuyên mua."
        ],
        "a": 1
      }
    ]
  },
  {
    "title": "Thao tác trên Điện thoại",
    "icon": "fa-solid fa-mobile-screen",
    "desc": "Quản lý hàng hóa linh hoạt mọi lúc mọi nơi trên App KiotViet Quản lý.",
    "knowledge": [
      {
        "header": "Tạo mới & Cập nhật",
        "content": [
          "Thêm mới: Menu Hàng hóa -> Chạm dấu + -> Hàng hóa mới.",
          "Sửa: Chạm vào sản phẩm -> Chọn vùng thông tin cần sửa -> Lưu."
        ]
      },
      {
        "header": "Tiện ích khác",
        "content": [
          "In tem mã: Chạm dấu 3 chấm (...) -> In tem mã (kết nối máy in di động).",
          "Xem báo cáo: Chạm Xem phân tích để kiểm tra hiệu quả kinh doanh tức thì.",
          "Xóa/Ngừng kinh doanh: Chạm dấu 3 chấm (...) trong chi tiết hàng hóa."
        ]
      }
    ],
    "dialogue": [
      {
        "speaker": "Hùng (Quản lý kho)",
        "target": "Chị Lan ơi, em đang ở kho, vừa nhập mẫu áo mới về nhưng ngại chạy lên máy tính nhập liệu quá."
      },
      {
        "speaker": "Lan (Chủ shop)",
        "target": "Trời, dùng điện thoại đi Hùng! Em mở app Quản lý, vào mục Hàng hóa rồi bấm dấu **Cộng (+)** là thêm được ngay. Chụp ảnh sản phẩm up lên luôn cho tiện."
      },
      {
        "speaker": "Hùng (Quản lý kho)",
        "target": "Thế em in tem dán luôn ở đây được không?"
      },
      {
        "speaker": "Lan (Chủ shop)",
        "target": "Được, em bấm vào dấu **3 chấm** chọn In tem mã, kết nối với máy in cầm tay là xong."
      }
    ],
    "vocab": [
      {
        "q": "Trên ứng dụng điện thoại, chạm vào biểu tượng __________ để thêm hàng hóa mới.",
        "full": "Trên ứng dụng điện thoại, chạm vào biểu tượng **dấu +** để thêm hàng hóa mới."
      },
      {
        "q": "Để truy cập menu Xóa hoặc Ngừng kinh doanh trên app, chạm vào biểu tượng __________.",
        "full": "Để truy cập menu Xóa hoặc Ngừng kinh doanh trên app, chạm vào biểu tượng **ba chấm**."
      },
      {
        "q": "Bạn có thể xem nhanh __________ và Lợi nhuận của sản phẩm ngay trên điện thoại.",
        "full": "Bạn có thể xem nhanh **Doanh thu** và Lợi nhuận của sản phẩm ngay trên điện thoại."
      }
    ],
    "quiz": [
      {
        "q": "Thao tác nào sau đây có thể thực hiện trên ứng dụng KiotViet điện thoại?",
        "opts": [
          "Chỉ xem được danh sách, không sửa được.",
          "Thêm mới, Sửa, Xóa, In tem và Xem phân tích hàng hóa.",
          "Chỉ xóa được hàng hóa, không thêm mới được."
        ],
        "a": 1
      }
    ]
  },
  {
    "title": "Thao tác trên Máy POS",
    "icon": "fa-solid fa-cash-register",
    "desc": "Xử lý tình huống phát sinh nhanh ngay tại quầy thu ngân.",
    "knowledge": [
      {
        "header": "Thêm hàng hóa mới tại quầy",
        "content": [
          "Tình huống: Đang bán hàng nhưng sản phẩm chưa có trên hệ thống.",
          "Thao tác: Tại ô tìm kiếm -> Nhập tên/mã -> Chọn Thêm hàng hóa -> Điền thông tin -> Lưu."
        ]
      },
      {
        "header": "Tra cứu nhanh tồn kho",
        "content": [
          "Tình huống: Khách hỏi còn hàng trong kho không.",
          "Thao tác: Nhấn vào sản phẩm trên hóa đơn -> Chọn biểu tượng (...) -> Xem chi tiết."
        ]
      }
    ],
    "dialogue": [
      {
        "speaker": "Khách hàng",
        "target": "Em ơi, tính tiền cho chị cái kẹp tóc này nữa."
      },
      {
        "speaker": "Mai (Thu ngân)",
        "target": "(Quét mã) Dạ mẫu này mới về em chưa thấy trên máy. Chị đợi em 10 giây nhé."
      },
      {
        "speaker": "Khách hàng",
        "target": "Nhanh không em, chị đang vội."
      },
      {
        "speaker": "Mai (Thu ngân)",
        "target": "Dạ xong ngay ạ. Em nhập tên kẹp tóc vào ô tìm kiếm, chọn **Thêm hàng hóa** ngay tại đây luôn. Xong rồi ạ, em in hóa đơn cho chị nhé!"
      }
    ],
    "vocab": [
      {
        "q": "Trên màn hình POS, có thể __________ hàng hóa ngay khi đang tạo hóa đơn.",
        "full": "Trên màn hình POS, có thể **thêm mới** hàng hóa ngay khi đang tạo hóa đơn."
      },
      {
        "q": "Để xem tồn kho của sản phẩm đang chọn, nhấn vào biểu tượng __________.",
        "full": "Để xem tồn kho của sản phẩm đang chọn, nhấn vào biểu tượng **tùy chọn (...)**."
      }
    ],
    "quiz": [
      {
        "q": "Khi đang bán hàng trên POS mà gặp sản phẩm chưa có trong hệ thống, thu ngân nên làm gì?",
        "opts": [
          "Từ chối bán sản phẩm đó.",
          "Nhập tên sản phẩm vào ô tìm kiếm và chọn \"Thêm hàng hóa\" để tạo nhanh.",
          "Gọi điện cho chủ cửa hàng và bắt khách đợi 30 phút."
        ],
        "a": 1
      }
    ]
  }
];

        let currentLessonId = 0;
        let completedLessons = new Set();
        let quizState = { correct: 0, total: 0 };
        let currentActiveTab = 'knowledge'; // Default tab

        function init() {
            renderMenu();
            updateProgress();
            const today = new Date();
            document.getElementById('cert-date').innerText = `${today.getDate()}/${today.getMonth() + 1}/${today.getFullYear()}`;
            
            const scrollTopBtn = document.getElementById('scroll-to-top');
            window.onscroll = function() {
                if (document.body.scrollTop > 300 || document.documentElement.scrollTop > 300) { scrollTopBtn.classList.remove('hidden'); scrollTopBtn.classList.add('flex'); }
                else { scrollTopBtn.classList.add('hidden'); scrollTopBtn.classList.remove('flex'); }
            };
        }

        function renderMenu() {
            const grid = document.getElementById('lesson-grid');
            grid.innerHTML = courseData.map((lesson, idx) => `
                <div onclick="loadLessonFromMenu(${idx})" class="glass-card bg-white rounded-xl p-5 cursor-pointer group hover:border-blue-400 relative overflow-hidden transition-all duration-300">
                    <div class="flex items-start gap-4 relative z-10">
                        <div class="w-12 h-12 rounded-lg bg-blue-50 text-blue-600 flex items-center justify-center text-xl shadow-sm border border-blue-100 group-hover:bg-blue-600 group-hover:text-white transition-colors duration-300"><i class="${lesson.icon}"></i></div>
                        <div><h3 class="font-bold text-lg text-slate-800 group-hover:text-blue-600 transition-colors">${lesson.title}</h3><p class="text-sm text-slate-500 mt-1 line-clamp-2">${lesson.desc}</p></div>
                    </div>
                    <div class="mt-4 pt-3 border-t border-slate-100 flex items-center justify-between">
                        <span class="text-[10px] font-bold text-slate-400 uppercase tracking-widest group-hover:text-blue-500">Mục ${idx + 1}</span>
                        ${completedLessons.has(idx) ? '<i class="fa-solid fa-circle-check text-green-500 text-xl animate__animated animate__rubberBand"></i>' : '<i class="fa-regular fa-circle-play text-slate-300 text-xl group-hover:text-blue-500 transition-colors"></i>'}
                    </div>
                </div>
            `).join('');
        }

        function loadLessonFromMenu(id) {
            currentActiveTab = 'knowledge';
            if(id === -1) loadComprehensiveLesson(); else loadLesson(id);
        }

        function loadLesson(id) {
            currentLessonId = id;
            const lesson = courseData[id];
            const mainTopic = '<span class="block text-sm text-blue-500 font-bold uppercase tracking-wider mb-1">Hàng hóa thường</span>';
            document.getElementById('lesson-title-container').innerHTML = `${mainTopic}<h2 id="lesson-title" class="text-2xl md:text-3xl font-black text-slate-800">${lesson.title}</h2>`;
            document.getElementById('lesson-desc').innerText = lesson.desc;
            document.getElementById('lesson-icon').className = `${lesson.icon} text-2xl`;
            
            renderKnowledge(lesson.knowledge);
            renderDialogue(lesson.dialogue);
            renderVocab(lesson.vocab);
            renderQuiz(lesson.quiz);
            
            updateDropdown();
            renderNavigation();
            document.getElementById('view-menu').classList.add('hidden');
            document.getElementById('view-learning').classList.remove('hidden');
            switchTab(currentActiveTab);
            window.scrollTo(0, 0);
        }

        function renderKnowledge(data) {
            const container = document.getElementById('content-knowledge');
            if(!data || data.length === 0) {
                 container.innerHTML = `<div class="p-6 bg-slate-50 rounded-xl text-center text-slate-500">Chưa có dữ liệu chi tiết.</div>`;
                 return;
            }
            container.innerHTML = data.map((item, idx) => `
                <div class="bg-white rounded-xl p-6 shadow-sm border border-slate-100 animate__animated animate__fadeInUp" style="animation-delay: ${idx * 100}ms">
                    <div class="flex gap-4">
                        <div class="shrink-0 w-10 h-10 rounded-full bg-blue-50 text-blue-600 flex items-center justify-center font-bold shadow-sm border border-blue-100">${idx + 1}</div>
                        <div class="flex-1">
                            <h3 class="font-bold text-slate-800 text-lg mb-3 pb-2 border-b border-slate-100">${item.header}</h3>
                            <ul class="space-y-3 knowledge-list">
                                ${item.content.map(point => `<li class="flex gap-3 text-sm text-slate-600 leading-relaxed items-start"><i class="fa-solid fa-check text-blue-500 mt-1 shrink-0"></i> <span>${point}</span></li>`).join('')}
                            </ul>
                        </div>
                    </div>
                </div>
            `).join('');
        }

        function renderDialogue(dialogue) {
            const container = document.getElementById('content-dialogue');
            container.innerHTML = dialogue.map((line, idx) => {
                const isKiot = line.speaker.includes('KiotViet');
                const formattedText = line.target.replace(/\*\*(.*?)\*\*/g, '<b class="text-blue-700 font-bold">$1</b>');
                return `
                <div class="flex ${isKiot ? 'flex-row' : 'flex-row-reverse'} gap-4 items-end animate__animated animate__fadeInUp" style="animation-delay: ${idx * 50}ms">
                    <div class="w-10 h-10 rounded-full flex items-center justify-center shrink-0 shadow-md ${isKiot ? 'bg-blue-600 text-white' : 'bg-white border border-slate-200 text-slate-600'}"><i class="fa-solid ${isKiot ? 'fa-user-tie' : 'fa-store'}"></i></div>
                    <div class="flex flex-col ${isKiot ? 'items-start' : 'items-end'} max-w-[80%]">
                        <span class="text-[10px] font-bold text-slate-400 mb-1 uppercase tracking-wide">${line.speaker}</span>
                        <div class="p-4 rounded-2xl shadow-sm text-sm font-medium leading-relaxed border ${isKiot ? 'bg-blue-50 border-blue-100 rounded-bl-none text-slate-700' : 'bg-white border-slate-200 rounded-br-none text-slate-600'}">${formattedText}</div>
                    </div>
                </div>`;
            }).join('');
        }

        function renderVocab(vocab) {
            const container = document.getElementById('content-vocab');
            container.innerHTML = vocab.map((v, i) => {
                // FIXED: Parse markdown bold syntax to HTML span
                const formattedFull = v.full.replace(/\*\*(.*?)\*\*/g, '<span class="text-yellow-300 font-black border-b border-yellow-300">$1</span>');
                return `
                <div class="flip-card h-56 perspective-1000 group animate__animated animate__fadeIn" style="animation-delay: ${i * 50}ms" onclick="this.classList.toggle('flipped')">
                    <div class="flip-card-inner shadow-sm rounded-xl">
                        <div class="flip-card-front bg-white border border-slate-200 hover:border-blue-300 transition-colors">
                            <div class="w-12 h-12 bg-blue-50 rounded-full flex items-center justify-center mb-4 text-blue-500"><i class="fa-solid fa-question text-xl"></i></div>
                            <h3 class="text-base font-bold text-slate-800 px-4 leading-snug">${v.q}</h3>
                            <p class="text-[10px] text-slate-400 mt-6 uppercase tracking-widest font-bold flex items-center gap-1"><i class="fa-solid fa-hand-pointer animate-pulse"></i> Chạm để lật</p>
                        </div>
                        <div class="flip-card-back bg-gradient-to-br from-blue-600 to-indigo-700 text-white">
                            <i class="fa-solid fa-lightbulb text-yellow-300 text-3xl mb-3"></i>
                            <span class="text-[10px] font-bold uppercase tracking-widest text-blue-200 mb-1">Ghi nhớ</span>
                            <p class="font-medium text-sm px-4 leading-relaxed">${formattedFull}</p>
                        </div>
                    </div>
                </div>
            `}).join('');
        }

        function renderQuiz(quiz) {
            const list = document.getElementById('quiz-list');
            quizState = { correct: 0, total: quiz.length };
            updateQuizStats();
            list.innerHTML = quiz.map((q, idx) => `
                <div class="bg-white rounded-xl p-6 shadow-sm border border-slate-100 quiz-card transition-all" id="quiz-${idx}">
                    <div class="flex gap-4 mb-4"><span class="shrink-0 w-8 h-8 bg-blue-100 text-blue-700 rounded-lg flex items-center justify-center text-xs font-bold">Q${idx + 1}</span><h3 class="font-bold text-slate-800 text-base leading-snug">${q.q}</h3></div>
                    <div class="space-y-3 pl-12">
                        ${q.opts.map((opt, oid) => `
                            <button onclick="checkAnswer(${idx}, ${oid}, ${q.a})" class="w-full text-left p-3 rounded-lg border border-slate-200 hover:bg-blue-50 hover:border-blue-300 transition-all text-sm font-medium text-slate-600 quiz-opt flex items-center group">
                                <span class="w-6 h-6 rounded-md border border-slate-300 flex items-center justify-center text-[10px] text-slate-500 font-bold mr-3 group-hover:border-blue-400 group-hover:text-blue-500 opt-idx transition-colors">${String.fromCharCode(65+oid)}</span><span class="flex-1">${opt}</span>
                            </button>
                        `).join('')}
                    </div>
                </div>
            `).join('');
        }

        function checkAnswer(qIdx, selected, correct) {
            const card = document.getElementById(`quiz-${qIdx}`);
            if(card.hasAttribute('data-answered')) return;
            card.setAttribute('data-answered', 'true');
            const opts = card.querySelectorAll('.quiz-opt');
            opts.forEach((btn, idx) => {
                btn.disabled = true;
                btn.classList.remove('hover:bg-blue-50', 'hover:border-blue-300');
                const idxSpan = btn.querySelector('.opt-idx');
                if (idx === correct) {
                    btn.classList.add('bg-green-50', 'border-green-500', 'text-green-800');
                    idxSpan.classList.add('bg-green-500', 'border-green-500', 'text-white');
                    idxSpan.innerHTML = '<i class="fa-solid fa-check"></i>';
                } else if (idx === selected) {
                    btn.classList.add('bg-red-50', 'border-red-500', 'text-red-800');
                    idxSpan.classList.add('bg-red-500', 'border-red-500', 'text-white');
                    idxSpan.innerHTML = '<i class="fa-solid fa-xmark"></i>';
                }
            });
            if (selected === correct) { quizState.correct++; confetti({ particleCount: 40, spread: 60, origin: { y: 0.7 } }); } 
            else { card.classList.add('animate__animated', 'animate__shakeX'); }
            updateQuizStats();
            if(document.querySelectorAll('.quiz-card[data-answered]').length === quizState.total) {
                if(quizState.correct === quizState.total && currentLessonId !== -1) { completedLessons.add(currentLessonId); updateProgress(); }
                if(currentLessonId === -1 && quizState.correct === quizState.total) { triggerMegaConfetti(); setTimeout(() => toggleModal('certificate-modal'), 1200); }
            }
        }

        function updateQuizStats() { document.getElementById('quiz-score').innerText = quizState.correct; document.getElementById('quiz-total').innerText = quizState.total; }
        function resetQuiz() { if(currentLessonId === -1) loadComprehensiveLesson(); else renderQuiz(courseData[currentLessonId].quiz); }

        function loadComprehensiveLesson() {
            currentLessonId = -1;
            const allQuizzes = courseData.flatMap(c => c.quiz);
            const allDialogues = courseData.flatMap(c => c.dialogue);
            const allVocabs = courseData.flatMap(c => c.vocab);
            const allKnowledge = courseData.flatMap(c => c.knowledge);
            
            const mainTopic = '<span class="block text-sm text-indigo-500 font-bold uppercase tracking-wider mb-1">Hàng hóa thường</span>';
            document.getElementById('lesson-title-container').innerHTML = `${mainTopic}<h2 id="lesson-title" class="text-2xl md:text-3xl font-black text-slate-800">Bài kiểm tra Tổng hợp</h2>`;
            document.getElementById('lesson-desc').innerText = "Ôn tập toàn diện và trả lời đúng 100% câu hỏi để nhận Chứng chỉ.";
            document.getElementById('lesson-icon').className = "fa-solid fa-graduation-cap text-2xl";
            
            // Render content
            renderKnowledge(allKnowledge); renderDialogue(allDialogues); renderVocab(allVocabs); renderQuiz(allQuizzes);
            
            // View transition
            document.getElementById('view-menu').classList.add('hidden');
            document.getElementById('view-learning').classList.remove('hidden');
            document.getElementById('lesson-navigation').innerHTML = `<div class="w-full flex justify-center"><button onclick="goBack()" class="text-slate-400 font-bold text-sm hover:text-slate-600 flex items-center gap-2"><i class="fa-solid fa-arrow-up"></i> Quay về trang chủ</button></div>`;
            
            // Show all tabs
            document.getElementById('btn-tab-knowledge').classList.remove('hidden');
            document.getElementById('btn-tab-dialogue').nextElementSibling.classList.remove('hidden'); 
            
            updateDropdown(); // Update dropdown to show "Test" selected

            switchTab('quiz'); 
            window.scrollTo(0, 0);
        }

        function switchTab(tab) {
            currentActiveTab = tab;
            ['knowledge', 'dialogue', 'vocab', 'quiz'].forEach(t => { 
                const contentEl = document.getElementById(`content-${t}`);
                const btnEl = document.getElementById(`btn-tab-${t}`);
                if(contentEl) contentEl.classList.add('hidden'); 
                if(btnEl) btnEl.classList.remove('active', 'text-blue-600'); 
            });
            const targetContent = document.getElementById(`content-${tab}`);
            const targetBtn = document.getElementById(`btn-tab-${tab}`);
            if(targetContent) targetContent.classList.remove('hidden');
            if(targetBtn) targetBtn.classList.add('active', 'text-blue-600');
        }

        function goBack() { 
            document.getElementById('btn-tab-knowledge').classList.remove('hidden');
            document.getElementById('btn-tab-dialogue').nextElementSibling.classList.remove('hidden');
            document.getElementById('view-learning').classList.add('hidden'); 
            document.getElementById('view-menu').classList.remove('hidden'); 
            updateProgress(); 
            renderMenu(); 
            window.scrollTo(0, 0); 
        }
        function updateProgress() { const pct = Math.round((completedLessons.size / courseData.length) * 100); document.getElementById('course-progress').style.width = `${pct}%`; document.getElementById('progress-text').innerText = `${pct}%`; }
        function updateDropdown() { 
            const select = document.getElementById('lesson-selector'); 
            let html = courseData.map((l, i) => `<option value="${i}" ${i === currentLessonId ? 'selected' : ''}>${i+1}. ${l.title}</option>`).join(''); 
            html += `<option value="-1" ${currentLessonId === -1 ? 'selected' : ''}>Bài kiểm tra Tổng hợp</option>`;
            select.innerHTML = html;
        }
        function switchLessonFromDropdown(val) { 
            const id = parseInt(val);
            if(id === -1) loadComprehensiveLesson();
            else loadLesson(id); 
        }

        function renderNavigation() {
            const container = document.getElementById('lesson-navigation');
            const prev = currentLessonId > 0 ? currentLessonId - 1 : null;
            const next = currentLessonId < courseData.length - 1 ? currentLessonId + 1 : null;
            let html = '<div class="flex-1">';
            if (prev !== null) html += `<button onclick="loadLesson(${prev})" class="flex items-center gap-2 text-slate-500 hover:text-blue-600 font-bold text-sm transition-colors"><i class="fa-solid fa-arrow-left"></i> Mục trước</button>`;
            html += '</div><div class="flex-1 text-right">';
            if (next !== null) html += `<button onclick="loadLesson(${next})" class="flex items-center gap-2 text-blue-600 hover:text-blue-800 font-bold text-sm transition-colors ml-auto">Mục tiếp theo <i class="fa-solid fa-arrow-right"></i></button>`;
            else html += `<button onclick="loadComprehensiveLesson()" class="flex items-center gap-2 text-white bg-indigo-600 hover:bg-indigo-700 px-4 py-2 rounded-lg shadow-md font-bold text-sm transition-all ml-auto animate-pulse">Thi chứng chỉ <i class="fa-solid fa-graduation-cap"></i></button>`;
            html += '</div>';
            container.innerHTML = html;
        }

        function toggleModal(id) {
            const m = document.getElementById(id);
            const content = document.getElementById('cert-content');
            if (m.classList.contains('opacity-0')) { m.classList.remove('opacity-0', 'pointer-events-none'); content.classList.remove('scale-95'); content.classList.add('scale-100'); }
            else { m.classList.add('opacity-0', 'pointer-events-none'); content.classList.remove('scale-100'); content.classList.add('scale-95'); }
            document.body.classList.toggle('modal-active');
        }

        function triggerMegaConfetti() {
            var duration = 3000; var animationEnd = Date.now() + duration; var defaults = { startVelocity: 30, spread: 360, ticks: 60, zIndex: 0 };
            var interval = setInterval(function() {
                var timeLeft = animationEnd - Date.now();
                if (timeLeft <= 0) return clearInterval(interval);
                var particleCount = 50 * (timeLeft / duration);
                confetti(Object.assign({}, defaults, { particleCount, origin: { x: Math.random() * 0.2 + 0.1, y: Math.random() - 0.2 } }));
                confetti(Object.assign({}, defaults, { particleCount, origin: { x: Math.random() * 0.2 + 0.7, y: Math.random() - 0.2 } }));
            }, 250);
        }

        window.onload = init;
    </script>
</body>
</html>
