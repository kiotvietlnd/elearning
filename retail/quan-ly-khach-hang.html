<!DOCTYPE html><html lang="vi" class="scroll-smooth"><head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Khóa học: Quản lý Khách hàng | KiotViet Retail</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800;900&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css"/>
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>
    <style>
        :root { --theme-color: #2563eb; }
        body { font-family: 'Inter', sans-serif; background-color: #f8fafc; color: #334155; }
        ::-webkit-scrollbar { width: 6px; }
        ::-webkit-scrollbar-track { background: #f1f1f1; }
        ::-webkit-scrollbar-thumb { background: #cbd5e1; border-radius: 3px; }
        .soft-glow-background { position: fixed; top: 0; left: 0; width: 100%; height: 100%; z-index: -10; background: linear-gradient(to bottom right, #f8fafc, #eff6ff); }
        .nav-link { position: relative; transition: color 0.3s; }
        .nav-link.active { color: var(--theme-color); }
        .glass-card { background: rgba(255, 255, 255, 0.9); backdrop-filter: blur(10px); border: 1px solid rgba(255, 255, 255, 0.8); box-shadow: 0 4px 6px -1px rgba(0,0,0,0.05); transition: all 0.3s ease; }
        .glass-card:hover { transform: translateY(-4px); box-shadow: 0 15px 30px -5px rgba(0,0,0,0.1); }
        .perspective-1000 { perspective: 1000px; }
        .flip-card-inner { position: relative; width: 100%; height: 100%; text-align: center; transition: transform 0.6s; transform-style: preserve-3d; cursor: pointer; }
        .flip-card.flipped .flip-card-inner { transform: rotateY(180deg); }
        .flip-card-front, .flip-card-back { position: absolute; width: 100%; height: 100%; backface-visibility: hidden; display: flex; flex-direction: column; align-items: center; justify-content: center; border-radius: 1rem; }
        .flip-card-back { transform: rotateY(180deg); }
        .float-btn { transition: transform 0.2s; }
        .float-btn:hover { transform: scale(1.1); }
        .tab-btn { position: relative; transition: all 0.3s ease; }
        .tab-btn::after { content: ''; position: absolute; bottom: -2px; left: 0; width: 0; height: 2px; background-color: currentColor; transition: width 0.3s ease; }
        .tab-btn.active::after { width: 100%; }
        .modal { transition: opacity 0.3s ease; }
        body.modal-active { overflow: hidden; }
        .knowledge-list li::marker { color: var(--theme-color); font-weight: bold; }
        @media print { body * { visibility: hidden; } #certificate-modal, #certificate-modal * { visibility: visible; } #certificate-modal { position: absolute; left: 0; top: 0; width: 100%; height: 100%; background: white; } .no-print { display: none; } }
    </style></head><body id="top" class="text-slate-700 antialiased selection:bg-blue-100 selection:text-blue-900">
    <div class="soft-glow-background"></div>

    <header class="sticky top-0 z-50 bg-white/90 backdrop-blur-md border-b border-slate-200 h-20">
        <div class="max-w-6xl mx-auto px-4 sm:px-6 lg:px-8 h-full">
            <div class="flex items-center justify-between h-full gap-8">
                <a href="https://kiotvietlnd.github.io/elearning" class="flex-shrink-0 flex items-center gap-3 hover:opacity-80">
                    <img src="https://logo.kiotviet.vn/KiotViet-Logo-Horizontal.svg" alt="KiotViet Logo" class="h-8">
                    <span class="text-slate-300 font-light text-2xl">|</span>
                    <span class="font-bold text-blue-600 tracking-tight text-lg uppercase">E-Learning</span>
                </a>
                <nav class="hidden lg:flex flex-1 justify-end items-center gap-8">
                    <a href="https://kiotvietlnd.github.io/elearning/retail" class="nav-link text-sm font-bold text-blue-600 uppercase py-1">Retail</a>
                    <a href="https://kiotvietlnd.github.io/elearning/fnb" class="nav-link text-sm font-bold text-slate-600 hover:text-orange-600 uppercase py-1">FNB</a>
                    <a href="https://kiotvietlnd.github.io/elearning/salon" class="nav-link text-sm font-bold text-slate-600 hover:text-pink-600 uppercase py-1">Salon</a>
                    <a href="https://kiotvietlnd.github.io/elearning/hotel" class="nav-link text-sm font-bold text-slate-600 hover:text-green-600 uppercase py-1">Hotel</a>
                    <div class="h-6 w-px bg-slate-300"></div>
                    <a href="https://kiotvietlnd.github.io/elearning/retail" class="flex items-center gap-2 px-4 py-2 bg-slate-100 text-slate-600 rounded-full font-bold text-sm border border-slate-200 hover:bg-slate-200 hover:text-blue-700 transition-all">
                        <i class="fa-solid fa-arrow-left"></i> Quay lại Danh mục
                    </a>
                </nav>
            </div>
        </div>
    </header>

    <main class="max-w-5xl mx-auto px-4 sm:px-6 lg:px-8 py-10 min-h-[80vh]">
        <div id="view-menu" class="animate__animated animate__fadeIn">
            <div class="text-center mb-12">
                <div class="inline-flex items-center gap-2 px-3 py-1 rounded-full bg-blue-50 text-blue-700 border border-blue-100 mb-4">
                    <i class="fa-solid fa-boxes-stacked text-xs"></i><span class="text-xs font-bold uppercase tracking-wider">Khóa học Retail</span>
                </div>
                <h1 class="text-3xl md:text-5xl font-black text-slate-800 tracking-tight mb-4">Quản lý Khách hàng</h1>
                <div class="max-w-md mx-auto bg-white rounded-full h-4 shadow-inner border border-slate-200 overflow-hidden relative">
                    <div id="course-progress" class="bg-gradient-to-r from-blue-500 to-blue-400 h-full w-0 transition-all duration-1000"></div>
                </div>
                <p class="text-xs text-slate-400 mt-2 font-bold uppercase">Tiến độ: <span id="progress-text" class="text-blue-600">0%</span></p>
            </div>
            <div class="grid grid-cols-1 md:grid-cols-2 gap-6" id="lesson-grid"></div>
            <div onclick="loadLessonFromMenu(-1)" class="mt-8 bg-gradient-to-r from-indigo-600 to-purple-600 p-1 rounded-2xl cursor-pointer group hover:scale-[1.01] transition-transform shadow-xl">
                <div class="bg-white/10 backdrop-blur-md p-6 rounded-xl flex items-center justify-between h-full">
                    <div class="flex items-center gap-5 text-white">
                        <div class="w-14 h-14 rounded-2xl bg-white/20 flex items-center justify-center text-3xl"><i class="fa-solid fa-graduation-cap"></i></div>
                        <div><h3 class="font-bold text-xl mb-1">Bài kiểm tra Tổng hợp</h3><p class="text-indigo-100 text-sm opacity-90">Hoàn thành để nhận chứng chỉ.</p></div>
                    </div>
                    <div class="w-10 h-10 rounded-full bg-white text-indigo-600 flex items-center justify-center shadow-lg"><i class="fa-solid fa-arrow-right"></i></div>
                </div>
            </div>
        </div>

        <div id="view-learning" class="hidden animate__animated animate__fadeInRight">
            <div class="flex flex-col md:flex-row justify-between items-start md:items-center gap-4 mb-6">
                <button onclick="goBack()" class="group flex items-center gap-2 text-slate-500 hover:text-blue-600 font-bold text-sm bg-white px-4 py-2 rounded-lg border border-slate-200 shadow-sm hover:shadow transition-all">
                    <i class="fa-solid fa-arrow-left group-hover:-translate-x-1 transition-transform"></i> Danh sách mục
                </button>
                <div class="flex items-center gap-3 bg-white px-4 py-2 rounded-lg border border-slate-200 shadow-sm">
                    <i class="fa-solid fa-list-check text-blue-500"></i>
                    <select id="lesson-selector" onchange="switchLessonFromDropdown(this.value)" class="bg-transparent text-sm font-bold text-slate-700 focus:outline-none cursor-pointer w-56"></select>
                </div>
            </div>
            <div class="bg-white p-8 rounded-2xl shadow-sm border border-slate-200 mb-8 relative overflow-hidden">
                <div class="absolute right-0 top-0 w-64 h-64 bg-gradient-to-br from-blue-50 to-transparent rounded-full -mr-16 -mt-16 opacity-70 pointer-events-none"></div>
                <div class="relative z-10 flex items-center gap-6">
                    <div class="w-16 h-16 rounded-2xl bg-gradient-to-br from-blue-500 to-blue-600 text-white flex items-center justify-center shrink-0 shadow-lg">
                        <i id="lesson-icon" class="fa-solid fa-book-open text-2xl"></i>
                    </div>
                    <div>
                        <div class="flex items-center gap-2 mb-1"><span class="text-[10px] font-bold text-white bg-blue-500 px-2 py-0.5 rounded uppercase tracking-wider">Đang học</span></div>
                        <div id="lesson-title-container"></div>
                        <p id="lesson-desc" class="text-slate-500 mt-2 font-medium"></p>
                    </div>
                </div>
            </div>
            <div class="mb-8 bg-white rounded-xl shadow-sm border border-slate-100 p-1 inline-flex w-full md:w-auto overflow-x-auto">
                <button onclick="switchTab('knowledge')" id="btn-tab-knowledge" class="tab-btn flex-1 md:flex-none px-6 py-3 text-sm font-bold text-slate-500 hover:text-blue-600 transition-all whitespace-nowrap"><i class="fa-regular fa-lightbulb"></i> Kiến thức</button>
                <div class="w-px bg-slate-200 my-2"></div>
                <button onclick="switchTab('dialogue')" id="btn-tab-dialogue" class="tab-btn flex-1 md:flex-none px-6 py-3 text-sm font-bold text-slate-500 hover:text-blue-600 transition-all whitespace-nowrap"><i class="fa-regular fa-comments"></i> Hội thoại</button>
                <div class="w-px bg-slate-200 my-2"></div>
                <button onclick="switchTab('vocab')" id="btn-tab-vocab" class="tab-btn flex-1 md:flex-none px-6 py-3 text-sm font-bold text-slate-500 hover:text-blue-600 transition-all whitespace-nowrap"><i class="fa-solid fa-bolt"></i> Flashcard</button>
                <div class="w-px bg-slate-200 my-2"></div>
                <button onclick="switchTab('quiz')" id="btn-tab-quiz" class="tab-btn flex-1 md:flex-none px-6 py-3 text-sm font-bold text-slate-500 hover:text-blue-600 transition-all whitespace-nowrap"><i class="fa-solid fa-clipboard-question"></i> Luyện tập</button>
            </div>
            <div class="min-h-[400px]">
                <div id="content-knowledge" class="space-y-4 max-w-4xl mx-auto pb-10 hidden"></div>
                <div id="content-dialogue" class="space-y-6 max-w-3xl mx-auto pb-10 hidden"></div>
                <div id="content-vocab" class="grid grid-cols-1 md:grid-cols-2 gap-6 pb-10 hidden"></div>
                <div id="content-quiz" class="max-w-2xl mx-auto pb-10 hidden">
                     <div id="quiz-stats" class="bg-indigo-50 rounded-2xl p-5 flex justify-between items-center mb-6 border border-indigo-100">
                        <div class="flex items-center gap-4">
                            <div class="w-12 h-12 rounded-full bg-white text-indigo-600 flex items-center justify-center font-bold text-xl shadow-sm"><i class="fa-solid fa-trophy"></i></div>
                            <div><p class="text-xs text-indigo-500 font-bold uppercase">Kết quả</p><p class="text-xl font-black text-slate-800"><span id="quiz-score">0</span>/<span id="quiz-total">0</span></p></div>
                        </div>
                        <button onclick="resetQuiz()" class="text-xs font-bold text-slate-600 bg-white px-4 py-2 rounded-xl border border-slate-200 hover:bg-slate-50 shadow-sm"><i class="fa-solid fa-rotate-right"></i> Làm lại</button>
                    </div>
                    <div id="quiz-list" class="space-y-6"></div>
                </div>
            </div>
            <div id="lesson-navigation" class="mt-8 pt-6 border-t border-slate-200 flex justify-between items-center"></div>
        </div>
    </main>

    <footer class="bg-white/80 backdrop-blur-md border-t border-slate-200 mt-10 py-8 text-center relative z-10">
        <p class="text-slate-500 font-medium text-sm">Learning and Development Department</p>
        <p class="text-slate-400 text-xs mt-2">© 2026 KiotViet. All rights reserved.</p>
    </footer>

    <div class="fixed bottom-6 right-6 z-50 flex flex-col items-center space-y-3">
        <a href="https://notebooklm.google.com/notebook/a4480a38-2d6e-4974-9880-c45e534f5fa5" target="_blank" title="Hỏi Chatbot AI" class="float-btn w-12 h-12 bg-gradient-to-br from-indigo-500 to-purple-600 text-white rounded-full flex items-center justify-center shadow-lg border-2 border-white"><i class="fa-solid fa-robot"></i></a>
        <a href="https://www.kiotviet.vn/huong-dan-su-dung-kiotviet/retail-khach-hang/khach-hang/#v-thao-tac-tren-may-pos" target="_blank" title="Xem Tài liệu" class="float-btn w-12 h-12 bg-blue-600 text-white rounded-full flex items-center justify-center shadow-lg border-2 border-white"><i class="fa-solid fa-book-open"></i></a>
        <a href="https://www.youtube.com/playlist?list=PL3x3GXJzpHzSXXO4aVoriCCGga4hTWsMY" target="_blank" title="Xem Video" class="float-btn w-12 h-12 bg-red-600 text-white rounded-full flex items-center justify-center shadow-lg border-2 border-white"><i class="fa-brands fa-youtube"></i></a>
        <button id="scroll-to-top" onclick="window.scrollTo({top: 0, behavior: 'smooth'})" class="hidden w-12 h-12 bg-white text-slate-600 border border-slate-200 rounded-full items-center justify-center shadow-lg float-btn"><i class="fas fa-arrow-up"></i></button>
    </div>

    <div id="certificate-modal" class="modal opacity-0 pointer-events-none fixed inset-0 z-[100] flex items-center justify-center p-4">
        <div class="absolute inset-0 bg-slate-900/90 backdrop-blur-sm" onclick="toggleModal('certificate-modal')"></div>
        <div class="bg-white w-full max-w-3xl rounded-xl shadow-2xl relative z-10 transform scale-95 transition-all duration-300" id="cert-content">
            <div class="p-2">
                <div class="border-8 border-double border-blue-800 p-8 text-center bg-white relative overflow-hidden">
                    <img src="https://logo.kiotviet.vn/KiotViet-Logo-Horizontal.svg" alt="Logo" class="h-10 mx-auto mb-6">
                    <h2 class="text-4xl font-black text-blue-900 mb-2 uppercase tracking-widest">Giấy Chứng Nhận</h2>
                    <div class="w-24 h-1 bg-blue-600 mx-auto mb-8"></div>
                    <p class="text-slate-500 italic mb-2">Chứng nhận nhân viên:</p>
                    <div class="text-3xl font-black text-blue-600 mb-6 uppercase tracking-wider">Học Viên KiotViet</div>
                    <p class="text-slate-600 mb-2">Đã hoàn thành xuất sắc khóa đào tạo:</p>
                    <h3 class="text-2xl font-bold text-slate-800 mb-10 uppercase border-2 border-slate-800 inline-block px-6 py-2">Quản lý Khách hàng</h3>
                    <div class="flex justify-between items-end mt-12 px-10">
                        <div class="text-center"><p class="text-xs text-slate-400 font-bold uppercase mb-1">Ngày cấp</p><p class="text-lg font-bold text-slate-700" id="cert-date">--/--/----</p></div>
                        <div class="text-center relative"><p class="text-sm font-bold text-blue-900 mt-10">KiotViet Training Dept.</p></div>
                    </div>
                </div>
            </div>
            <div class="bg-slate-50 p-4 flex justify-end gap-3 rounded-b-xl border-t border-slate-100 no-print">
                <button onclick="toggleModal('certificate-modal')" class="px-5 py-2.5 text-slate-600 font-bold rounded-lg hover:bg-slate-200">Đóng</button>
                <button onclick="window.print()" class="px-5 py-2.5 bg-blue-600 text-white font-bold rounded-lg hover:bg-blue-700"><i class="fa-solid fa-print"></i> In chứng chỉ</button>
            </div>
        </div>
    </div>

    <script>
        const courseData = [
            {
                title: "Giới thiệu chung",
                desc: "Tìm hiểu tổng quan về tính năng Quản lý Khách hàng và lợi ích mang lại cho từng bộ phận.",
                icon: "fa-solid fa-star",
                knowledge: [
                    {
                        header: "Lợi ích nổi bật",
                        content: [
                            "Dễ dàng ghi nhận thông tin khách hàng mới ngay trên màn hình bán hàng.",
                            "Tìm kiếm khách hàng cũ theo tên/số điện thoại để áp dụng chính sách giá.",
                            "Kiểm soát công nợ chặt chẽ và thiết lập cảnh báo nợ quá hạn mức.",
                            "Phân loại khách hàng theo nhóm (VIP, khách sỉ) để chăm sóc hiệu quả."
                        ]
                    }
                ],
                dialogue: [
                    { speaker: "Lan (Chủ cửa hàng)", target: "Minh ơi, trước giờ chị quản lý khách hàng bằng sổ tay nên hay quên nợ của khách lắm. KiotViet giúp được gì cho chị không?" },
                    { speaker: "Minh (Chuyên viên KiotViet)", target: "Dạ chắc chắn rồi chị! Với KiotViet, thông tin khách hàng và **lịch sử giao dịch** sẽ được lưu trữ tự động. Chị có thể xem ngay ai đang nợ bao nhiêu và hệ thống còn tự động nhắc khi họ nợ quá hạn mức đấy ạ." }
                ],
                vocab: [
                    { q: "Tính năng Quản lý Khách hàng giúp theo dõi __________ và lịch sử giao dịch.", full: "Tính năng Quản lý Khách hàng giúp theo dõi **CÔNG NỢ** và lịch sử giao dịch." },
                    { q: "Nhân viên có thể tìm kiếm khách hàng cũ theo __________ hoặc số điện thoại.", full: "Nhân viên có thể tìm kiếm khách hàng cũ theo **TÊN** hoặc số điện thoại." },
                    { q: "Quản lý khách hàng giúp bộ phận Marketing thực hiện việc gì?", full: "Quản lý khách hàng giúp bộ phận Marketing thực hiện việc **PHÂN LOẠI KHÁCH HÀNG**." }
                ],
                quiz: [
                    { q: "Tính năng Quản lý khách hàng mang lại lợi ích gì cho bộ phận Marketing?", opts: ["Tính toán lương nhân viên.", "Phân loại khách hàng để xây dựng chương trình chăm sóc phù hợp.", "Tự động nhập hàng từ nhà cung cấp."], a: 1 }
                ]
            },
            {
                title: "Các thao tác cơ bản",
                desc: "Hướng dẫn thêm mới, chỉnh sửa và xem lịch sử giao dịch của khách hàng.",
                icon: "fa-solid fa-hand-pointer",
                knowledge: [
                    {
                        header: "Thêm mới và Chỉnh sửa",
                        content: [
                            "Thêm từ mục Khách hàng: Vào menu Khách hàng -> Khách hàng -> + Khách hàng.",
                            "Thêm nhanh khi bán hàng: Nhấn phím F4 hoặc biểu tượng dấu (+) cạnh ô tìm khách hàng.",
                            "Quy tắc: Tên khách hàng là bắt buộc và SĐT không được trùng nhau.",
                            "Xem lịch sử: Tại trang chi tiết, chọn tab Lịch sử bán/trả hàng."
                        ]
                    }
                ],
                dialogue: [
                    { speaker: "Anh Nam (Nhân viên bán hàng)", target: "Minh ơi, lúc đang khách đông mà muốn thêm thông tin khách mới thì làm sao cho nhanh?" },
                    { speaker: "Minh (Chuyên viên KiotViet)", target: "Anh chỉ cần nhấn phím **F4** hoặc click dấu (+) ngay cạnh ô tìm khách trên màn hình bán hàng thôi. Anh nhập Tên và SĐT rồi nhấn **Lưu** là xong!" }
                ],
                vocab: [
                    { q: "Khi thêm khách hàng, __________ là thông tin bắt buộc phải nhập.", full: "Khi thêm khách hàng, **TÊN KHÁCH HÀNG** là thông tin bắt buộc phải nhập." },
                    { q: "Phím tắt để tìm nhanh khách hàng trên màn hình bán hàng là __________.", full: "Phím tắt để tìm nhanh khách hàng trên màn hình bán hàng là **F4**." },
                    { q: "Muốn sửa thông tin khách hàng, ta vào trang __________ của khách đó.", full: "Muốn sửa thông tin khách hàng, ta vào trang **CHI TIẾT** của khách đó." }
                ],
                quiz: [
                    { q: "Để xem lại các hóa đơn cũ của một khách hàng, bạn vào tab nào?", opts: ["Nợ cần thu từ khách.", "Lịch sử bán/trả hàng.", "Thông tin chi tiết."], a: 1 },
                    { q: "Thông tin nào sau đây của mỗi khách hàng là không được trùng nhau?", opts: ["Địa chỉ.", "Tên khách hàng.", "Số điện thoại."], a: 2 }
                ]
            },
            {
                title: "Các tính năng nâng cao",
                desc: "Nắm vững quản lý công nợ, nhóm khách hàng, cảnh báo nợ và gán người phụ trách.",
                icon: "fa-solid fa-rocket",
                knowledge: [
                    {
                        header: "Quản lý nâng cao",
                        content: [
                            "Thanh toán công nợ: Thu nợ trực tiếp hoặc tạo mã QR thanh toán nhanh.",
                            "Cảnh báo công nợ: Thiết lập hạn mức nợ và số ngày nợ tối đa để chặn giao dịch.",
                            "Nhóm khách hàng: Tự động thêm khách vào nhóm khi thỏa mãn điều kiện doanh thu/điểm tích lũy.",
                            "Người phụ trách: Phân công nhân viên chuyên trách chăm sóc từng tệp khách hàng riêng.",
                            "Phân tích khách hàng: Xem biểu đồ khung giờ yêu thích và sản phẩm mua nhiều nhất."
                        ]
                    }
                ],
                dialogue: [
                    { speaker: "Chị Mai (Kế toán)", target: "Bên mình có nhiều khách quen hay mua nợ, làm sao để hệ thống báo khi họ nợ quá 10 triệu để mình không bán nợ tiếp?" },
                    { speaker: "Minh (Chuyên viên KiotViet)", target: "Chị vào Thiết lập -> Khách hàng -> Bật **Cảnh báo công nợ**. Chị cài đặt hạn mức 10 triệu, nếu khách nợ quá số này, hệ thống sẽ bôi đỏ cảnh báo khi thanh toán ạ." }
                ],
                vocab: [
                    { q: "Để hệ thống tự động thêm khách vào nhóm khi đủ doanh số, ta dùng tab __________.", full: "Để hệ thống tự động thêm khách vào nhóm khi đủ doanh số, ta dùng tab **THIẾT LẬP NÂNG CAO**." },
                    { q: "Khi khách vừa mua vừa bán hàng cho shop, hãy bật tính năng Quản lý khách hàng đồng thời là __________.", full: "Khi khách vừa mua vừa bán hàng cho shop, hãy bật tính năng Quản lý khách hàng đồng thời là **NHÀ CUNG CẤP**." },
                    { q: "Thanh toán công nợ có thể thực hiện nhanh qua mã __________.", full: "Thanh toán công nợ có thể thực hiện nhanh qua mã **QR**." }
                ],
                quiz: [
                    { q: "Điều gì xảy ra khi gỡ bỏ Người phụ trách của một Nhóm khách hàng?", opts: ["Xóa người phụ trách của các khách trong nhóm.", "Không ảnh hưởng đến người phụ trách hiện tại của các khách.", "Hệ thống xóa toàn bộ khách hàng trong nhóm."], a: 1 },
                    { q: "Tính năng 'Cảnh báo công nợ' có thể chặn giao dịch nào?", opts: ["Đồng bộ từ sàn TMĐT.", "Hóa đơn có giao hàng COD.", "Tạo hóa đơn bán hàng nợ mới."], a: 2 }
                ]
            },
            {
                title: "Thao tác trên Điện thoại",
                desc: "Quản lý khách hàng và xem phân tích nhanh ngay trên App KiotViet Quản lý.",
                icon: "fa-solid fa-mobile-screen-button",
                knowledge: [
                    {
                        header: "Nghiệp vụ Mobile",
                        content: [
                            "Thêm mới/Cập nhật: Vào menu Nhiều hơn -> Khách hàng -> dấu (+).",
                            "Quản lý nợ: Chạm vào mục Công nợ để thực hiện Thanh toán ngay khi giao hàng.",
                            "Phân tích di động: Xem biểu đồ doanh thu và sản phẩm yêu thích khi đang di chuyển."
                        ]
                    }
                ],
                dialogue: [
                    { speaker: "Anh Hùng (Chủ shop)", target: "Tôi đang đi giao hàng cho khách, muốn kiểm tra xem khách này còn nợ bao nhiêu để thu tiền luôn thì xem ở đâu?" },
                    { speaker: "Minh (Chuyên viên KiotViet)", target: "Anh mở app, vào mục Khách hàng, chọn tên khách đó. Anh sẽ thấy ngay số **Nợ hiện tại**. Anh có thể nhấn 'Thanh toán' để tạo phiếu thu ngay nhé!" }
                ],
                vocab: [
                    { q: "Để thao tác với khách hàng trên App điện thoại, ta vào menu __________.", full: "Để thao tác với khách hàng trên App điện thoại, ta vào menu **NHIỀU HƠN**." },
                    { q: "Trên App, để thu tiền nợ khách hàng, ta chạm vào mục __________.", full: "Trên App, để thu tiền nợ khách hàng, ta chạm vào mục **CÔNG NỢ**." }
                ],
                quiz: [
                    { q: "Trên App di động, biểu đồ nào giúp bạn biết sản phẩm khách mua nhiều nhất?", opts: ["Biểu đồ Kênh bán.", "Sản phẩm yêu thích.", "Chỉ số kinh doanh."], a: 1 }
                ]
            },
            {
                title: "Thao tác trên Máy POS",
                desc: "Thao tác nhanh tại quầy thu ngân để thêm khách và tra cứu tích điểm.",
                icon: "fa-solid fa-cash-register",
                knowledge: [
                    {
                        header: "Nghiệp vụ tại quầy",
                        content: [
                            "Thêm nhanh: Thêm khách ngay tại ô tìm kiếm khách hàng khi đang tính tiền.",
                            "Tra cứu: Nhập tên hoặc SĐT tại ô F4.",
                            "Tư vấn điểm: Chạm vào tên khách để xem Điểm tích lũy và Nợ trước khi thanh toán."
                        ]
                    }
                ],
                dialogue: [
                    { speaker: "Vy (Thu ngân)", target: "Lúc khách đứng đợi thanh toán, em muốn check nhanh xem khách có đủ điểm để đổi quà không thì làm thế nào?" },
                    { speaker: "Minh (Chuyên viên KiotViet)", target: "Sau khi Vy chọn khách vào đơn, chỉ cần chạm vào **Tên khách hàng** trên màn hình POS. Hệ thống sẽ hiện bảng thông tin Điểm và Nợ ngay nhé!" }
                ],
                vocab: [
                    { q: "Ứng dụng trên máy bán hàng tại quầy được gọi là __________.", full: "Ứng dụng trên máy bán hàng tại quầy được gọi là **KIOTVIET MÁY BÁN HÀNG**." },
                    { q: "Tại màn hình POS, chạm vào tên khách để xem __________ và Nợ.", full: "Tại màn hình POS, chạm vào tên khách để xem **ĐIỂM TÍCH LŨY** và Nợ." }
                ],
                quiz: [
                    { q: "Khi không tìm thấy khách hàng cũ tại quầy POS, bạn nên làm gì?", opts: ["Bán hàng cho khách lẻ.", "Sử dụng tùy chọn thêm mới nhanh khách hàng.", "Yêu cầu khách đọc lại SĐT nhiều lần."], a: 1 }
                ]
            }
        ];

        let currentLessonId = 0;
        let completedLessons = new Set();
        let quizState = { correct: 0, total: 0 };
        let currentActiveTab = 'knowledge';

        function init() {
            renderMenu();
            updateProgress();
            const today = new Date();
            document.getElementById('cert-date').innerText = `${today.getDate()}/${today.getMonth() + 1}/${today.getFullYear()}`;
            
            const scrollTopBtn = document.getElementById('scroll-to-top');
            window.onscroll = function() {
                if (document.body.scrollTop > 300 || document.documentElement.scrollTop > 300) { scrollTopBtn.classList.remove('hidden'); scrollTopBtn.classList.add('flex'); }
                else { scrollTopBtn.classList.add('hidden'); scrollTopBtn.classList.remove('flex'); }
            };
        }

        function renderMenu() {
            const grid = document.getElementById('lesson-grid');
            grid.innerHTML = courseData.map((lesson, idx) => `
                <div onclick="loadLessonFromMenu(${idx})" class="glass-card bg-white rounded-xl p-5 cursor-pointer group hover:border-blue-400 relative overflow-hidden transition-all duration-300">
                    <div class="flex items-start gap-4 relative z-10">
                        <div class="w-12 h-12 rounded-lg bg-blue-50 text-blue-600 flex items-center justify-center text-xl shadow-sm border border-blue-100 group-hover:bg-blue-600 group-hover:text-white transition-colors duration-300"><i class="${lesson.icon}"></i></div>
                        <div><h3 class="font-bold text-lg text-slate-800 group-hover:text-blue-600 transition-colors">${lesson.title}</h3><p class="text-sm text-slate-500 mt-1 line-clamp-2">${lesson.desc}</p></div>
                    </div>
                    <div class="mt-4 pt-3 border-t border-slate-100 flex items-center justify-between">
                        <span class="text-[10px] font-bold text-slate-400 uppercase tracking-widest group-hover:text-blue-500">Mục ${idx + 1}</span>
                        ${completedLessons.has(idx) ? '<i class="fa-solid fa-circle-check text-green-500 text-xl animate__animated animate__rubberBand"></i>' : '<i class="fa-regular fa-circle-play text-slate-300 text-xl group-hover:text-blue-500 transition-colors"></i>'}
                    </div>
                </div>
            `).join('');
        }

        function loadLessonFromMenu(id) {
            currentActiveTab = 'knowledge';
            if(id === -1) loadComprehensiveLesson(); else loadLesson(id);
        }

        function loadLesson(id) {
            currentLessonId = id;
            const lesson = courseData[id];
            const mainTopic = '<span class="block text-sm text-blue-500 font-bold uppercase tracking-wider mb-1">Quản lý Khách hàng</span>';
            document.getElementById('lesson-title-container').innerHTML = `${mainTopic}<h2 id="lesson-title" class="text-2xl md:text-3xl font-black text-slate-800">${lesson.title}</h2>`;
            document.getElementById('lesson-desc').innerText = lesson.desc;
            document.getElementById('lesson-icon').className = `${lesson.icon} text-2xl`;
            
            renderKnowledge(lesson.knowledge);
            renderDialogue(lesson.dialogue);
            renderVocab(lesson.vocab);
            renderQuiz(lesson.quiz);
            
            updateDropdown();
            renderNavigation();
            document.getElementById('view-menu').classList.add('hidden');
            document.getElementById('view-learning').classList.remove('hidden');
            switchTab(currentActiveTab);
            window.scrollTo(0, 0);
        }

        function renderKnowledge(data) {
            const container = document.getElementById('content-knowledge');
            container.innerHTML = data.map((item, idx) => `
                <div class="bg-white rounded-xl p-6 shadow-sm border border-slate-100 animate__animated animate__fadeInUp">
                    <h3 class="font-bold text-slate-800 text-lg mb-3 pb-2 border-b border-slate-100">${item.header}</h3>
                    <ul class="space-y-3 knowledge-list">
                        ${item.content.map(point => `<li class="flex gap-3 text-sm text-slate-600 leading-relaxed items-start"><i class="fa-solid fa-check text-blue-500 mt-1 shrink-0"></i> <span>${point}</span></li>`).join('')}
                    </ul>
                </div>
            `).join('');
        }

        function renderDialogue(dialogue) {
            const container = document.getElementById('content-dialogue');
            container.innerHTML = dialogue.map((line, idx) => {
                const isKiot = line.speaker.includes('KiotViet');
                const formattedText = line.target.replace(/\*\*(.*?)\*\*/g, '<b class="text-blue-700 font-bold">$1</b>');
                return `
                <div class="flex ${isKiot ? 'flex-row' : 'flex-row-reverse'} gap-4 items-end animate__animated animate__fadeInUp">
                    <div class="w-10 h-10 rounded-full flex items-center justify-center shrink-0 shadow-md ${isKiot ? 'bg-blue-600 text-white' : 'bg-white border border-slate-200 text-slate-600'}"><i class="fa-solid ${isKiot ? 'fa-user-tie' : 'fa-store'}"></i></div>
                    <div class="flex flex-col ${isKiot ? 'items-start' : 'items-end'} max-w-[80%]">
                        <span class="text-[10px] font-bold text-slate-400 mb-1 uppercase tracking-wide">${line.speaker}</span>
                        <div class="p-4 rounded-2xl shadow-sm text-sm font-medium leading-relaxed border ${isKiot ? 'bg-blue-50 border-blue-100 rounded-bl-none text-slate-700' : 'bg-white border-slate-200 rounded-br-none text-slate-600'}">${formattedText}</div>
                    </div>
                </div>`;
            }).join('');
        }

        function renderVocab(vocab) {
            const container = document.getElementById('content-vocab');
            container.innerHTML = vocab.map((v, i) => {
                const formattedFull = v.full.replace(/\*\*(.*?)\*\*/g, '<span class="text-yellow-300 font-black border-b border-yellow-300">$1</span>');
                return `
                <div class="flip-card h-56 perspective-1000 group animate__animated animate__fadeIn" onclick="this.classList.toggle('flipped')">
                    <div class="flip-card-inner shadow-sm rounded-xl">
                        <div class="flip-card-front bg-white border border-slate-200 hover:border-blue-300">
                            <h3 class="text-base font-bold text-slate-800 px-4">${v.q}</h3>
                            <p class="text-[10px] text-slate-400 mt-6 uppercase font-bold tracking-widest"><i class="fa-solid fa-hand-pointer"></i> Chạm để lật</p>
                        </div>
                        <div class="flip-card-back bg-gradient-to-br from-blue-600 to-indigo-700 text-white">
                            <i class="fa-solid fa-lightbulb text-yellow-300 text-3xl mb-3"></i>
                            <p class="font-medium text-sm px-4">${formattedFull}</p>
                        </div>
                    </div>
                </div>
            `}).join('');
        }

        function renderQuiz(quiz) {
            const list = document.getElementById('quiz-list');
            quizState = { correct: 0, total: quiz.length };
            updateQuizStats();
            list.innerHTML = quiz.map((q, idx) => `
                <div class="bg-white rounded-xl p-6 shadow-sm border border-slate-100 quiz-card" id="quiz-${idx}">
                    <div class="flex gap-4 mb-4"><span class="shrink-0 w-8 h-8 bg-blue-100 text-blue-700 rounded-lg flex items-center justify-center text-xs font-bold">Q${idx + 1}</span><h3 class="font-bold text-slate-800 text-base">${q.q}</h3></div>
                    <div class="space-y-3 pl-12">
                        ${q.opts.map((opt, oid) => `
                            <button onclick="checkAnswer(${idx}, ${oid}, ${q.a})" class="w-full text-left p-3 rounded-lg border border-slate-200 hover:bg-blue-50 hover:border-blue-300 transition-all text-sm font-medium text-slate-600 quiz-opt flex items-center group">
                                <span class="w-6 h-6 rounded-md border border-slate-300 flex items-center justify-center text-[10px] text-slate-500 font-bold mr-3 group-hover:border-blue-400 group-hover:text-blue-500 opt-idx">${String.fromCharCode(65+oid)}</span><span class="flex-1">${opt}</span>
                            </button>
                        `).join('')}
                    </div>
                </div>
            `).join('');
        }

        function checkAnswer(qIdx, selected, correct) {
            const card = document.getElementById(`quiz-${qIdx}`);
            if(card.hasAttribute('data-answered')) return;
            card.setAttribute('data-answered', 'true');
            const opts = card.querySelectorAll('.quiz-opt');
            opts.forEach((btn, idx) => {
                btn.disabled = true;
                const idxSpan = btn.querySelector('.opt-idx');
                if (idx === correct) {
                    btn.classList.add('bg-green-50', 'border-green-500', 'text-green-800');
                    idxSpan.classList.add('bg-green-500', 'border-green-500', 'text-white');
                    idxSpan.innerHTML = '<i class="fa-solid fa-check"></i>';
                } else if (idx === selected) {
                    btn.classList.add('bg-red-50', 'border-red-500', 'text-red-800');
                    idxSpan.classList.add('bg-red-500', 'border-red-500', 'text-white');
                    idxSpan.innerHTML = '<i class="fa-solid fa-xmark"></i>';
                }
            });
            if (selected === correct) { quizState.correct++; confetti({ particleCount: 30, spread: 50, origin: { y: 0.7 } }); } 
            else { card.classList.add('animate__animated', 'animate__shakeX'); }
            updateQuizStats();
            if(document.querySelectorAll('.quiz-card[data-answered]').length === quizState.total) {
                if(quizState.correct === quizState.total && currentLessonId !== -1) { completedLessons.add(currentLessonId); updateProgress(); }
                if(currentLessonId === -1 && quizState.correct === quizState.total) { triggerMegaConfetti(); setTimeout(() => toggleModal('certificate-modal'), 1000); }
            }
        }

        function updateQuizStats() { document.getElementById('quiz-score').innerText = quizState.correct; document.getElementById('quiz-total').innerText = quizState.total; }
        function resetQuiz() { if(currentLessonId === -1) loadComprehensiveLesson(); else renderQuiz(courseData[currentLessonId].quiz); }

        function loadComprehensiveLesson() {
            currentLessonId = -1;
            const allQuizzes = courseData.flatMap(c => c.quiz);
            const mainTopic = '<span class="block text-sm text-indigo-500 font-bold uppercase tracking-wider mb-1">Quản lý Khách hàng</span>';
            document.getElementById('lesson-title-container').innerHTML = `${mainTopic}<h2 id="lesson-title" class="text-2xl md:text-3xl font-black text-slate-800">Bài kiểm tra Tổng hợp</h2>`;
            document.getElementById('lesson-desc').innerText = "Trả lời đúng 100% câu hỏi để nhận Chứng chỉ.";
            document.getElementById('lesson-icon').className = "fa-solid fa-graduation-cap text-2xl";
            renderQuiz(allQuizzes);
            document.getElementById('view-menu').classList.add('hidden');
            document.getElementById('view-learning').classList.remove('hidden');
            document.getElementById('lesson-navigation').innerHTML = `<div class="w-full text-center"><button onclick="goBack()" class="text-slate-400 font-bold text-sm hover:text-slate-600">Quay về trang chủ</button></div>`;
            updateDropdown();
            switchTab('quiz'); 
            window.scrollTo(0, 0);
        }

        function switchTab(tab) {
            currentActiveTab = tab;
            ['knowledge', 'dialogue', 'vocab', 'quiz'].forEach(t => { 
                document.getElementById(`content-${t}`).classList.add('hidden'); 
                document.getElementById(`btn-tab-${t}`).classList.remove('active', 'text-blue-600'); 
            });
            document.getElementById(`content-${tab}`).classList.remove('hidden');
            document.getElementById(`btn-tab-${tab}`).classList.add('active', 'text-blue-600');
        }

        function goBack() { 
            document.getElementById('view-learning').classList.add('hidden'); 
            document.getElementById('view-menu').classList.remove('hidden'); 
            updateProgress(); 
            renderMenu(); 
        }
        function updateProgress() { const pct = Math.round((completedLessons.size / courseData.length) * 100); document.getElementById('course-progress').style.width = `${pct}%`; document.getElementById('progress-text').innerText = `${pct}%`; }
        function updateDropdown() { 
            const select = document.getElementById('lesson-selector'); 
            let html = courseData.map((l, i) => `<option value="${i}" ${i === currentLessonId ? 'selected' : ''}>${i+1}. ${l.title}</option>`).join(''); 
            html += `<option value="-1" ${currentLessonId === -1 ? 'selected' : ''}>Kiểm tra Tổng hợp</option>`;
            select.innerHTML = html;
        }
        function switchLessonFromDropdown(val) { const id = parseInt(val); if(id === -1) loadComprehensiveLesson(); else loadLesson(id); }

        function renderNavigation() {
            const container = document.getElementById('lesson-navigation');
            const next = currentLessonId < courseData.length - 1 ? currentLessonId + 1 : null;
            let html = `<div class="flex-1"></div><div class="flex-1 text-right">`;
            if (next !== null) html += `<button onclick="loadLesson(${next})" class="text-blue-600 font-bold text-sm">Mục tiếp theo <i class="fa-solid fa-arrow-right"></i></button>`;
            else html += `<button onclick="loadComprehensiveLesson()" class="text-white bg-indigo-600 px-4 py-2 rounded-lg font-bold text-sm">Thi chứng chỉ <i class="fa-solid fa-graduation-cap"></i></button>`;
            html += '</div>';
            container.innerHTML = html;
        }

        function toggleModal(id) {
            const m = document.getElementById(id);
            if (m.classList.contains('opacity-0')) { m.classList.remove('opacity-0', 'pointer-events-none'); document.getElementById('cert-content').classList.remove('scale-95'); }
            else { m.classList.add('opacity-0', 'pointer-events-none'); document.getElementById('cert-content').classList.add('scale-95'); }
            document.body.classList.toggle('modal-active');
        }

        function triggerMegaConfetti() {
            var end = Date.now() + (3 * 1000);
            (function frame() {
                confetti({ particleCount: 3, angle: 60, spread: 55, origin: { x: 0 } });
                confetti({ particleCount: 3, angle: 120, spread: 55, origin: { x: 1 } });
                if (Date.now() < end) { requestAnimationFrame(frame); }
            }());
        }

        window.onload = init;
    </script></body></html>
