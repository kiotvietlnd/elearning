<!DOCTYPE html>
<html lang="vi" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Khóa học: Ngành Điện thoại – Điện máy | KiotViet Retail</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800;900&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css"/>
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>
    <style>
        body { font-family: 'Inter', sans-serif; background-color: #f8fafc; color: #334155; }
        ::-webkit-scrollbar { width: 6px; }
        ::-webkit-scrollbar-track { background: #f1f1f1; }
        ::-webkit-scrollbar-thumb { background: #cbd5e1; border-radius: 3px; }
        .soft-glow-background { position: fixed; top: 0; left: 0; width: 100%; height: 100%; z-index: -10; background: linear-gradient(to bottom right, #f8fafc, #e0f2fe); }
        .nav-link { position: relative; transition: color 0.3s; }
        .nav-link.active { color: var(--theme-color); }
        .glass-card { background: rgba(255, 255, 255, 0.9); backdrop-filter: blur(10px); border: 1px solid rgba(255, 255, 255, 0.8); box-shadow: 0 4px 6px -1px rgba(0,0,0,0.05); transition: all 0.3s ease; }
        .glass-card:hover { transform: translateY(-4px); box-shadow: 0 15px 30px -5px rgba(0,0,0,0.1); }
        .perspective-1000 { perspective: 1000px; }
        .flip-card-inner { position: relative; width: 100%; height: 100%; text-align: center; transition: transform 0.6s; transform-style: preserve-3d; cursor: pointer; }
        .flip-card.flipped .flip-card-inner { transform: rotateY(180deg); }
        .flip-card-front, .flip-card-back { position: absolute; width: 100%; height: 100%; backface-visibility: hidden; display: flex; flex-direction: column; align-items: center; justify-content: center; border-radius: 1rem; }
        .flip-card-back { transform: rotateY(180deg); }
        .float-btn { transition: transform 0.2s; }
        .float-btn:hover { transform: scale(1.1); }
        .tab-btn { position: relative; transition: all 0.3s ease; }
        .tab-btn::after { content: ''; position: absolute; bottom: -2px; left: 0; width: 0; height: 2px; background-color: currentColor; transition: width 0.3s ease; }
        .tab-btn.active::after { width: 100%; }
        .modal { transition: opacity 0.3s ease; }
        body.modal-active { overflow: hidden; }
        .knowledge-list li::marker { color: var(--theme-color); font-weight: bold; }
        @media print { body * { visibility: hidden; } #certificate-modal, #certificate-modal * { visibility: visible; } #certificate-modal { position: absolute; left: 0; top: 0; width: 100%; height: 100%; background: white; } .no-print { display: none; } }
    </style>
</head>
<body id="top" class="text-slate-700 antialiased selection:bg-blue-100 selection:text-blue-900">
    <div class="soft-glow-background"></div>

    <header class="sticky top-0 z-50 bg-white/90 backdrop-blur-md border-b border-slate-200 h-20">
        <div class="max-w-6xl mx-auto px-4 sm:px-6 lg:px-8 h-full">
            <div class="flex items-center justify-between h-full gap-8">
                <a href="https://kiotvietlnd.github.io/elearning" class="flex-shrink-0 flex items-center gap-3 hover:opacity-80">
                    <img src="https://logo.kiotviet.vn/KiotViet-Logo-Horizontal.svg" alt="KiotViet Logo" class="h-8">
                    <span class="text-slate-300 font-light text-2xl">|</span>
                    <span class="font-bold text-blue-600 tracking-tight text-lg uppercase">E-Learning</span>
                </a>
                <nav class="hidden lg:flex flex-1 justify-end items-center gap-8">
                    <a href="https://kiotvietlnd.github.io/elearning/retail" class="nav-link text-sm font-bold text-slate-600 hover:text-blue-600 uppercase py-1">Retail</a>
                    <a href="https://kiotvietlnd.github.io/elearning/fnb" class="nav-link text-sm font-bold text-slate-600 hover:text-orange-600 uppercase py-1">FNB</a>
                    <a href="https://kiotvietlnd.github.io/elearning/salon" class="nav-link text-sm font-bold text-slate-600 hover:text-pink-600 uppercase py-1">Salon</a>
                    <a href="https://kiotvietlnd.github.io/elearning/hotel" class="nav-link text-sm font-bold text-slate-600 hover:text-green-600 uppercase py-1">Hotel</a>
                    <div class="h-6 w-px bg-slate-300"></div>
                    <a href="https://kiotvietlnd.github.io/elearning/retail" class="flex items-center gap-2 px-4 py-2 bg-slate-100 text-slate-600 rounded-full font-bold text-sm border border-slate-200 hover:bg-slate-200 hover:text-blue-700 transition-all">
                        <i class="fa-solid fa-arrow-left"></i> Quay lại Danh mục
                    </a>
                </nav>
                <div class="lg:hidden">
                    <button onclick="document.getElementById('mobile-menu').classList.toggle('hidden')" class="text-slate-600 text-2xl p-2"><i class="fa-solid fa-bars"></i></button>
                </div>
            </div>
        </div>
        <div id="mobile-menu" class="hidden lg:hidden bg-white border-b border-slate-200 shadow-lg absolute w-full left-0 top-20 z-50">
            <div class="px-4 pt-2 pb-4 space-y-2">
                <a href="https://kiotvietlnd.github.io/elearning/retail" class="block px-3 py-2 rounded-md text-base font-bold text-blue-600 bg-blue-50">Retail</a>
                <a href="https://kiotvietlnd.github.io/elearning/fnb" class="block px-3 py-2 rounded-md text-base font-medium text-slate-600 hover:text-orange-600 hover:bg-orange-50">FNB</a>
                <a href="https://kiotvietlnd.github.io/elearning/salon" class="block px-3 py-2 rounded-md text-base font-medium text-slate-600 hover:text-pink-600 hover:bg-pink-50">Salon</a>
                <a href="https://kiotvietlnd.github.io/elearning/hotel" class="block px-3 py-2 rounded-md text-base font-medium text-slate-600 hover:text-green-600 hover:bg-green-50">Hotel</a>
                <div class="border-t border-slate-200 my-2 pt-2">
                    <a href="https://kiotvietlnd.github.io/elearning/retail" class="flex items-center gap-2 px-3 py-2 text-base font-bold text-slate-600 hover:text-blue-600">
                        <i class="fa-solid fa-arrow-left"></i> Quay lại Danh mục
                    </a>
                </div>
            </div>
        </div>
    </header>

    <main class="max-w-5xl mx-auto px-4 sm:px-6 lg:px-8 py-10 min-h-[80vh]">
        <div id="view-menu" class="animate__animated animate__fadeIn">
            <div class="text-center mb-12">
                <div class="inline-flex items-center gap-2 px-3 py-1 rounded-full bg-blue-50 text-blue-700 border border-blue-100 mb-4">
                    <i class="fa-solid fa-boxes-stacked text-xs"></i><span class="text-xs font-bold uppercase tracking-wider">Khóa học Retail</span>
                </div>
                <h1 class="text-3xl md:text-5xl font-black text-slate-800 tracking-tight mb-4">Ngành Điện thoại – Điện máy</h1>
                <div class="max-w-md mx-auto bg-white rounded-full h-4 shadow-inner border border-slate-200 overflow-hidden relative">
                    <div id="course-progress" class="bg-gradient-to-r from-blue-500 to-blue-400 h-full w-0 transition-all duration-1000"></div>
                </div>
                <p class="text-xs text-slate-400 mt-2 font-bold uppercase">Tiến độ: <span id="progress-text" class="text-blue-600">0%</span></p>
            </div>
            <div class="grid grid-cols-1 md:grid-cols-2 gap-6" id="lesson-grid"></div>
            <div onclick="loadLessonFromMenu(-1)" class="mt-8 bg-gradient-to-r from-indigo-600 to-purple-600 p-1 rounded-2xl cursor-pointer group hover:scale-[1.01] transition-transform shadow-xl">
                <div class="bg-white/10 backdrop-blur-md p-6 rounded-xl flex items-center justify-between h-full">
                    <div class="flex items-center gap-5 text-white">
                        <div class="w-14 h-14 rounded-2xl bg-white/20 flex items-center justify-center text-3xl"><i class="fa-solid fa-graduation-cap"></i></div>
                        <div><h3 class="font-bold text-xl mb-1">Bài kiểm tra Tổng hợp</h3><p class="text-indigo-100 text-sm opacity-90">Hoàn thành để nhận chứng chỉ.</p></div>
                    </div>
                    <div class="w-10 h-10 rounded-full bg-white text-indigo-600 flex items-center justify-center shadow-lg"><i class="fa-solid fa-arrow-right"></i></div>
                </div>
            </div>
        </div>

        <div id="view-learning" class="hidden animate__animated animate__fadeInRight">
            <div class="flex flex-col md:flex-row justify-between items-start md:items-center gap-4 mb-6">
                <button onclick="goBack()" class="group flex items-center gap-2 text-slate-500 hover:text-blue-600 font-bold text-sm bg-white px-4 py-2 rounded-lg border border-slate-200 shadow-sm hover:shadow transition-all">
                    <i class="fa-solid fa-arrow-left group-hover:-translate-x-1 transition-transform"></i> Danh sách mục
                </button>
                <div class="flex items-center gap-3 bg-white px-4 py-2 rounded-lg border border-slate-200 shadow-sm">
                    <i class="fa-solid fa-list-check text-blue-500"></i>
                    <select id="lesson-selector" onchange="switchLessonFromDropdown(this.value)" class="bg-transparent text-sm font-bold text-slate-700 focus:outline-none cursor-pointer w-56"></select>
                </div>
            </div>
            <div class="bg-white p-8 rounded-2xl shadow-sm border border-slate-200 mb-8 relative overflow-hidden">
                <div class="absolute right-0 top-0 w-64 h-64 bg-gradient-to-br from-blue-50 to-transparent rounded-full -mr-16 -mt-16 opacity-70 pointer-events-none"></div>
                <div class="relative z-10 flex items-center gap-6">
                    <div class="w-16 h-16 rounded-2xl bg-gradient-to-br from-blue-500 to-blue-600 text-white flex items-center justify-center shrink-0 shadow-lg">
                        <i id="lesson-icon" class="fa-solid fa-book-open text-2xl"></i>
                    </div>
                    <div>
                        <div class="flex items-center gap-2 mb-1"><span class="text-[10px] font-bold text-white bg-blue-500 px-2 py-0.5 rounded uppercase tracking-wider">Đang học</span></div>
                        <div id="lesson-title-container"></div>
                        <p id="lesson-desc" class="text-slate-500 mt-2 font-medium"></p>
                    </div>
                </div>
            </div>
            <div class="mb-8 bg-white rounded-xl shadow-sm border border-slate-100 p-1 inline-flex w-full md:w-auto overflow-x-auto">
                <button onclick="switchTab('knowledge')" id="btn-tab-knowledge" class="tab-btn flex-1 md:flex-none px-6 py-3 text-sm font-bold text-slate-500 hover:text-blue-600 active:text-blue-600 transition-all whitespace-nowrap"><i class="fa-regular fa-lightbulb"></i> Kiến thức</button>
                <div class="w-px bg-slate-200 my-2"></div>
                <button onclick="switchTab('dialogue')" id="btn-tab-dialogue" class="tab-btn flex-1 md:flex-none px-6 py-3 text-sm font-bold text-slate-500 hover:text-blue-600 active:text-blue-600 transition-all whitespace-nowrap"><i class="fa-regular fa-comments"></i> Hội thoại</button>
                <div class="w-px bg-slate-200 my-2"></div>
                <button onclick="switchTab('vocab')" id="btn-tab-vocab" class="tab-btn flex-1 md:flex-none px-6 py-3 text-sm font-bold text-slate-500 hover:text-blue-600 active:text-blue-600 transition-all whitespace-nowrap"><i class="fa-solid fa-bolt"></i> Flashcard</button>
                <div class="w-px bg-slate-200 my-2"></div>
                <button onclick="switchTab('quiz')" id="btn-tab-quiz" class="tab-btn flex-1 md:flex-none px-6 py-3 text-sm font-bold text-slate-500 hover:text-blue-600 active:text-blue-600 transition-all whitespace-nowrap"><i class="fa-solid fa-clipboard-question"></i> Luyện tập</button>
            </div>
            <div class="min-h-[400px]">
                <div id="content-knowledge" class="space-y-4 max-w-4xl mx-auto pb-10 hidden"></div>
                <div id="content-dialogue" class="space-y-6 max-w-3xl mx-auto pb-10 hidden"></div>
                <div id="content-vocab" class="grid grid-cols-1 md:grid-cols-2 gap-6 pb-10 hidden"></div>
                <div id="content-quiz" class="max-w-2xl mx-auto pb-10 hidden">
                     <div id="quiz-stats" class="bg-indigo-50 rounded-2xl p-5 flex justify-between items-center mb-6 border border-indigo-100">
                        <div class="flex items-center gap-4">
                            <div class="w-12 h-12 rounded-full bg-white text-indigo-600 flex items-center justify-center font-bold text-xl shadow-sm"><i class="fa-solid fa-trophy"></i></div>
                            <div><p class="text-xs text-indigo-500 font-bold uppercase">Kết quả</p><p class="text-xl font-black text-slate-800"><span id="quiz-score">0</span>/<span id="quiz-total">0</span></p></div>
                        </div>
                        <button onclick="resetQuiz()" class="text-xs font-bold text-slate-600 bg-white px-4 py-2 rounded-xl border border-slate-200 hover:bg-slate-50 shadow-sm"><i class="fa-solid fa-rotate-right"></i> Làm lại</button>
                    </div>
                    <div id="quiz-list" class="space-y-6"></div>
                </div>
            </div>
            <div id="lesson-navigation" class="mt-8 pt-6 border-t border-slate-200 flex justify-between items-center"></div>
        </div>
    </main>

    <footer class="bg-white/80 backdrop-blur-md border-t border-slate-200 mt-10 py-8 text-center relative z-10">
        <p class="text-slate-500 font-medium text-sm">Learning and Development Department</p>
        <p class="text-slate-400 text-xs mt-2">© 2026 KiotViet. All rights reserved.</p>
    </footer>

    <div class="fixed bottom-6 right-6 z-50 flex flex-col items-center space-y-3">
        <a href="https://notebooklm.google.com/notebook/a4480a38-2d6e-4974-9880-c45e534f5fa5" target="_blank" title="Hỏi Chatbot AI" class="float-btn w-12 h-12 bg-gradient-to-br from-indigo-500 to-purple-600 text-white rounded-full flex items-center justify-center shadow-lg border-2 border-white"><i class="fa-solid fa-robot"></i></a>
        <a href="https://www.kiotviet.vn/huong-dan-su-dung-kiotviet/retail-chuyen-nganh/nganh-dien-thoai-dien-may/#2-ban-hang-4-4" target="_blank" title="Xem Tài liệu" class="float-btn w-12 h-12 bg-blue-600 text-white rounded-full flex items-center justify-center shadow-lg border-2 border-white"><i class="fa-solid fa-book-open"></i></a>
        <a href="https://www.youtube.com/playlist?list=PL3x3GXJzpHzSXXO4aVoriCCGga4hTWsMYFNB" target="_blank" title="Xem Video" class="float-btn w-12 h-12 bg-red-600 text-white rounded-full flex items-center justify-center shadow-lg border-2 border-white"><i class="fa-brands fa-youtube"></i></a>
        <button id="scroll-to-top" onclick="window.scrollTo({top: 0, behavior: 'smooth'})" class="hidden w-12 h-12 bg-white text-slate-600 border border-slate-200 rounded-full items-center justify-center shadow-lg float-btn"><i class="fas fa-arrow-up"></i></button>
    </div>

    <div id="certificate-modal" class="modal opacity-0 pointer-events-none fixed inset-0 z-[100] flex items-center justify-center p-4">
        <div class="absolute inset-0 bg-slate-900/90 backdrop-blur-sm" onclick="toggleModal('certificate-modal')"></div>
        <div class="bg-white w-full max-w-3xl rounded-xl shadow-2xl relative z-10 transform scale-95 transition-all duration-300" id="cert-content">
            <div class="p-2">
                <div class="border-8 border-double border-blue-800 p-8 text-center bg-white relative overflow-hidden">
                    <div class="absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 w-96 h-96 bg-[url('https://cdn-icons-png.flaticon.com/512/2912/2912761.png')] bg-contain bg-no-repeat opacity-5 pointer-events-none"></div>
                    <img src="https://logo.kiotviet.vn/KiotViet-Logo-Horizontal.svg" alt="Logo" class="h-10 mx-auto mb-6">
                    <h2 class="text-4xl font-black font-sans text-blue-900 mb-2 uppercase tracking-widest">Giấy Chứng Nhận</h2>
                    <div class="w-24 h-1 bg-gradient-to-r from-blue-600 to-indigo-600 mx-auto mb-8"></div>
                    <p class="text-slate-500 italic mb-2 font-medium">Chứng nhận nhân viên:</p>
                    <div class="text-3xl font-black text-blue-600 mb-6 uppercase tracking-wider font-sans">Học Viên KiotViet</div>
                    <p class="text-slate-600 mb-2 font-medium">Đã hoàn thành xuất sắc khóa đào tạo:</p>
                    <h3 class="text-2xl font-bold text-slate-800 mb-10 uppercase border-2 border-slate-800 inline-block px-6 py-2">Ngành Điện thoại – Điện máy</h3>
                    <div class="flex justify-between items-end mt-12 px-10">
                        <div class="text-center"><p class="text-xs text-slate-400 font-bold uppercase mb-1">Ngày cấp</p><p class="text-lg font-bold text-slate-700" id="cert-date">--/--/----</p></div>
                        <div class="text-center relative"><div class="w-24 h-24 absolute -top-12 -left-6 bg-[url('https://cdn-icons-png.flaticon.com/512/1041/1041166.png')] bg-contain bg-no-repeat opacity-80 rotate-12"></div><p class="text-sm font-bold text-blue-900 mt-10 relative z-10">KiotViet Training Dept.</p></div>
                    </div>
                </div>
            </div>
            <div class="bg-slate-50 p-4 flex justify-end gap-3 rounded-b-xl border-t border-slate-100 no-print">
                <button onclick="toggleModal('certificate-modal')" class="px-5 py-2.5 text-slate-600 font-bold rounded-lg hover:bg-slate-200">Đóng</button>
                <button onclick="window.print()" class="px-5 py-2.5 bg-blue-600 text-white font-bold rounded-lg hover:bg-blue-700 flex items-center gap-2"><i class="fa-solid fa-print"></i> In chứng chỉ</button>
            </div>
        </div>
    </div>

    <script>
        const courseData = [
  {
    "title": "Giới thiệu chung",
    "icon": "fa-solid fa-mobile-screen",
    "desc": "Tổng quan về quản lý định danh sản phẩm và lợi ích của giải pháp KiotViet.",
    "knowledge": [
      {
        "header": "1. Đặc thù ngành hàng",
        "content": [
          "Quản lý hàng hóa định danh duy nhất (Mỗi sản phẩm 1 mã riêng).",
          "Quy trình bảo hành, sửa chữa phức tạp.",
          "Cần theo dõi lịch sử vòng đời sản phẩm chi tiết."
        ]
      },
      {
        "header": "2. Lợi ích giải pháp KiotViet",
        "content": [
          "**Quản lý IMEI/Serial:** Theo dõi chi tiết từ nhập, bán đến bảo hành. Tránh thất thoát, nhầm lẫn.",
          "**Quy trình Sửa chữa:** Tạo phiếu tiếp nhận, theo dõi trạng thái, quản lý linh kiện thay thế.",
          "**Chăm sóc khách hàng:** Lưu lịch sử mua hàng (khách mua IMEI nào), hỗ trợ tra cứu bảo hành nhanh chóng."
        ]
      }
    ],
    "dialogue": [
      {
        "speaker": "Tâm (Chủ cửa hàng)",
        "target": "Chào Hùng, anh đang rối quá. Nhập 10 cái iPhone 16 về, giờ bán đi vài cái mà không nhớ chính xác máy nào bán cho ai, lỡ khách quay lại bảo hành thì không biết đường nào mà lần."
      },
      {
        "speaker": "Hùng (Chuyên viên KiotViet)",
        "target": "Em hiểu vấn đề của anh Tâm ạ. Với ngành điện máy, việc quản lý chung chung là không đủ. Anh cần giải pháp quản lý chi tiết theo **IMEI/Serial** của KiotViet."
      },
      {
        "speaker": "Tâm (Chủ cửa hàng)",
        "target": "Tính năng đó giúp gì được cho anh?"
      },
      {
        "speaker": "Hùng (Chuyên viên KiotViet)",
        "target": "Nó giúp anh định danh từng chiếc máy. Khi bán, anh chọn đúng IMEI đó. Hệ thống sẽ lưu lại: Máy IMEI này bán ngày nào, cho ai, bảo hành đến bao giờ. Sau này khách chỉ cần đọc số điện thoại hoặc IMEI là ra ngay lịch sử."
      }
    ],
    "vocab": [
      {
        "q": "Quản lý sản phẩm theo __________ giúp theo dõi vòng đời từng thiết bị riêng biệt.",
        "full": "Quản lý sản phẩm theo **IMEI/Serial** giúp theo dõi vòng đời từng thiết bị riêng biệt."
      },
      {
        "q": "Tính năng __________ giúp cửa hàng tiếp nhận và theo dõi quá trình xử lý thiết bị lỗi của khách.",
        "full": "Tính năng **Bảo hành, sửa chữa** giúp cửa hàng tiếp nhận và theo dõi quá trình xử lý thiết bị lỗi của khách."
      },
      {
        "q": "Hệ thống giúp lưu trữ __________ chi tiết để hỗ trợ việc tư vấn và chăm sóc sau bán.",
        "full": "Hệ thống giúp lưu trữ **lịch sử mua hàng** chi tiết để hỗ trợ việc tư vấn và chăm sóc sau bán."
      }
    ],
    "quiz": [
      {
        "q": "Lợi ích lớn nhất của việc quản lý theo Serial/IMEI là gì?",
        "opts": [
          "Giúp hàng hóa trông đẹp hơn trên kệ.",
          "Định danh chính xác từng sản phẩm, tránh thất thoát và hỗ trợ bảo hành chuẩn xác.",
          "Giúp bán hàng nhanh hơn mà không cần quét mã."
        ],
        "a": 1
      },
      {
        "q": "KiotViet hỗ trợ những nghiệp vụ đặc thù nào cho ngành điện máy?",
        "opts": [
          "Chỉ quản lý tồn kho số lượng.",
          "Quản lý IMEI, Bảo hành - Sửa chữa, In tem mã vạch.",
          "Chỉ tính tiền đơn giản."
        ],
        "a": 1
      }
    ]
  },
  {
    "title": "Các thao tác cơ bản",
    "icon": "fa-solid fa-gears",
    "desc": "Hướng dẫn thiết lập, nhập hàng và bán hàng quản lý theo IMEI/Serial.",
    "knowledge": [
      {
        "header": "1. Thiết lập ban đầu",
        "content": [
          "Vào **Thiết lập** -> **Hàng hóa**.",
          "Bật **Quản lý tồn kho theo Serial/IMEI**.",
          "Bật **Bảo hành, bảo trì, yêu cầu sửa chữa** (Thiết lập nhắc lịch hết hạn nếu cần)."
        ]
      },
      {
        "header": "2. Thêm hàng hóa & Nhập hàng",
        "content": [
          "Khi thêm mới hàng hóa: Tích chọn **Quản lý theo Serial/IMEI**.",
          "Nhập thời hạn bảo hành (Ví dụ: 12 tháng).",
          "Khi tạo phiếu Nhập hàng: Nhập hoặc quét mã IMEI cho từng sản phẩm nhập kho."
        ]
      },
      {
        "header": "3. Bán hàng",
        "content": [
          "Chọn sản phẩm cần bán trên màn hình Bán hàng.",
          "Hệ thống yêu cầu chọn đúng số **Serial/IMEI** muốn xuất kho.",
          "Nhập thông tin khách hàng (Quan trọng để lưu bảo hành)."
        ]
      }
    ],
    "dialogue": [
      {
        "speaker": "Hùng (Chuyên viên KiotViet)",
        "target": "Bây giờ em hướng dẫn anh Tâm thiết lập nhé. Đầu tiên, anh vào mục Thiết lập Hàng hóa, bật cái nút 'Quản lý tồn kho theo Serial/IMEI' lên ạ."
      },
      {
        "speaker": "Tâm (Chủ cửa hàng)",
        "target": "Ok, anh bật rồi. Thế lúc tạo món hàng mới như cái iPhone 16 này thì làm sao?"
      },
      {
        "speaker": "Hùng (Chuyên viên KiotViet)",
        "target": "Anh tạo như bình thường, nhưng nhớ tích vào ô **Quản lý theo Serial/IMEI** nhé. Lúc đó hệ thống mới hiểu đây là hàng đặc biệt."
      },
      {
        "speaker": "Tâm (Chủ cửa hàng)",
        "target": "Rồi lúc nhập hàng về thì nhập số lượng là 10 à?"
      },
      {
        "speaker": "Hùng (Chuyên viên KiotViet)",
        "target": "Không ạ, anh sẽ nhập (hoặc quét) 10 cái mã IMEI vào. Hệ thống sẽ tự cộng tổng số lượng là 10 cho anh."
      }
    ],
    "vocab": [
      {
        "q": "Để kích hoạt tính năng, vào menu Thiết lập và bật tùy chọn Quản lý tồn kho theo __________.",
        "full": "Để kích hoạt tính năng, vào menu Thiết lập và bật tùy chọn Quản lý tồn kho theo **Serial/IMEI**."
      },
      {
        "q": "Khi thêm mới hàng hóa, cần tích chọn ô __________ để kích hoạt quản lý từng thiết bị.",
        "full": "Khi thêm mới hàng hóa, cần tích chọn ô **Quản lý theo Serial/IMEI** để kích hoạt quản lý từng thiết bị."
      },
      {
        "q": "Khi bán hàng, nhân viên bắt buộc phải chọn đúng số __________ của sản phẩm để xuất kho.",
        "full": "Khi bán hàng, nhân viên bắt buộc phải chọn đúng số **IMEI** của sản phẩm để xuất kho."
      }
    ],
    "quiz": [
      {
        "q": "Thao tác nào là BẮT BUỘC khi nhập hàng điện thoại có quản lý IMEI?",
        "opts": [
          "Chỉ cần nhập tổng số lượng hàng.",
          "Nhập hoặc quét chi tiết từng mã IMEI/Serial vào phiếu nhập.",
          "Nhập giá vốn trước rồi nhập tên sau."
        ],
        "a": 1
      },
      {
        "q": "Tại sao nên thêm thông tin khách hàng khi bán điện thoại?",
        "opts": [
          "Để lưu lại lịch sử mua hàng, phục vụ tra cứu bảo hành sau này.",
          "Để in hóa đơn cho đẹp.",
          "Để khách hàng không phải chờ lâu."
        ],
        "a": 0
      }
    ]
  },
  {
    "title": "Các tính năng nâng cao",
    "icon": "fa-solid fa-screwdriver-wrench",
    "desc": "Quy trình bảo hành sửa chữa, tra cứu lịch sử và in tem mã vạch.",
    "knowledge": [
      {
        "header": "1. Quy trình Bảo hành & Sửa chữa",
        "content": [
          "Màn hình Bán hàng -> Chọn **Thêm mới sửa chữa**.",
          "Tìm khách hàng hoặc tra cứu IMEI thiết bị cũ.",
          "Ghi nhận tình trạng (vỡ màn, lỗi pin...), mật khẩu máy, phụ kiện kèm theo.",
          "Sau khi sửa xong -> Tạo hóa đơn thanh toán dịch vụ/linh kiện."
        ]
      },
      {
        "header": "2. Tra cứu & Công nợ",
        "content": [
          "Vào hồ sơ Khách hàng -> Xem lịch sử giao dịch.",
          "Kiểm tra chi tiết từng lần mua, từng mã IMEI đã bán."
        ]
      },
      {
        "header": "3. In tem mã vạch",
        "content": [
          "Dành cho phụ kiện hoặc máy trần không có hộp.",
          "Vào Hàng hóa -> Chọn sản phẩm -> **In tem mã**."
        ]
      }
    ],
    "dialogue": [
      {
        "speaker": "Tâm (Chủ cửa hàng)",
        "target": "Hùng ơi, khách mang máy cũ đến sửa thì làm sao anh quản lý được linh kiện thay thế?"
      },
      {
        "speaker": "Hùng (Chuyên viên KiotViet)",
        "target": "Anh dùng tính năng **Sửa chữa** nhé. Anh tạo phiếu tiếp nhận, ghi rõ máy bị sao. Khi thay pin hay màn hình, anh thêm linh kiện đó vào phiếu."
      },
      {
        "speaker": "Tâm (Chủ cửa hàng)",
        "target": "Thế có in được phiếu hẹn cho khách không?"
      },
      {
        "speaker": "Hùng (Chuyên viên KiotViet)",
        "target": "Có chứ anh. Phiếu tiếp nhận có đầy đủ thông tin máy, tình trạng và ngày hẹn trả. Giúp cửa hàng anh chuyên nghiệp hơn hẳn."
      },
      {
        "speaker": "Tâm (Chủ cửa hàng)",
        "target": "Tuyệt, còn mấy cái ốp lưng không có mã vạch thì sao?"
      },
      {
        "speaker": "Hùng (Chuyên viên KiotViet)",
        "target": "Anh dùng chức năng **In tem mã** để dán lên sản phẩm, lúc bán chỉ cần quét 'tít' một cái là xong."
      }
    ],
    "vocab": [
      {
        "q": "Sử dụng tính năng __________ để tạo phiếu tiếp nhận máy lỗi từ khách hàng.",
        "full": "Sử dụng tính năng **Thêm mới sửa chữa** để tạo phiếu tiếp nhận máy lỗi từ khách hàng."
      },
      {
        "q": "Để dán mã cho phụ kiện chưa có mã vạch, sử dụng chức năng __________ trong danh sách hàng hóa.",
        "full": "Để dán mã cho phụ kiện chưa có mã vạch, sử dụng chức năng **In tem mã** trong danh sách hàng hóa."
      },
      {
        "q": "Vào chi tiết __________ để xem lại toàn bộ lịch sử mua hàng và IMEI đã bán cho họ.",
        "full": "Vào chi tiết **Khách hàng** để xem lại toàn bộ lịch sử mua hàng và IMEI đã bán cho họ."
      }
    ],
    "quiz": [
      {
        "q": "Khi nhận máy của khách để sửa, bạn nên làm gì trên KiotViet?",
        "opts": [
          "Ghi vào sổ tay.",
          "Tạo phiếu 'Thêm mới sửa chữa' để ghi nhận tình trạng và linh kiện thay thế.",
          "Tạo ngay hóa đơn bán hàng."
        ],
        "a": 1
      },
      {
        "q": "Chức năng In tem mã vạch thường dùng cho đối tượng nào?",
        "opts": [
          "Các sản phẩm phụ kiện hoặc máy trần chưa có mã vạch nhà sản xuất.",
          "Tất cả các sản phẩm đã có mã vạch sẵn.",
          "Chỉ dùng cho hàng dịch vụ."
        ],
        "a": 0
      }
    ]
  },
  {
    "title": "Thao tác trên Điện thoại",
    "icon": "fa-solid fa-mobile",
    "desc": "Sử dụng App KiotViet trên điện thoại để bán hàng và quét mã linh hoạt.",
    "knowledge": [
      {
        "header": "1. Tiện ích App quản lý",
        "content": [
          "**Thêm hàng:** Nút dấu (+) -> Thêm hàng hóa -> Bật Quản lý Serial/IMEI.",
          "**Nhập hàng:** Dùng Camera điện thoại để quét mã vạch/IMEI cực nhanh thay vì nhập tay."
        ]
      },
      {
        "header": "2. Bán hàng di động",
        "content": [
          "Tạo hóa đơn ngay khi đang tư vấn.",
          "Chạm vào sản phẩm -> Chọn IMEI từ danh sách hoặc quét mã.",
          "Thanh toán và in hóa đơn từ xa."
        ]
      }
    ],
    "dialogue": [
      {
        "speaker": "Tâm (Chủ cửa hàng)",
        "target": "Nhiều khi anh đứng tư vấn ở quầy kệ, chạy lại máy tính để kiểm tra hàng hơi bất tiện."
      },
      {
        "speaker": "Hùng (Chuyên viên KiotViet)",
        "target": "Anh dùng App KiotViet trên điện thoại đi anh. Anh đứng tại chỗ, mở App ra, dùng **Camera** quét mã vạch cái ốp lưng là biết ngay còn hàng hay không."
      },
      {
        "speaker": "Tâm (Chủ cửa hàng)",
        "target": "Thế có tạo đơn luôn được không?"
      },
      {
        "speaker": "Hùng (Chuyên viên KiotViet)",
        "target": "Được luôn anh. Anh chọn hàng, chọn IMEI, rồi bấm thanh toán ngay trên điện thoại. Rất tiện khi cửa hàng đông khách."
      }
    ],
    "vocab": [
      {
        "q": "Trên ứng dụng điện thoại, có thể sử dụng __________ để quét nhanh mã vạch sản phẩm.",
        "full": "Trên ứng dụng điện thoại, có thể sử dụng **Camera** để quét nhanh mã vạch sản phẩm."
      },
      {
        "q": "Khi bán hàng trên App, chạm vào sản phẩm để chọn số __________ tương ứng.",
        "full": "Khi bán hàng trên App, chạm vào sản phẩm để chọn số **Serial/IMEI** tương ứng."
      },
      {
        "q": "Nhấn vào biểu tượng __________ để bắt đầu thêm mới hàng hóa trên ứng dụng.",
        "full": "Nhấn vào biểu tượng **dấu +** để bắt đầu thêm mới hàng hóa trên ứng dụng."
      }
    ],
    "quiz": [
      {
        "q": "Lợi ích chính của việc dùng App KiotViet trên điện thoại trong cửa hàng điện máy là gì?",
        "opts": [
          "Dùng để chơi game lúc rảnh.",
          "Linh hoạt tra cứu, bán hàng và quét mã vạch bằng Camera ngay tại quầy kệ.",
          "Chỉ để xem báo cáo doanh thu."
        ],
        "a": 1
      },
      {
        "q": "Khi nhập hàng trên điện thoại, làm sao để nhập IMEI nhanh nhất?",
        "opts": [
          "Gõ từng số bằng bàn phím ảo.",
          "Sử dụng Camera để quét mã vạch trên vỏ hộp.",
          "Chụp ảnh sản phẩm lại."
        ],
        "a": 1
      }
    ]
  }
];

        let currentLessonId = 0;
        let completedLessons = new Set();
        let quizState = { correct: 0, total: 0 };
        let currentActiveTab = 'knowledge'; // Default tab

        function init() {
            renderMenu();
            updateProgress();
            const today = new Date();
            document.getElementById('cert-date').innerText = `${today.getDate()}/${today.getMonth() + 1}/${today.getFullYear()}`;
            
            const scrollTopBtn = document.getElementById('scroll-to-top');
            window.onscroll = function() {
                if (document.body.scrollTop > 300 || document.documentElement.scrollTop > 300) { scrollTopBtn.classList.remove('hidden'); scrollTopBtn.classList.add('flex'); }
                else { scrollTopBtn.classList.add('hidden'); scrollTopBtn.classList.remove('flex'); }
            };
        }

        function renderMenu() {
            const grid = document.getElementById('lesson-grid');
            grid.innerHTML = courseData.map((lesson, idx) => `
                <div onclick="loadLessonFromMenu(${idx})" class="glass-card bg-white rounded-xl p-5 cursor-pointer group hover:border-blue-400 relative overflow-hidden transition-all duration-300">
                    <div class="flex items-start gap-4 relative z-10">
                        <div class="w-12 h-12 rounded-lg bg-blue-50 text-blue-600 flex items-center justify-center text-xl shadow-sm border border-blue-100 group-hover:bg-blue-600 group-hover:text-white transition-colors duration-300"><i class="${lesson.icon}"></i></div>
                        <div><h3 class="font-bold text-lg text-slate-800 group-hover:text-blue-600 transition-colors">${lesson.title}</h3><p class="text-sm text-slate-500 mt-1 line-clamp-2">${lesson.desc}</p></div>
                    </div>
                    <div class="mt-4 pt-3 border-t border-slate-100 flex items-center justify-between">
                        <span class="text-[10px] font-bold text-slate-400 uppercase tracking-widest group-hover:text-blue-500">Mục ${idx + 1}</span>
                        ${completedLessons.has(idx) ? '<i class="fa-solid fa-circle-check text-green-500 text-xl animate__animated animate__rubberBand"></i>' : '<i class="fa-regular fa-circle-play text-slate-300 text-xl group-hover:text-blue-500 transition-colors"></i>'}
                    </div>
                </div>
            `).join('');
        }

        function loadLessonFromMenu(id) {
            currentActiveTab = 'knowledge';
            if(id === -1) loadComprehensiveLesson(); else loadLesson(id);
        }

        function loadLesson(id) {
            currentLessonId = id;
            const lesson = courseData[id];
            const mainTopic = '<span class="block text-sm text-blue-500 font-bold uppercase tracking-wider mb-1">Ngành Điện thoại – Điện máy</span>';
            document.getElementById('lesson-title-container').innerHTML = `${mainTopic}<h2 id="lesson-title" class="text-2xl md:text-3xl font-black text-slate-800">${lesson.title}</h2>`;
            document.getElementById('lesson-desc').innerText = lesson.desc;
            document.getElementById('lesson-icon').className = `${lesson.icon} text-2xl`;
            
            renderKnowledge(lesson.knowledge);
            renderDialogue(lesson.dialogue);
            renderVocab(lesson.vocab);
            renderQuiz(lesson.quiz);
            
            updateDropdown();
            renderNavigation();
            document.getElementById('view-menu').classList.add('hidden');
            document.getElementById('view-learning').classList.remove('hidden');
            switchTab(currentActiveTab);
            window.scrollTo(0, 0);
        }

        function renderKnowledge(data) {
            const container = document.getElementById('content-knowledge');
            if(!data || data.length === 0) {
                 container.innerHTML = `<div class="p-6 bg-slate-50 rounded-xl text-center text-slate-500">Chưa có dữ liệu chi tiết.</div>`;
                 return;
            }
            container.innerHTML = data.map((item, idx) => `
                <div class="bg-white rounded-xl p-6 shadow-sm border border-slate-100 animate__animated animate__fadeInUp" style="animation-delay: ${idx * 100}ms">
                    <div class="flex gap-4">
                        <div class="shrink-0 w-10 h-10 rounded-full bg-blue-50 text-blue-600 flex items-center justify-center font-bold shadow-sm border border-blue-100">${idx + 1}</div>
                        <div class="flex-1">
                            <h3 class="font-bold text-slate-800 text-lg mb-3 pb-2 border-b border-slate-100">${item.header}</h3>
                            <ul class="space-y-3 knowledge-list">
                                ${item.content.map(point => {
                                    const formattedPoint = point.replace(/\*\*(.*?)\*\*/g, '<b class="text-blue-700 font-bold">$1</b>');
                                    return `<li class="flex gap-3 text-sm text-slate-600 leading-relaxed items-start"><i class="fa-solid fa-check text-blue-500 mt-1 shrink-0"></i> <span>${formattedPoint}</span></li>`;
                                }).join('')}
                            </ul>
                        </div>
                    </div>
                </div>
            `).join('');
        }

        function renderDialogue(dialogue) {
            const container = document.getElementById('content-dialogue');
            container.innerHTML = dialogue.map((line, idx) => {
                const isKiot = line.speaker.includes('KiotViet');
                const formattedText = line.target.replace(/\*\*(.*?)\*\*/g, '<b class="text-blue-700 font-bold">$1</b>');
                return `
                <div class="flex ${isKiot ? 'flex-row' : 'flex-row-reverse'} gap-4 items-end animate__animated animate__fadeInUp" style="animation-delay: ${idx * 50}ms">
                    <div class="w-10 h-10 rounded-full flex items-center justify-center shrink-0 shadow-md ${isKiot ? 'bg-blue-600 text-white' : 'bg-white border border-slate-200 text-slate-600'}"><i class="fa-solid ${isKiot ? 'fa-user-tie' : 'fa-store'}"></i></div>
                    <div class="flex flex-col ${isKiot ? 'items-start' : 'items-end'} max-w-[80%]">
                        <span class="text-[10px] font-bold text-slate-400 mb-1 uppercase tracking-wide">${line.speaker}</span>
                        <div class="p-4 rounded-2xl shadow-sm text-sm font-medium leading-relaxed border ${isKiot ? 'bg-blue-50 border-blue-100 rounded-bl-none text-slate-700' : 'bg-white border-slate-200 rounded-br-none text-slate-600'}">${formattedText}</div>
                    </div>
                </div>`;
            }).join('');
        }

        function renderVocab(vocab) {
            const container = document.getElementById('content-vocab');
            container.innerHTML = vocab.map((v, i) => {
                const formattedFull = v.full.replace(/\*\*(.*?)\*\*/g, '<span class="text-yellow-300 font-black border-b border-yellow-300">$1</span>');
                return `
                <div class="flip-card h-56 perspective-1000 group animate__animated animate__fadeIn" style="animation-delay: ${i * 50}ms" onclick="this.classList.toggle('flipped')">
                    <div class="flip-card-inner shadow-sm rounded-xl">
                        <div class="flip-card-front bg-white border border-slate-200 hover:border-blue-300 transition-colors">
                            <div class="w-12 h-12 bg-blue-50 rounded-full flex items-center justify-center mb-4 text-blue-500"><i class="fa-solid fa-question text-xl"></i></div>
                            <h3 class="text-base font-bold text-slate-800 px-4 leading-snug">${v.q}</h3>
                            <p class="text-[10px] text-slate-400 mt-6 uppercase tracking-widest font-bold flex items-center gap-1"><i class="fa-solid fa-hand-pointer animate-pulse"></i> Chạm để lật</p>
                        </div>
                        <div class="flip-card-back bg-gradient-to-br from-blue-600 to-indigo-700 text-white">
                            <i class="fa-solid fa-lightbulb text-yellow-300 text-3xl mb-3"></i>
                            <span class="text-[10px] font-bold uppercase tracking-widest text-blue-200 mb-1">Ghi nhớ</span>
                            <p class="font-medium text-sm px-4 leading-relaxed">${formattedFull}</p>
                        </div>
                    </div>
                </div>
            `}).join('');
        }

        function renderQuiz(quiz) {
            const list = document.getElementById('quiz-list');
            quizState = { correct: 0, total: quiz.length };
            updateQuizStats();
            list.innerHTML = quiz.map((q, idx) => `
                <div class="bg-white rounded-xl p-6 shadow-sm border border-slate-100 quiz-card transition-all" id="quiz-${idx}">
                    <div class="flex gap-4 mb-4"><span class="shrink-0 w-8 h-8 bg-blue-100 text-blue-700 rounded-lg flex items-center justify-center text-xs font-bold">Q${idx + 1}</span><h3 class="font-bold text-slate-800 text-base leading-snug">${q.q}</h3></div>
                    <div class="space-y-3 pl-12">
                        ${q.opts.map((opt, oid) => `
                            <button onclick="checkAnswer(${idx}, ${oid}, ${q.a})" class="w-full text-left p-3 rounded-lg border border-slate-200 hover:bg-blue-50 hover:border-blue-300 transition-all text-sm font-medium text-slate-600 quiz-opt flex items-center group">
                                <span class="w-6 h-6 rounded-md border border-slate-300 flex items-center justify-center text-[10px] text-slate-500 font-bold mr-3 group-hover:border-blue-400 group-hover:text-blue-500 opt-idx transition-colors">${String.fromCharCode(65+oid)}</span><span class="flex-1">${opt}</span>
                            </button>
                        `).join('')}
                    </div>
                </div>
            `).join('');
        }

        function checkAnswer(qIdx, selected, correct) {
            const card = document.getElementById(`quiz-${qIdx}`);
            if(card.hasAttribute('data-answered')) return;
            card.setAttribute('data-answered', 'true');
            const opts = card.querySelectorAll('.quiz-opt');
            opts.forEach((btn, idx) => {
                btn.disabled = true;
                btn.classList.remove('hover:bg-blue-50', 'hover:border-blue-300');
                const idxSpan = btn.querySelector('.opt-idx');
                if (idx === correct) {
                    btn.classList.add('bg-green-50', 'border-green-500', 'text-green-800');
                    idxSpan.classList.add('bg-green-500', 'border-green-500', 'text-white');
                    idxSpan.innerHTML = '<i class="fa-solid fa-check"></i>';
                } else if (idx === selected) {
                    btn.classList.add('bg-red-50', 'border-red-500', 'text-red-800');
                    idxSpan.classList.add('bg-red-500', 'border-red-500', 'text-white');
                    idxSpan.innerHTML = '<i class="fa-solid fa-xmark"></i>';
                }
            });
            if (selected === correct) { quizState.correct++; confetti({ particleCount: 40, spread: 60, origin: { y: 0.7 } }); } 
            else { card.classList.add('animate__animated', 'animate__shakeX'); }
            updateQuizStats();
            if(document.querySelectorAll('.quiz-card[data-answered]').length === quizState.total) {
                if(quizState.correct === quizState.total && currentLessonId !== -1) { completedLessons.add(currentLessonId); updateProgress(); }
                if(currentLessonId === -1 && quizState.correct === quizState.total) { triggerMegaConfetti(); setTimeout(() => toggleModal('certificate-modal'), 1200); }
            }
        }

        function updateQuizStats() { document.getElementById('quiz-score').innerText = quizState.correct; document.getElementById('quiz-total').innerText = quizState.total; }
        function resetQuiz() { if(currentLessonId === -1) loadComprehensiveLesson(); else renderQuiz(courseData[currentLessonId].quiz); }

        function loadComprehensiveLesson() {
            currentLessonId = -1;
            const allQuizzes = courseData.flatMap(c => c.quiz);
            const allDialogues = courseData.flatMap(c => c.dialogue);
            const allVocabs = courseData.flatMap(c => c.vocab);
            const allKnowledge = courseData.flatMap(c => c.knowledge);
            
            const mainTopic = '<span class="block text-sm text-indigo-500 font-bold uppercase tracking-wider mb-1">Ngành Điện thoại – Điện máy</span>';
            document.getElementById('lesson-title-container').innerHTML = `${mainTopic}<h2 id="lesson-title" class="text-2xl md:text-3xl font-black text-slate-800">Bài kiểm tra Tổng hợp</h2>`;
            document.getElementById('lesson-desc').innerText = "Ôn tập toàn diện và trả lời đúng 100% câu hỏi để nhận Chứng chỉ.";
            document.getElementById('lesson-icon').className = "fa-solid fa-graduation-cap text-2xl";
            
            // Render content
            renderKnowledge(allKnowledge); renderDialogue(allDialogues); renderVocab(allVocabs); renderQuiz(allQuizzes);
            
            // View transition
            document.getElementById('view-menu').classList.add('hidden');
            document.getElementById('view-learning').classList.remove('hidden');
            document.getElementById('lesson-navigation').innerHTML = `<div class="w-full flex justify-center"><button onclick="goBack()" class="text-slate-400 font-bold text-sm hover:text-slate-600 flex items-center gap-2"><i class="fa-solid fa-arrow-up"></i> Quay về trang chủ</button></div>`;
            
            // Show all tabs
            document.getElementById('btn-tab-knowledge').classList.remove('hidden');
            document.getElementById('btn-tab-dialogue').nextElementSibling.classList.remove('hidden'); 
            
            updateDropdown(); // Update dropdown to show "Test" selected

            switchTab('quiz'); 
            window.scrollTo(0, 0);
        }

        function switchTab(tab) {
            currentActiveTab = tab;
            ['knowledge', 'dialogue', 'vocab', 'quiz'].forEach(t => { 
                const contentEl = document.getElementById(`content-${t}`);
                const btnEl = document.getElementById(`btn-tab-${t}`);
                if(contentEl) contentEl.classList.add('hidden'); 
                if(btnEl) btnEl.classList.remove('active', 'text-blue-600'); 
            });
            const targetContent = document.getElementById(`content-${tab}`);
            const targetBtn = document.getElementById(`btn-tab-${tab}`);
            if(targetContent) targetContent.classList.remove('hidden');
            if(targetBtn) targetBtn.classList.add('active', 'text-blue-600');
        }

        function goBack() { 
            document.getElementById('btn-tab-knowledge').classList.remove('hidden');
            document.getElementById('btn-tab-dialogue').nextElementSibling.classList.remove('hidden');
            document.getElementById('view-learning').classList.add('hidden'); 
            document.getElementById('view-menu').classList.remove('hidden'); 
            updateProgress(); 
            renderMenu(); 
            window.scrollTo(0, 0); 
        }
        function updateProgress() { const pct = Math.round((completedLessons.size / courseData.length) * 100); document.getElementById('course-progress').style.width = `${pct}%`; document.getElementById('progress-text').innerText = `${pct}%`; }
        function updateDropdown() { 
            const select = document.getElementById('lesson-selector'); 
            let html = courseData.map((l, i) => `<option value="${i}" ${i === currentLessonId ? 'selected' : ''}>${i+1}. ${l.title}</option>`).join(''); 
            html += `<option value="-1" ${currentLessonId === -1 ? 'selected' : ''}>Bài kiểm tra Tổng hợp</option>`;
            select.innerHTML = html;
        }
        function switchLessonFromDropdown(val) { 
            const id = parseInt(val);
            if(id === -1) loadComprehensiveLesson();
            else loadLesson(id); 
        }

        function renderNavigation() {
            const container = document.getElementById('lesson-navigation');
            const prev = currentLessonId > 0 ? currentLessonId - 1 : null;
            const next = currentLessonId < courseData.length - 1 ? currentLessonId + 1 : null;
            let html = '<div class="flex-1">';
            if (prev !== null) html += `<button onclick="loadLesson(${prev})" class="flex items-center gap-2 text-slate-500 hover:text-blue-600 font-bold text-sm transition-colors"><i class="fa-solid fa-arrow-left"></i> Mục trước</button>`;
            html += '</div><div class="flex-1 text-right">';
            if (next !== null) html += `<button onclick="loadLesson(${next})" class="flex items-center gap-2 text-blue-600 hover:text-blue-800 font-bold text-sm transition-colors ml-auto">Mục tiếp theo <i class="fa-solid fa-arrow-right"></i></button>`;
            else html += `<button onclick="loadComprehensiveLesson()" class="flex items-center gap-2 text-white bg-indigo-600 hover:bg-indigo-700 px-4 py-2 rounded-lg shadow-md font-bold text-sm transition-all ml-auto animate-pulse">Thi chứng chỉ <i class="fa-solid fa-graduation-cap"></i></button>`;
            html += '</div>';
            container.innerHTML = html;
        }

        function toggleModal(id) {
            const m = document.getElementById(id);
            const content = document.getElementById('cert-content');
            if (m.classList.contains('opacity-0')) { m.classList.remove('opacity-0', 'pointer-events-none'); content.classList.remove('scale-95'); content.classList.add('scale-100'); }
            else { m.classList.add('opacity-0', 'pointer-events-none'); content.classList.remove('scale-100'); content.classList.add('scale-95'); }
            document.body.classList.toggle('modal-active');
        }

        function triggerMegaConfetti() {
            var duration = 3000; var animationEnd = Date.now() + duration; var defaults = { startVelocity: 30, spread: 360, ticks: 60, zIndex: 0 };
            var interval = setInterval(function() {
                var timeLeft = animationEnd - Date.now();
                if (timeLeft <= 0) return clearInterval(interval);
                var particleCount = 50 * (timeLeft / duration);
                confetti(Object.assign({}, defaults, { particleCount, origin: { x: Math.random() * 0.2 + 0.1, y: Math.random() - 0.2 } }));
                confetti(Object.assign({}, defaults, { particleCount, origin: { x: Math.random() * 0.2 + 0.7, y: Math.random() - 0.2 } }));
            }, 250);
        }

        window.onload = init;
    </script>
</body>
</html>
