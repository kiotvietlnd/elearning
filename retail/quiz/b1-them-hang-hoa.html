<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>E-Learning: Bước 1 - Thêm mới hàng hóa - KiotViet</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800;900&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>

    <style>
        body { font-family: 'Inter', sans-serif; background-color: #f0f9ff; overflow-x: hidden; }
        ::-webkit-scrollbar { width: 6px; } ::-webkit-scrollbar-thumb { background: #93c5fd; border-radius: 3px; }
        
        /* Background */
        .soft-glow-background { position: fixed; top: 0; left: 0; width: 100%; height: 100%; z-index: -10; background: linear-gradient(135deg, #ffffff 0%, #e0f2fe 50%, #dcfce7 100%); }
        .soft-glow-background .shape { position: absolute; filter: blur(120px); opacity: 0.6; }
        .soft-glow-background .shape1 { height: 300px; width: 300px; background: #bae6fd; border-radius: 50%; top: -50px; left: -50px; animation: moveInCircle 25s ease-in-out infinite; }
        .soft-glow-background .shape2 { height: 350px; width: 350px; background: #bbf7d0; border-radius: 50%; bottom: -50px; right: -50px; animation: moveVertical 30s ease-in-out infinite; }
        @keyframes moveInCircle { 0% { transform: rotate(0deg); } 50% { transform: rotate(180deg); } 100% { transform: rotate(360deg); } }
        @keyframes moveVertical { 0% { transform: translateY(-20%); } 50% { transform: translateY(20%); } 100% { transform: translateY(-20%); } }

        /* UI Elements */
        .nav-link { transition: all 0.2s ease; border-left: 3px solid transparent; }
        .nav-link:hover { color: #2563eb; background: rgba(255, 255, 255, 0.6); }
        .nav-link.active { color: #1e3a8a; border-left: 3px solid #2563eb; background: #eff6ff; font-weight: 600; box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.05); }

        /* Card Flip */
        .perspective-1000 { perspective: 1000px; }
        .card-inner { position: relative; width: 100%; height: 100%; transition: transform 0.6s cubic-bezier(0.4, 0, 0.2, 1); transform-style: preserve-3d; }
        .card-inner.flipped { transform: rotateY(180deg); }
        .card-face { position: absolute; top: 0; left: 0; width: 100%; height: 100%; -webkit-backface-visibility: hidden; backface-visibility: hidden; border-radius: 1rem; box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1); background-color: white; }
        .card-back { transform: rotateY(180deg); }
        .type-card { transition: all 0.3s ease; }
        .type-card:hover { box-shadow: 0 15px 30px -5px rgba(0, 0, 0, 0.1); transform: translateY(-5px); border-color: #60a5fa; }

        /* Chat */
        .chat-bubble { max-width: 85%; padding: 1rem 1.25rem; border-radius: 1rem; position: relative; font-size: 0.95rem; line-height: 1.6; box-shadow: 0 2px 4px rgba(0,0,0,0.05); }
        .chat-bubble-customer { background-color: #ffffff; color: #334155; border-bottom-left-radius: 0.25rem; margin-left: 3rem; border: 1px solid #e2e8f0; }
        .chat-bubble-consultant { background-color: #eff6ff; color: #1e40af; border-bottom-right-radius: 0.25rem; margin-right: 3rem; border: 1px solid #bfdbfe; }
        .avatar { width: 40px; height: 40px; border-radius: 50%; display: flex; items-center; justify-content: center; position: absolute; bottom: 0; box-shadow: 0 2px 4px rgba(0,0,0,0.1); }
        .avatar-customer { left: -3rem; background: #f8fafc; border: 2px solid #e2e8f0; color: #64748b; }
        .avatar-consultant { right: -3rem; background: #dbeafe; border: 2px solid #3b82f6; color: #2563eb; }
        
        /* Mobile Sidebar Overlay */
        #mobile-overlay { transition: opacity 0.3s ease; }
        #sidebar { transition: transform 0.3s ease; }
        .sidebar-open #sidebar { transform: translateX(0); }
        .sidebar-open #mobile-overlay { opacity: 1; pointer-events: auto; }
        .sidebar-closed #sidebar { transform: translateX(-100%); }
        .sidebar-closed #mobile-overlay { opacity: 0; pointer-events: none; }
        @media (min-width: 768px) { .sidebar-closed #sidebar { transform: translateX(0); } }

        /* Certificate - FIXED STYLE DO NOT CHANGE */
        .certificate-container { box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04); }
        .watermark { position: absolute; top: 50%; left: 60%; transform: translate(-50%, -50%) rotate(-30deg); font-size: 6rem; font-weight: 900; color: rgba(200, 0, 0, 0.05); pointer-events: none; z-index: 0; }
        
        /* Animation */
        .animate-fade-in-up { animation: fadeInUp 0.5s ease-out; }
        @keyframes fadeInUp { from { opacity: 0; transform: translateY(20px); } to { opacity: 1; transform: translateY(0); } }
    </style>
</head>
<body class="text-slate-700 antialiased h-screen flex flex-col overflow-hidden sidebar-closed" id="app-body">
    <div class="soft-glow-background"><div class="shape shape1"></div><div class="shape shape2"></div></div>

    <!-- Header (Standardized) -->
    <header class="sticky top-0 z-50 bg-white/80 backdrop-blur-md border-b border-white/50 h-20 shadow-sm flex-shrink-0">
        <div class="max-w-screen-2xl mx-auto px-4 sm:px-6 lg:px-8 h-full">
            <div class="flex items-center justify-between h-full gap-4 lg:gap-8">
                <!-- LOGO & BRAND -->
                <a href="https://kiotvietlnd.github.io/elearning/" class="flex-shrink-0 flex items-center gap-3 select-none hover:opacity-80 transition-opacity" title="Về trang chủ E-Learning">
                    <img src="https://logo.kiotviet.vn/KiotViet-Logo-Horizontal.svg" alt="KiotViet Logo" class="h-6 lg:h-8">
                    <span class="text-slate-300 font-light text-xl lg:text-2xl">|</span>
                    <!-- RETAIL THEME COLOR -->
                    <span class="font-bold text-transparent bg-clip-text text-blue-700 tracking-tight text-base lg:text-lg uppercase">E-Learning</span>
                </a>

                <!-- DESKTOP NAV -->
                <nav class="hidden lg:flex flex-1 justify-end items-center gap-4">
                    <!-- FIXED BUTTON 1 -->
                    <a href="https://www.kiotviet.vn/ho-tro" target="_blank" class="flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-full font-bold text-sm shadow-md hover:bg-blue-700 hover:-translate-y-0.5 transition-all">
                        <i class="fa-solid fa-book-open-reader"></i> Kho Tài liệu HDSD
                    </a>
                    
                    <!-- FIXED BUTTON 2 -->
                    <a href="https://www.youtube.com/@HDSDPhanmemKiotViet" target="_blank" class="flex items-center gap-2 px-4 py-2 bg-red-600 text-white rounded-full font-bold text-sm shadow-md hover:bg-red-700 hover:-translate-y-0.5 transition-all">
                        <i class="fa-brands fa-youtube"></i> Kho Video HDSD
                    </a>

                    <!-- BUTTON 3: RETAIL THEME -->
                    <a href="#" class="flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-full font-bold text-sm border border-white/20 shadow-lg transform hover:scale-105 transition-all">
                        <i class="fa-solid fa-layer-group"></i> KiotViet Retail
                    </a>
                </nav>
                
                <!-- MOBILE MENU BTN -->
                <div class="lg:hidden">
                    <button onclick="toggleSidebar()" class="text-slate-600 hover:text-blue-700 text-2xl"><i class="fa-solid fa-bars"></i></button>
                </div>
            </div>
        </div>
    </header>

    <!-- Main Container -->
    <div class="flex-1 flex overflow-hidden relative">
        <div id="mobile-overlay" class="fixed inset-0 bg-black/20 z-40 md:hidden" onclick="toggleSidebar()"></div>

        <!-- Sidebar -->
        <aside id="sidebar" class="absolute inset-y-0 left-0 z-50 w-80 bg-white/95 backdrop-blur-xl border-r border-white/60 shadow-2xl md:static md:bg-white/60 md:shadow-lg md:rounded-r-2xl flex flex-col transform transition-transform duration-300">
            <div class="p-5 border-b border-slate-100 flex-shrink-0">
                <div class="flex justify-between items-start mb-4 md:hidden">
                     <img src="https://logo.kiotviet.vn/KiotViet-Logo-Horizontal.svg" alt="Logo" class="h-5">
                     <button onclick="toggleSidebar()" class="text-slate-400"><i class="fa-solid fa-xmark text-xl"></i></button>
                </div>
                <!-- TITLE COLOR MATCHES THEME -->
                <h2 class="font-black text-lg leading-tight mb-2 uppercase text-blue-700">Bước 1: Thêm mới hàng hóa</h2>
                <h3 class="font-bold text-slate-500 text-xs uppercase tracking-wider mb-2">TIẾN ĐỘ BÀI HỌC</h3>
                <div class="w-full bg-slate-200 rounded-full h-2"><div id="totalProgress" class="bg-blue-600 h-2 rounded-full transition-all duration-500" style="width: 0%"></div></div>
                <div class="flex justify-between mt-1 text-[10px] text-slate-500 font-medium"><span id="completedCount">0/0</span><span>Hoàn thành</span></div>
            </div>
            <nav class="flex-1 overflow-y-auto p-3 space-y-2 custom-scrollbar">
                 <button onclick="switchTab('cheatsheet')" id="nav-cheatsheet" class="nav-link w-full text-left px-3 py-3 rounded-lg flex items-center gap-3 active"><i class="fa-solid fa-bolt text-yellow-500 w-6 text-center"></i><span class="font-bold text-sm">Cẩm nang nghiệp vụ</span></button>
                 <div class="mt-4 mb-2 px-3 text-[10px] font-bold text-slate-400 uppercase">Nội dung Demo</div>
                 
                 <!-- DYNAMIC TABS PLACEHOLDER -->
                 <div id="dynamic-nav-container"></div>
                 
                 <div class="mt-4 mb-2 px-3 text-[10px] font-bold text-slate-400 uppercase">Ôn tập</div>
                 <button onclick="switchTab('summary')" id="nav-summary" class="nav-link w-full text-left px-3 py-3 rounded-lg flex items-center gap-3"><i class="fa-solid fa-table-columns text-purple-500 w-6 text-center"></i><span class="font-bold text-sm">Bảng so sánh</span></button>
                 <button onclick="switchTab('game')" id="nav-game" class="nav-link w-full text-left px-3 py-3 rounded-lg flex items-center gap-3"><i class="fa-solid fa-gamepad text-orange-500 w-6 text-center"></i><span class="font-bold text-sm">Quiz Game</span></button>
            </nav>
            <div class="p-4 bg-slate-50 border-t border-slate-100 text-center text-[10px] text-slate-400">© KiotViet Learning & Development Department</div>
        </aside>

        <!-- Content Area -->
        <main class="flex-1 overflow-y-auto scroll-smooth p-4 md:p-8" id="contentArea">
            <div class="max-w-5xl mx-auto pb-20" id="lessonContainer">
                
                <!-- CHEATSHEET CONTENT -->
                <div id="tab-cheatsheet" class="tab-content block animate-fade-in-up">
                    <div class="mb-8 text-center">
                         <span class="bg-blue-100 text-blue-700 px-3 py-1 rounded-full text-xs font-bold uppercase tracking-wider border border-blue-200">Đào tạo Sản phẩm KiotViet Retail</span>
                        <h1 class="text-3xl md:text-4xl font-black text-blue-700 mt-4 leading-tight">Bước 1: Thêm mới hàng hóa</h1>
                        <p class="text-slate-500 mt-3 italic text-base md:text-lg max-w-2xl mx-auto">Tạo nền tảng dữ liệu chuẩn xác - Bước khởi đầu quan trọng nhất cho mọi hoạt động kinh doanh.</p>
                    </div>
                    
                    <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-10">
                        <div class="bg-white p-6 rounded-2xl shadow-sm border border-slate-100 hover:shadow-md transition">
                            <div class="w-12 h-12 bg-blue-100 rounded-full flex items-center justify-center mb-4"><i class="fa-solid fa-database text-blue-600 text-xl"></i></div>
                            <h3 class="font-bold text-lg text-slate-800 mb-2">Nền tảng chuẩn xác</h3>
                            <p class="text-sm text-slate-600">Dữ liệu hàng hóa chính xác là gốc rễ của mọi báo cáo doanh thu và lợi nhuận.</p>
                        </div>
                        <div class="bg-white p-6 rounded-2xl shadow-sm border border-slate-100 hover:shadow-md transition">
                            <div class="w-12 h-12 bg-green-100 rounded-full flex items-center justify-center mb-4"><i class="fa-solid fa-boxes-stacked text-green-600 text-xl"></i></div>
                            <h3 class="font-bold text-lg text-slate-800 mb-2">Kiểm soát chặt chẽ</h3>
                            <p class="text-sm text-slate-600">Nắm bắt chính xác tồn kho ban đầu ngay khi tạo hàng để tránh thất thoát về sau.</p>
                        </div>
                        <div class="bg-white p-6 rounded-2xl shadow-sm border border-slate-100 hover:shadow-md transition">
                            <div class="w-12 h-12 bg-purple-100 rounded-full flex items-center justify-center mb-4"><i class="fa-solid fa-sitemap text-purple-600 text-xl"></i></div>
                            <h3 class="font-bold text-lg text-slate-800 mb-2">Quản lý thông minh</h3>
                            <p class="text-sm text-slate-600">Một mã hàng bao quát được nhiều đơn vị (Thùng/Lốc) và thuộc tính (Màu/Vị).</p>
                        </div>
                    </div>

                    <div class="bg-white rounded-2xl shadow-lg border border-slate-200 overflow-hidden">
                        <div class="bg-gradient-to-r from-blue-600 to-blue-800 p-4 text-white font-bold text-lg flex items-center gap-2"><i class="fa-solid fa-list-check"></i> Quy trình 4 bước thực hiện (Sales Demo)</div>
                        <div class="p-6 md:p-8">
                            <ol class="relative border-l border-blue-200 space-y-8 ml-3">                  
                                <li class="ml-8">
                                    <span class="absolute flex items-center justify-center w-8 h-8 bg-blue-100 rounded-full -left-4 ring-4 ring-white">
                                        <i class="fa-solid fa-1 text-blue-600 text-xs"></i>
                                    </span>
                                    <h3 class="font-bold text-lg text-slate-800 mb-1">Truy cập tính năng</h3>
                                    <p class="text-slate-600 text-sm">Vào menu <b>Hàng hóa</b> -> Chọn <b>Danh sách hàng hóa</b> -> Nhấn nút <b>+Tạo mới</b> -> Chọn <b>Hàng hóa</b>.</p>
                                </li>
                                <li class="ml-8">
                                    <span class="absolute flex items-center justify-center w-8 h-8 bg-blue-100 rounded-full -left-4 ring-4 ring-white">
                                        <i class="fa-solid fa-2 text-blue-600 text-xs"></i>
                                    </span>
                                    <h3 class="font-bold text-lg text-slate-800 mb-1">Nhập thông tin cơ bản</h3>
                                    <p class="text-slate-600 text-sm">Điền Tên hàng, Giá vốn, Giá bán. Nhập đúng số lượng <b>Tồn kho</b> thực tế (Mã hàng để tự sinh hoặc quét mã vạch).</p>
                                </li>
                                <li class="ml-8">
                                    <span class="absolute flex items-center justify-center w-8 h-8 bg-blue-100 rounded-full -left-4 ring-4 ring-white">
                                        <i class="fa-solid fa-3 text-blue-600 text-xs"></i>
                                    </span>
                                    <h3 class="font-bold text-lg text-slate-800 mb-1">Thiết lập nâng cao</h3>
                                    <p class="text-slate-600 text-sm">Nhấn nút <b>Thiết lập</b> (tại mục Quản lý ĐVT & Thuộc tính). Khai báo tỷ lệ Quy đổi (Lốc=4, Thùng=48) và Thuộc tính (Dâu, Vani).</p>
                                </li>
                                <li class="ml-8">
                                    <span class="absolute flex items-center justify-center w-8 h-8 bg-green-100 rounded-full -left-4 ring-4 ring-white">
                                        <i class="fa-solid fa-check text-green-600 text-xs"></i>
                                    </span>
                                    <h3 class="font-bold text-lg text-slate-800 mb-1">Hoàn tất</h3>
                                    <p class="text-slate-600 text-sm">Kiểm tra danh sách các phiên bản chi tiết và nhấn nút <b>Lưu</b> để hoàn tất tạo hàng.</p>
                                </li>
                            </ol>
                        </div>
                    </div>
                </div>

                <!-- LESSON TABS WILL BE INJECTED HERE -->

                <!-- SUMMARY TAB -->
                <div id="tab-summary" class="tab-content hidden animate-fade-in-up">
                    <h2 class="text-xl font-bold text-blue-700 mb-6 border-l-4 border-slate-400 pl-3">Bảng so sánh: Lầm tưởng & Sự thật</h2>
                    <div class="bg-white rounded-xl shadow-lg border border-slate-200 overflow-hidden">
                        <table class="w-full table-fixed border-collapse">
                            <thead>
                                <tr class="bg-slate-100 text-slate-600 text-sm uppercase tracking-wider">
                                    <th class="w-16 py-4 border-r border-slate-200 text-center">#</th>
                                    <th class="w-[45%] py-4 border-r border-slate-200 text-center text-red-600 bg-red-50/50">Lầm tưởng (Sai)</th>
                                    <th class="w-[45%] py-4 text-center text-green-600 bg-green-50/50">Sự thật (Đúng)</th>
                                </tr>
                            </thead>
                            <tbody id="summaryTableBody" class="text-sm"></tbody>
                        </table>
                    </div>
                </div>

                <!-- Game & Certificate -->
                <div id="tab-game" class="tab-content hidden animate-fade-in-up">
                    <!-- Start Screen -->
                    <div id="game-start" class="text-center py-20 bg-white/60 backdrop-blur rounded-3xl border border-white/50 shadow-xl">
                        <div class="inline-block p-6 rounded-full bg-orange-100 mb-6 animate-bounce"><i class="fa-solid fa-gamepad text-5xl md:text-6xl text-orange-500"></i></div>
                        <h2 class="text-2xl md:text-3xl font-black text-slate-800 mb-4 tracking-tight">Quiz Game: Bậc Thầy Hàng Hóa</h2>
                        <p class="text-slate-600 mb-6 max-w-lg mx-auto leading-relaxed text-sm md:text-base">Hệ thống sẽ hiển thị ngẫu nhiên các nhận định về quy trình thêm mới hàng hóa. Bạn hãy xác định nó ĐÚNG hay SAI.<br><strong>Đạt 80% để nhận Chứng chỉ.</strong></p>
                        
                        <div class="mb-8 flex justify-center">
                            <input type="text" id="player-name" placeholder="Nhập tên của bạn để in lên chứng chỉ..." class="px-5 py-3 rounded-lg border border-slate-300 w-full max-w-md focus:outline-none focus:ring-2 focus:ring-blue-400 focus:border-transparent text-center font-medium shadow-inner">
                        </div>

                        <div class="grid grid-cols-1 md:grid-cols-3 gap-3 max-w-3xl mx-auto">
                            <button id="btn-mode-standard" onclick="startGame('standard')" class="bg-white border border-blue-200 text-blue-700 px-4 py-3 rounded-lg font-bold hover:bg-blue-50 transition transform hover:scale-105 shadow-sm text-sm"><div class="text-base mb-1">Tiêu Chuẩn</div><div class="text-xs font-normal text-slate-500">5 Câu hỏi ngẫu nhiên</div></button>
                            <button id="btn-mode-pro" onclick="startGame('pro')" class="bg-white border border-purple-200 text-purple-700 px-4 py-3 rounded-lg font-bold hover:bg-purple-50 transition transform hover:scale-105 shadow-sm text-sm"><div class="text-base mb-1">Pro</div><div class="text-xs font-normal text-slate-500">10 Câu hỏi ngẫu nhiên</div></button>
                            <button id="btn-mode-promax" onclick="startGame('promax')" class="bg-gradient-to-r from-orange-500 to-red-500 text-white px-4 py-3 rounded-lg font-bold shadow-lg hover:shadow-orange-200 hover:scale-105 transition transform border-2 border-white/20 text-sm"><div class="text-base mb-1" id="btn-promax-text">Promax (Full)</div><div class="text-xs font-normal text-white/80">Toàn bộ câu hỏi</div></button>
                        </div>
                    </div>

                    <!-- Playing Screen -->
                    <div id="game-playing" class="hidden max-w-2xl mx-auto py-6">
                        <div class="flex justify-between items-center mb-6 px-2">
                            <div class="text-slate-400 font-bold uppercase text-xs tracking-wider">Câu hỏi: <span id="q-progress" class="text-blue-600 text-base">1/10</span></div>
                            <div class="text-xs font-bold bg-white px-3 py-1.5 rounded-full border border-slate-200 shadow-sm text-slate-600">Score: <span id="current-score" class="text-green-600">0</span></div>
                        </div>
                        <div id="game-card" class="bg-white rounded-3xl shadow-xl p-8 min-h-[220px] flex items-center justify-center text-center border border-slate-100 mb-6 relative overflow-hidden transition-all">
                            <div class="absolute top-0 left-0 w-full h-2 bg-gradient-to-r from-blue-400 to-green-400"></div>
                            <h3 id="question-text" class="text-lg md:text-xl font-extrabold text-slate-800 leading-snug">Loading...</h3>
                        </div>
                        <div class="grid grid-cols-2 gap-4">
                            <button id="btn-true" onclick="answerGame(true)" class="py-3 md:py-4 rounded-2xl bg-white border-2 border-green-100 hover:border-green-500 hover:bg-green-50 text-green-600 font-bold text-base md:text-xl shadow-sm hover:shadow-lg transition-all transform active:scale-95 group"><i class="fa-solid fa-check-circle mb-1 block text-xl md:text-2xl group-hover:scale-110 transition-transform"></i> ĐÚNG</button>
                            <button id="btn-false" onclick="answerGame(false)" class="py-3 md:py-4 rounded-2xl bg-white border-2 border-red-100 hover:border-red-500 hover:bg-red-50 text-red-600 font-bold text-base md:text-xl shadow-sm hover:shadow-lg transition-all transform active:scale-95 group"><i class="fa-solid fa-times-circle mb-1 block text-xl md:text-2xl group-hover:scale-110 transition-transform"></i> SAI</button>
                        </div>
                    </div>
                    
                    <!-- Result Screen -->
                    <div id="game-result" class="hidden flex flex-col items-center">
                        <div id="certificate" class="w-full max-w-4xl aspect-video bg-white shadow-2xl flex overflow-hidden certificate-container mx-auto">
                            <!-- FIXED BLUE THEME FOR CERTIFICATE -->
                            <div class="w-1/3 bg-blue-900 flex flex-col items-center justify-center text-white p-6 relative">
                                <div class="mb-6"><i class="fa-solid fa-award text-6xl text-yellow-400"></i></div>
                                <div class="text-center z-10"><p class="uppercase tracking-widest text-[10px] opacity-70 mb-1">Cấp bởi</p><p class="font-bold text-sm leading-tight">KiotViet LND Department</p></div>
                                <div class="absolute bottom-0 left-0 w-full h-2 bg-green-500"></div><div class="absolute top-0 right-0 w-2 h-full bg-black/10"></div>
                            </div>
                            <div class="w-2/3 p-8 md:p-12 flex flex-col justify-center relative bg-white">
                                <div id="fail-watermark" class="watermark hidden">CHƯA ĐẠT</div>
                                <h1 class="text-3xl md:text-4xl font-black text-blue-900 uppercase mb-1 font-sans tracking-tight">GIẤY CHỨNG NHẬN</h1>
                                <p class="text-slate-500 italic text-sm mb-6 border-b border-slate-100 pb-4">Đã hoàn thành xuất sắc nội dung đào tạo nghiệp vụ</p>
                                <div class="space-y-1 mb-6"><p class="text-[10px] text-slate-400 uppercase font-bold tracking-wider">Trao tặng cho:</p><h2 class="text-2xl md:text-3xl font-bold text-blue-700 uppercase leading-tight" id="certificate-name">NGUYỄN VĂN A</h2></div>
                                <div class="space-y-1 mb-6"><p class="text-[10px] text-slate-400 uppercase font-bold tracking-wider">Học phần:</p><h3 class="text-xl font-bold text-slate-800 uppercase">Bước 1: Thêm mới hàng hóa</h3></div>
                                <div class="flex justify-between items-end mt-auto pt-4 border-t border-slate-100">
                                    <div><p class="text-[10px] text-slate-400 uppercase font-bold">Ngày hoàn thành</p><p class="text-sm font-medium text-slate-600" id="cert-date">12/01/2026</p></div>
                                    <div class="text-right"><p class="text-[10px] text-slate-400 uppercase font-bold">Điểm số</p><p class="text-xl font-black text-green-600" id="final-score-cert">100%</p></div>
                                </div>
                            </div>
                        </div>

                        <div id="fail-message-container" class="hidden mt-6 bg-red-50 px-6 py-4 rounded-xl border border-red-100 text-center">
                            <p class="text-red-600 font-bold"><i class="fa-solid fa-triangle-exclamation mr-2"></i>Chưa đạt yêu cầu nhận chứng nhận (Cần >80%)</p>
                            <p class="text-sm text-slate-600 mt-1">Hãy ôn lại kiến thức và thử lại nhé!</p>
                        </div>

                        <div class="flex flex-wrap justify-center gap-4 mt-8 mb-12">
                            <button onclick="playAgain()" class="bg-white border-2 border-blue-600 text-blue-700 px-6 py-3 rounded-full font-bold shadow-sm hover:bg-blue-50 transition"><i class="fa-solid fa-rotate-right mr-2"></i> Chơi lại</button>
                            <button onclick="switchTab('cheatsheet')" class="bg-white border border-slate-200 text-slate-700 px-6 py-3 rounded-full font-bold shadow hover:bg-slate-50 transition flex items-center gap-2"><i class="fa-solid fa-bolt text-yellow-500"></i> Xem Cẩm nang</button>
                            <button id="btn-download" onclick="downloadCertificate()" class="bg-blue-600 text-white px-8 py-3 rounded-full font-bold shadow-lg hover:bg-blue-700 transition hidden"><i class="fa-solid fa-download mr-2"></i> Tải chứng nhận</button>
                        </div>

                        <div class="max-w-4xl mx-auto bg-white rounded-2xl shadow-lg border border-slate-200 overflow-hidden w-full">
                            <h3 class="text-xl font-bold text-blue-900 px-6 py-4 bg-slate-50 border-b border-slate-100">Chi tiết kết quả</h3>
                            <table class="min-w-full divide-y divide-slate-100">
                                <thead class="bg-white">
                                    <tr>
                                        <th class="px-6 py-4 text-center text-xs font-bold text-slate-500 uppercase">Câu hỏi</th>
                                        <th class="px-6 py-4 text-center text-xs font-bold text-slate-500 uppercase w-32">Bạn chọn</th>
                                        <th class="px-6 py-4 text-center text-xs font-bold text-slate-500 uppercase w-40">Kết quả</th>
                                    </tr>
                                </thead>
                                <tbody id="review-body" class="bg-white divide-y divide-slate-100 text-sm"></tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>
        </main>
    </div>
    
    <script>
        // DATA: LESSON CONTENT (RETAIL SALES DEMO)
        const lessonData = [
            {
                id: 1,
                title: "1. Khởi tạo & Thông tin cơ bản",
                icon: "fa-solid fa-power-off",
                chat: [
                    { role: "consultant", text: "Chào anh ạ! Như đã trao đổi về khó khăn quản lý kho mà anh đang gặp phải, hôm nay em xin phép demo quy trình 6 bước chuẩn trên KiotViet. Chúng ta bắt đầu với <b>Bước 1: Thêm mới hàng hóa</b> nhé." },
                    { role: "customer", text: "Ừ được, anh cũng đang ngại nhất khâu này đây. Hàng hóa nhiều nhập bao giờ mới xong." },
                    { role: "consultant", text: "Anh yên tâm. Từ menu <b>Hàng hóa</b>, anh chọn <b>Danh sách hàng hóa</b>, sau đó nhấn nút <b>+Tạo mới</b> màu xanh ở góc phải và chọn <b>Hàng hóa</b>." },
                    { role: "customer", text: "Rồi, giao diện hiện ra rồi. Giờ nhập 'Sữa tươi Ba Vì' vào đâu em?" },
                    { role: "consultant", text: "Anh điền vào ô <b>Tên hàng</b>. Ô <b>Mã hàng</b> anh cứ để trống để hệ thống tự sinh mã, hoặc dùng máy quét tít vào mã vạch trên hộp là xong ạ." },
                    { role: "consultant", text: "Quan trọng nhất, anh điền giúp em số lượng thực tế vào ô <b>Tồn kho</b>. Đây là cơ sở để phần mềm báo cáo chính xác ngay từ hôm nay." }
                ],
                cards: [
                    { 
                        id: 101, 
                        isTrue: false, 
                        question: "Để tạo hàng hóa mới, phải vào phần Thiết lập hệ thống rất phức tạp.", 
                        wrong: "Để tạo hàng hóa mới, phải vào phần Thiết lập hệ thống rất phức tạp.",
                        right: "Truy cập nhanh từ menu Hàng hóa -> Danh sách hàng hóa -> +Tạo mới." 
                    },
                    { 
                        id: 102, 
                        isTrue: false, 
                        question: "Bắt buộc phải tự nghĩ ra và nhập Mã hàng thủ công cho từng sản phẩm.", 
                        wrong: "Bắt buộc phải tự nghĩ ra và nhập Mã hàng thủ công cho từng sản phẩm.",
                        right: "Hệ thống tự động sinh Mã hoặc hỗ trợ quét mã vạch có sẵn trên bao bì." 
                    },
                    { 
                        id: 103, 
                        isTrue: true, 
                        question: "Bắt buộc nhập Tồn kho ban đầu để hệ thống có dữ liệu tính toán xuất-nhập.", 
                        wrong: "Có thể bỏ qua việc nhập số lượng tồn kho lúc tạo mới và cập nhật sau.",
                        right: "Nhập tồn kho ban đầu là mốc thời gian cực kỳ quan trọng để kiểm soát thất thoát." 
                    }
                ]
            },
            {
                id: 2,
                title: "2. Đơn vị tính & Thuộc tính",
                icon: "fa-solid fa-cubes",
                chat: [
                    { role: "customer", text: "Sữa này anh nhập Thùng, bán lẻ Hộp, khách mua Lốc 4 hộp cũng có. Chẳng lẽ phải tạo 3 mã hàng à?" },
                    { role: "consultant", text: "Không cần đâu anh. Anh tìm mục <b>Quản lý theo đơn vị tính và thuộc tính</b>, nhấn nút <b>Thiết lập</b>. Tại đây, anh điền đơn vị cơ bản là 'Hộp'. Bấm <b>Thêm đơn vị</b>, nhập 'Lốc' (Quy đổi 4), và 'Thùng' (Quy đổi 48)." },
                    { role: "customer", text: "Hay quá. Thế còn vị Dâu với Vani? Nhập chung vào đây được không?" },
                    { role: "consultant", text: "Được chứ anh. Ngay bên cạnh là ô <b>Thuộc tính</b>. Anh gõ tên là 'Hương vị', sau đó nhập 'Dâu' Enter, 'Vani' Enter. Hệ thống sẽ tự chia thành các phiên bản con." },
                    { role: "customer", text: "À, nó hiện ra danh sách chi tiết bên dưới rồi này. Rất rõ ràng." },
                    { role: "consultant", text: "Dạ đúng rồi. Kiểm tra xong, anh nhấn nút <b>Lưu</b> là hoàn tất. Vậy là ta đã xong Bước 1, có dữ liệu để bán hàng rồi ạ." }
                ],
                cards: [
                    { 
                        id: 201, 
                        isTrue: false, 
                        question: "Muốn bán sản phẩm theo Hộp, Lốc, Thùng thì phải tạo 3 mã hàng riêng biệt.", 
                        wrong: "Muốn bán sản phẩm theo Hộp, Lốc, Thùng thì phải tạo 3 mã hàng riêng biệt.",
                        right: "Dùng tính năng 'Đơn vị tính' để quản lý quy đổi (Lốc=4 Hộp) trên cùng 1 mã hàng." 
                    },
                    { 
                        id: 202, 
                        isTrue: true, 
                        question: "Có thể thiết lập giá bán khác nhau cho từng đơn vị tính (Giá sỉ cho Thùng, giá lẻ cho Hộp).", 
                        wrong: "Giá bán quy đổi bắt buộc phải bằng giá đơn vị cơ bản nhân với tỷ lệ quy đổi.",
                        right: "Hệ thống cho phép cài đặt giá bán linh hoạt cho từng đơn vị quy đổi." 
                    },
                    { 
                        id: 203, 
                        isTrue: true, 
                        question: "Dùng tính năng 'Thuộc tính' để quản lý các biến thể như Màu sắc, Hương vị trong 1 sản phẩm.", 
                        wrong: "Các biến thể màu sắc, hương vị bắt buộc phải tạo thành các mã hàng riêng biệt.",
                        right: "Thuộc tính giúp tạo ra các phiên bản con (Size/Màu/Vị) gọn gàng trong 1 mã hàng mẹ." 
                    }
                ]
            }
        ];

        // LOGIC CHUNG
        let gameQuestions = [], currentIndex = 0, score = 0, playerName = "HỌC VIÊN", completedCards = new Set();
        let isNavRendered = false;

        function toggleSidebar() { document.body.classList.toggle('sidebar-closed'); document.body.classList.toggle('sidebar-open'); }
        
        function switchTab(tabId) {
            document.querySelectorAll('.tab-content').forEach(el => el.classList.add('hidden'));
            const target = document.getElementById('tab-' + tabId);
            if(target) target.classList.remove('hidden');
            
            document.querySelectorAll('.nav-link').forEach(el => { 
                el.classList.remove('active', 'bg-blue-50', 'text-blue-900', 'border-blue-600'); 
                el.classList.add('text-slate-700'); 
            });
            const btn = document.getElementById('nav-' + tabId); 
            if(btn) { btn.classList.add('active'); btn.classList.remove('text-slate-700'); }
            
            if(window.innerWidth < 768) { document.body.classList.add('sidebar-closed'); document.body.classList.remove('sidebar-open'); }
            document.getElementById('contentArea').scrollTop = 0;
            if(tabId === 'summary') renderSummary();
        }

        // JS LOGIC: RENDER NAV & CONTENTS
        function renderNav() {
             if (isNavRendered) return;
             const container = document.getElementById('dynamic-nav-container');
             let totalQ = 0;
             lessonData.forEach(topic => {
                 totalQ += topic.cards.length;
                 const btn = document.createElement('button');
                 btn.onclick = () => switchTab(`topic-${topic.id}`);
                 btn.id = `nav-topic-${topic.id}`;
                 btn.className = 'nav-link w-full text-left px-3 py-3 rounded-lg flex items-center gap-3 text-slate-700';
                 btn.innerHTML = `<i class="${topic.icon} text-blue-500 w-6 text-center"></i><span class="font-bold text-sm truncate">${topic.title}</span>`;
                 container.appendChild(btn);
                 
                 // Create Content Section
                 const contentDiv = document.createElement('div');
                 contentDiv.id = `tab-topic-${topic.id}`;
                 contentDiv.className = 'tab-content hidden animate-fade-in-up';
                 
                 // Generate Chat HTML
                 const chatHTML = topic.chat.map(c => `
                    <div class="mb-6 flex relative ${c.role === 'customer' ? 'justify-start' : 'justify-end'}">
                        <div class="avatar ${c.role === 'customer' ? 'avatar-customer left-0' : 'avatar-consultant right-0'}">
                            <i class="fa-solid ${c.role === 'customer' ? 'fa-user' : 'fa-headset'}"></i>
                        </div>
                        <div class="chat-bubble ${c.role === 'customer' ? 'chat-bubble-customer' : 'chat-bubble-consultant'}">
                            <div class="text-[10px] font-bold uppercase mb-1 opacity-70">${c.role === 'consultant' ? 'Chuyên viên KiotViet' : 'Chủ cửa hàng'}</div>
                            ${c.text}
                        </div>
                    </div>
                 `).join('');

                 // Generate Cards HTML
                 const cardsHTML = topic.cards.map(card => `
                    <div class="h-64 w-full perspective-1000 group cursor-pointer" onclick="flipCard(${card.id}, true)" id="card-container-${card.id}">
                        <div class="card-inner w-full h-full duration-500">
                            <div class="card-face p-6 flex flex-col justify-between items-center text-center border-2 border-slate-100 type-card bg-white">
                                <div class="w-12 h-12 bg-blue-50 rounded-full flex items-center justify-center text-blue-600 font-bold text-lg mb-2">${card.id}</div>
                                <h3 class="font-bold text-slate-700 text-lg leading-snug">${card.question}</h3>
                                <div class="mt-4 flex gap-3 w-full">
                                    <button onclick="event.stopPropagation(); flipCard(${card.id}, true)" class="flex-1 py-2 bg-green-50 text-green-600 rounded-lg font-bold hover:bg-green-100 transition text-sm">ĐÚNG</button>
                                    <button onclick="event.stopPropagation(); flipCard(${card.id}, false)" class="flex-1 py-2 bg-red-50 text-red-600 rounded-lg font-bold hover:bg-red-100 transition text-sm">SAI</button>
                                </div>
                                <div class="absolute top-2 right-2 text-slate-300"><i class="fa-solid fa-rotate"></i></div>
                            </div>
                            <div class="card-face card-back"></div>
                        </div>
                    </div>
                 `).join('');

                 contentDiv.innerHTML = `
                    <div class="flex items-center gap-3 mb-6">
                        <div class="p-3 bg-blue-100 rounded-xl"><i class="${topic.icon} text-blue-600 text-2xl"></i></div>
                        <h2 class="text-2xl font-black text-slate-800">${topic.title}</h2>
                    </div>
                    
                    <div class="flex flex-col gap-8 mb-12">
                        <!-- Chat Section -->
                        <div class="bg-white rounded-2xl shadow-sm border border-slate-200 p-6 relative">
                             <div class="border-b border-slate-100 pb-4 mb-4 flex justify-between items-center">
                                <h3 class="font-bold text-slate-500 uppercase text-xs tracking-wider">Hội thoại mẫu</h3>
                                <span class="text-xs bg-green-100 text-green-700 px-2 py-0.5 rounded">Tình huống giả định</span>
                             </div>
                             <div class="py-2 max-h-[400px] overflow-y-auto custom-scrollbar pr-2">${chatHTML}</div>
                        </div>
                        
                        <!-- Cards Section -->
                        <div>
                             <div class="mb-4 flex justify-between items-end">
                                <h3 class="font-bold text-slate-700 flex items-center gap-2"><i class="fa-solid fa-layer-group text-blue-500"></i> Kiểm tra nhanh kiến thức</h3>
                                <span class="text-xs text-slate-400">Chọn Đúng/Sai để lật thẻ</span>
                             </div>
                             <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-5">${cardsHTML}</div>
                        </div>
                    </div>
                 `;
                 
                 document.getElementById('lessonContainer').insertBefore(contentDiv, document.getElementById('tab-summary'));
             });
             
             document.getElementById('btn-promax-text').innerText = `Promax (${totalQ} câu)`;
             
             // Hide Pro mode if questions < 10
             if (totalQ < 10) {
                 const proBtn = document.getElementById('btn-mode-pro');
                 if (proBtn) proBtn.style.display = 'none';
                 
                 // Adjust Grid to 2 columns if Pro is hidden
                 const btnContainer = document.querySelector('#game-start .grid');
                 if (btnContainer) btnContainer.classList.replace('md:grid-cols-3', 'md:grid-cols-2');
             }

             isNavRendered = true;
        }

        function renderSummary() {
            const tbody = document.getElementById('summaryTableBody');
            let allCards = [];
            lessonData.forEach(t => allCards.push(...t.cards));
            tbody.innerHTML = allCards.map((item, idx) => `
                <tr class="hover:bg-slate-50 border-b border-slate-50 last:border-0">
                    <td class="px-4 py-3 text-slate-400 font-bold text-center align-top">${idx+1}</td>
                    <td class="px-4 py-3 text-slate-600 bg-red-50/30 border-r border-slate-100 align-top">
                        <div class="flex gap-2"><i class="fa-solid fa-xmark text-red-500 mt-1 flex-shrink-0"></i><span class="text-sm">${item.wrong}</span></div>
                    </td>
                    <td class="px-4 py-3 text-slate-800 bg-green-50/30 align-top font-medium">
                        <div class="flex gap-2"><i class="fa-solid fa-check text-green-500 mt-1 flex-shrink-0"></i><span class="text-sm">${item.right}</span></div>
                    </td>
                </tr>
            `).join('');
        }

        // FLIP CARD LOGIC
        function flipCard(id, choice) {
            const container = document.getElementById(`card-container-${id}`);
            const inner = container.querySelector('.card-inner');
            const backFace = container.querySelector('.card-back');
            
            let item;
            lessonData.forEach(t => { const found = t.cards.find(c => c.id === id); if(found) item = found; });
            
            const isCorrect = (choice === item.isTrue);
            
            const resultHeader = isCorrect 
                ? '<div class="mb-2 font-bold text-lg text-green-600 flex items-center justify-center gap-2"><i class="fa-solid fa-check-circle"></i> Chính xác!</div>' 
                : '<div class="mb-2 font-bold text-lg text-red-600 flex items-center justify-center gap-2"><i class="fa-solid fa-times-circle"></i> Chưa chính xác!</div>';
            
            const badgeClass = item.isTrue ? 'bg-green-100 text-green-700 border-green-200' : 'bg-red-100 text-red-700 border-red-200';
            const badgeText = item.isTrue ? 'MỆNH ĐỀ ĐÚNG' : 'MỆNH ĐỀ SAI';
            const backBorderClass = isCorrect ? 'border-green-200 bg-green-50' : 'border-red-200 bg-red-50';

            backFace.className = `card-face card-back p-5 border-2 flex flex-col rounded-2xl text-center ${backBorderClass}`;
            backFace.innerHTML = `
                <div class="flex flex-col h-full overflow-y-auto custom-scrollbar">
                    ${resultHeader}
                    <div class="mb-4"><span class="px-3 py-1 rounded-full text-[10px] font-bold border ${badgeClass}">${badgeText}</span></div>
                    <div class="bg-white p-4 rounded-xl border border-blue-100 shadow-sm text-left flex-1">
                        <p class="text-xs text-blue-600 font-bold uppercase mb-2 flex items-center gap-2"><i class="fa-solid fa-lightbulb"></i> Sự thật là:</p>
                        <p class="text-slate-700 text-sm leading-relaxed font-medium">${item.right}</p>
                    </div>
                    <button onclick="event.stopPropagation(); resetCard(${item.id})" class="mt-4 text-xs text-slate-400 font-bold hover:text-blue-600 uppercase tracking-wider flex items-center justify-center gap-1"><i class="fa-solid fa-rotate-left"></i> Xem lại câu hỏi</button>
                </div>`;
            
            inner.classList.add('flipped');
            if (!completedCards.has(id)) { completedCards.add(id); updateProgress(); }
        }

        function resetCard(id) { document.getElementById(`card-container-${id}`).querySelector('.card-inner').classList.remove('flipped'); }
        
        function updateProgress() { 
            let totalCards = 0; lessonData.forEach(t => totalCards += t.cards.length);
            document.getElementById('totalProgress').style.width = `${(completedCards.size / totalCards) * 100}%`; 
            document.getElementById('completedCount').innerText = `${completedCards.size}/${totalCards}`; 
        }

        // GAME LOGIC
        function startGame(mode) {
            const nameInput = document.getElementById('player-name').value.trim();
            playerName = nameInput || "HỌC VIÊN";
            
            let allQ = [];
            lessonData.forEach(t => allQ.push(...t.cards));
            
            if (mode === 'standard') gameQuestions = allQ.sort(() => 0.5 - Math.random()).slice(0, 5);
            else if (mode === 'pro') gameQuestions = allQ.sort(() => 0.5 - Math.random()).slice(0, 10);
            else gameQuestions = allQ;

            currentIndex = 0; score = 0;
            document.getElementById('game-start').classList.add('hidden');
            document.getElementById('game-playing').classList.remove('hidden');
            document.getElementById('game-result').classList.add('hidden');
            loadQuestion();
        }

        function loadQuestion() {
            // Guard clause to prevent undefined access
            if (currentIndex >= gameQuestions.length) {
                endGame();
                return;
            }
            
            const q = gameQuestions[currentIndex];
            if (!q) {
                endGame();
                return;
            }

            document.getElementById('q-progress').innerText = `${currentIndex + 1}/${gameQuestions.length}`;
            document.getElementById('current-score').innerText = score;
            document.getElementById('question-text').innerText = q.question;
            
            // Re-enable buttons
            const btns = document.querySelectorAll('#game-playing button');
            btns.forEach(btn => {
                btn.disabled = false;
                btn.classList.remove('opacity-50', 'cursor-not-allowed');
            });
        }

        function answerGame(choice) {
            // Disable buttons immediately to prevent double submission
            const btns = document.querySelectorAll('#game-playing button');
            btns.forEach(btn => {
                btn.disabled = true;
                btn.classList.add('opacity-50', 'cursor-not-allowed');
            });

            const q = gameQuestions[currentIndex];
            const isCorrect = (choice === q.isTrue);
            
            const row = `
                <tr class="${isCorrect ? 'bg-green-50' : 'bg-red-50'}">
                    <td class="px-6 py-4 text-slate-700">${q.question}</td>
                    <td class="px-6 py-4 text-center font-bold ${choice ? 'text-green-600' : 'text-red-600'}">${choice ? 'ĐÚNG' : 'SAI'}</td>
                    <td class="px-6 py-4 text-center">
                        ${isCorrect ? '<span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-green-100 text-green-800">Chính xác</span>' : '<span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-red-100 text-red-800">Sai</span>'}
                    </td>
                </tr>
            `;
            document.getElementById('review-body').insertAdjacentHTML('beforeend', row);

            if (isCorrect) {
                score += 10;
                confetti({ particleCount: 50, spread: 60, origin: { y: 0.7 } });
            }

            currentIndex++;
            if (currentIndex < gameQuestions.length) {
                setTimeout(loadQuestion, 500);
            } else {
                endGame();
            }
        }

        function endGame() {
            document.getElementById('game-playing').classList.add('hidden');
            document.getElementById('game-result').classList.remove('hidden');
            
            const maxScore = gameQuestions.length * 10;
            const percent = maxScore > 0 ? Math.round((score / maxScore) * 100) : 0;
            
            document.getElementById('certificate-name').innerText = playerName;
            document.getElementById('final-score-cert').innerText = `${percent}%`;
            document.getElementById('cert-date').innerText = new Date().toLocaleDateString('vi-VN');

            if (percent >= 80) {
                document.getElementById('btn-download').classList.remove('hidden');
                document.getElementById('fail-message-container').classList.add('hidden');
                document.getElementById('fail-watermark').classList.add('hidden');
                confetti({ particleCount: 200, spread: 100, origin: { y: 0.6 } });
            } else {
                document.getElementById('btn-download').classList.add('hidden');
                document.getElementById('fail-message-container').classList.remove('hidden');
                document.getElementById('fail-watermark').classList.remove('hidden');
            }
        }

        function playAgain() {
            document.getElementById('review-body').innerHTML = '';
            document.getElementById('game-result').classList.add('hidden');
            document.getElementById('game-start').classList.remove('hidden');
        }

        function downloadCertificate() {
            const cert = document.getElementById('certificate');
            html2canvas(cert, { scale: 2 }).then(canvas => {
                const link = document.createElement('a');
                link.download = `ChungNhan_KiotViet_${playerName}.png`;
                link.href = canvas.toDataURL();
                link.click();
            });
        }

        // INIT
        window.onload = function() {
            renderNav();
            switchTab('cheatsheet');
        }
    </script>
</body>
</html>
