<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>E-Learning: Tổng quan Giải pháp KiotViet</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800;900&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <style>
        body { font-family: 'Inter', sans-serif; background-color: #f0f9ff; overflow-x: hidden; }
        ::-webkit-scrollbar { width: 6px; } ::-webkit-scrollbar-thumb { background: #93c5fd; border-radius: 3px; }
        .soft-glow-background { position: fixed; top: 0; left: 0; width: 100%; height: 100%; z-index: -10; background: linear-gradient(135deg, #ffffff 0%, #e0f2fe 50%, #dcfce7 100%); }
        .soft-glow-background .shape { position: absolute; filter: blur(120px); opacity: 0.6; }
        .soft-glow-background .shape1 { height: 300px; width: 300px; background: #bae6fd; border-radius: 50%; top: -50px; left: -50px; animation: moveInCircle 25s ease-in-out infinite; }
        .soft-glow-background .shape2 { height: 350px; width: 350px; background: #bbf7d0; border-radius: 50%; bottom: -50px; right: -50px; animation: moveVertical 30s ease-in-out infinite; }
        @keyframes moveInCircle { 0% { transform: rotate(0deg); } 50% { transform: rotate(180deg); } 100% { transform: rotate(360deg); } }
        @keyframes moveVertical { 0% { transform: translateY(-20%); } 50% { transform: translateY(20%); } 100% { transform: translateY(-20%); } }
        .nav-link { transition: all 0.2s ease; border-left: 3px solid transparent; }
        .nav-link:hover { color: #2563eb; background: rgba(255, 255, 255, 0.6); }
        .nav-link.active { color: #1e3a8a; border-left: 3px solid #2563eb; background: #eff6ff; font-weight: 600; box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.05); }
        /* Flashcard 3D CSS */
        .perspective-1000 { perspective: 1000px; }
        .card-inner { position: relative; width: 100%; height: 100%; transition: transform 0.6s cubic-bezier(0.4, 0, 0.2, 1); transform-style: preserve-3d; }
        .card-inner.flipped { transform: rotateY(180deg); }
        .card-face { 
            position: absolute; top: 0; left: 0; width: 100%; height: 100%; 
            -webkit-backface-visibility: hidden; backface-visibility: hidden; 
            border-radius: 1rem; box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1); background-color: white; 
        }
        .card-back { transform: rotateY(180deg); }
        .type-card { transition: all 0.3s ease; }
        .type-card:hover { box-shadow: 0 15px 30px -5px rgba(0, 0, 0, 0.1); transform: translateY(-5px); border-color: #60a5fa; }
        .chat-bubble { max-width: 90%; padding: 1rem 1.25rem; border-radius: 1rem; position: relative; font-size: 0.95rem; line-height: 1.6; box-shadow: 0 2px 4px rgba(0,0,0,0.05); }
        .chat-bubble-customer { background-color: #ffffff; color: #334155; border-bottom-left-radius: 0.25rem; border: 1px solid #e2e8f0; }
        .chat-bubble-consultant { background-color: #eff6ff; color: #1e40af; border-bottom-right-radius: 0.25rem; border: 1px solid #bfdbfe; }
        #mobile-overlay { transition: opacity 0.3s ease; }
        #sidebar { transition: transform 0.3s ease; }
        .sidebar-open #sidebar { transform: translateX(0); }
        .sidebar-open #mobile-overlay { opacity: 1; pointer-events: auto; }
        .sidebar-closed #sidebar { transform: translateX(-100%); }
        .sidebar-closed #mobile-overlay { opacity: 0; pointer-events: none; }
        @media (min-width: 768px) { .sidebar-closed #sidebar { transform: translateX(0); } }
        .certificate-container { box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04); transition: filter 0.3s ease; }
        .watermark { position: absolute; top: 50%; left: 60%; transform: translate(-50%, -50%) rotate(-30deg); font-size: 6rem; font-weight: 900; color: rgba(200, 0, 0, 0.05); pointer-events: none; z-index: 0; }
        .grayscale-filter { filter: grayscale(100%); }
        .animate-fade-in-up { animation: fadeInUp 0.5s ease-out; }
        @keyframes fadeInUp { from { opacity: 0; transform: translateY(20px); } to { opacity: 1; transform: translateY(0); } }
    </style>
</head>
<body class="text-slate-700 antialiased h-screen flex flex-col overflow-hidden sidebar-closed" id="app-body">
    <div class="soft-glow-background"><div class="shape shape1"></div><div class="shape shape2"></div></div>
    
    <!-- HEADER -->
    <header class="sticky top-0 z-50 bg-white/80 backdrop-blur-md border-b border-white/50 h-20 shadow-sm flex-shrink-0">
        <div class="max-w-screen-2xl mx-auto px-4 sm:px-6 lg:px-8 h-full">
            <div class="flex items-center justify-between h-full gap-4 lg:gap-8">
                <a href="https://kiotvietlnd.github.io/elearning/" class="flex-shrink-0 flex items-center gap-3 select-none hover:opacity-80 transition-opacity">
                    <img src="https://logo.kiotviet.vn/KiotViet-Logo-Horizontal.svg" alt="KiotViet Logo" class="h-6 lg:h-8">
                    <span class="text-slate-300 font-light text-xl lg:text-2xl">|</span>
                    <span class="font-bold text-blue-700 tracking-tight text-base lg:text-lg uppercase">E-Learning</span>
                </a>
                <nav class="hidden lg:flex flex-1 justify-end items-center gap-4">
                    <a href="https://www.kiotviet.vn/ho-tro" target="_blank" class="flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-full font-bold text-sm shadow-md hover:bg-blue-700 hover:-translate-y-0.5 transition-all"><i class="fa-solid fa-book-open-reader"></i> Kho Tài liệu HDSD</a>
                    <a href="https://www.youtube.com/@HDSDPhanmemKiotViet" target="_blank" class="flex items-center gap-2 px-4 py-2 bg-red-600 text-white rounded-full font-bold text-sm shadow-md hover:bg-red-700 hover:-translate-y-0.5 transition-all"><i class="fa-brands fa-youtube"></i> Kho Video HDSD</a>
                </nav>
                <div class="lg:hidden"><button onclick="toggleSidebar()" class="text-slate-600 hover:text-blue-700 text-2xl"><i class="fa-solid fa-bars"></i></button></div>
            </div>
        </div>
    </header>

    <div class="flex-1 flex overflow-hidden relative">
        <div id="mobile-overlay" class="fixed inset-0 bg-black/20 z-40 md:hidden" onclick="toggleSidebar()"></div>
        
        <!-- SIDEBAR -->
        <aside id="sidebar" class="absolute inset-y-0 left-0 z-50 w-80 bg-white/95 backdrop-blur-xl border-r border-white/60 shadow-2xl md:static md:bg-white/60 md:shadow-lg md:rounded-r-2xl flex flex-col transform transition-transform duration-300">
            <div class="p-5 border-b border-slate-100 flex-shrink-0">
                <div class="flex justify-between items-start mb-4 md:hidden"><img src="https://logo.kiotviet.vn/KiotViet-Logo-Horizontal.svg" alt="Logo" class="h-5"><button onclick="toggleSidebar()" class="text-slate-400"><i class="fa-solid fa-xmark text-xl"></i></button></div>
                <h2 class="font-black text-lg leading-tight mb-2 uppercase text-blue-700">Tổng quan Giải pháp</h2>
                <h3 class="font-bold text-slate-500 text-xs uppercase tracking-wider mb-2">TIẾN ĐỘ BÀI HỌC</h3>
                <div class="w-full bg-slate-200 rounded-full h-2"><div id="totalProgress" class="bg-blue-600 hover:bg-blue-700 h-2 rounded-full transition-all duration-500" style="width: 0%"></div></div>
                <div class="flex justify-between mt-1 text-[10px] text-slate-500 font-medium"><span id="completedCount">0/10</span><span>Hoàn thành</span></div>
            </div>
            <nav class="flex-1 overflow-y-auto p-3 space-y-2 custom-scrollbar">
                 <button onclick="switchTab('cheatsheet')" id="nav-cheatsheet" class="nav-link w-full text-left px-3 py-3 rounded-lg flex items-center gap-3 active"><i class="fa-solid fa-bolt text-yellow-500 w-6 text-center"></i><span class="font-bold text-sm">Cẩm nang nghiệp vụ</span></button>
                 <div class="mt-4 mb-2 px-3 text-[10px] font-bold text-slate-400 uppercase">TÌM HIỂU CHI TIẾT</div>
                 <div id="dynamic-nav-container"></div>
                 <div class="mt-4 mb-2 px-3 text-[10px] font-bold text-slate-400 uppercase">Ôn tập</div>
                 <button onclick="switchTab('all-chats')" id="nav-all-chats" class="nav-link w-full text-left px-3 py-3 rounded-lg flex items-center gap-3"><i class="fa-solid fa-comments text-pink-500 w-6 text-center"></i><span class="font-bold text-sm">Xem toàn bộ hội thoại</span></button>
                 <button onclick="switchTab('summary')" id="nav-summary" class="nav-link w-full text-left px-3 py-3 rounded-lg flex items-center gap-3"><i class="fa-solid fa-table-columns text-purple-500 w-6 text-center"></i><span class="font-bold text-sm">Bảng so sánh</span></button>
                 <button onclick="switchTab('game')" id="nav-game" class="nav-link w-full text-left px-3 py-3 rounded-lg flex items-center gap-3"><i class="fa-solid fa-gamepad text-orange-500 w-6 text-center"></i><span class="font-bold text-sm">Quiz Game</span></button>
            </nav>
            <div class="p-4 bg-slate-50 border-t border-slate-100 text-center text-[10px] text-slate-400">© KiotViet Learning & Development Department</div>
        </aside>

        <!-- MAIN CONTENT -->
        <main class="flex-1 overflow-y-auto scroll-smooth p-4 md:p-8" id="contentArea">
            <div class="max-w-5xl mx-auto pb-20" id="lessonContainer">
                
                <!-- TAB CHEATSHEET -->
                <div id="tab-cheatsheet" class="tab-content block animate-fade-in-up">
                    <div class="mb-8 text-center">
                         <span class="bg-blue-100 text-blue-700 px-3 py-1 rounded-full text-xs font-bold uppercase tracking-wider border border-blue-200">Đào tạo Sản phẩm Ngành Bán lẻ</span>
                        <h1 class="text-3xl md:text-4xl font-black text-blue-700 mt-4 leading-tight">Tổng quan Giải pháp KiotViet</h1>
                        <p class="text-slate-500 mt-3 italic text-base md:text-lg max-w-2xl mx-auto">Hệ sinh thái công nghệ giúp Bán buôn & Bán lẻ quản lý dễ dàng, bán hàng nhanh chóng và tăng trưởng doanh thu.</p>
                    </div>
                    
                    <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-12">
                        <!-- Card 1 -->
                        <div class="bg-white p-6 rounded-2xl shadow-sm border border-slate-100 hover:shadow-md transition">
                            <div class="w-12 h-12 bg-blue-100 rounded-lg flex items-center justify-center text-blue-600 text-xl mb-4"><i class="fa-solid fa-rocket"></i></div>
                            <h3 class="text-lg font-bold text-blue-900 mb-2">1. Tối ưu Vận hành</h3>
                            <ul class="text-sm text-slate-600 space-y-2 list-disc pl-4">
                                <li>Tìm kiếm hàng hóa thông minh (Tên/Mã vạch)</li>
                                <li>Bán hàng trừ kho & ghi nhận doanh thu tự động</li>
                                <li>Xử lý Trả hàng chuẩn xác dòng tiền</li>
                                <li>Tích hợp Vận chuyển & Hóa đơn điện tử</li>
                            </ul>
                        </div>
                        <!-- Card 2 -->
                        <div class="bg-white p-6 rounded-2xl shadow-sm border border-slate-100 hover:shadow-md transition">
                            <div class="w-12 h-12 bg-green-100 rounded-lg flex items-center justify-center text-green-600 text-xl mb-4"><i class="fa-solid fa-chart-pie"></i></div>
                            <h3 class="text-lg font-bold text-blue-900 mb-2">2. Tối ưu Quản lý</h3>
                            <ul class="text-sm text-slate-600 space-y-2 list-disc pl-4">
                                <li>Quản lý thông tin hàng hóa tập trung</li>
                                <li>Phân quyền nhân viên chi tiết, bảo mật</li>
                                <li>Kiểm soát Sổ quỹ & Công nợ minh bạch</li>
                                <li>Báo cáo kinh doanh tức thời trên Mobile</li>
                            </ul>
                        </div>
                        <!-- Card 3 -->
                        <div class="bg-white p-6 rounded-2xl shadow-sm border border-slate-100 hover:shadow-md transition">
                            <div class="w-12 h-12 bg-purple-100 rounded-lg flex items-center justify-center text-purple-600 text-xl mb-4"><i class="fa-solid fa-arrow-trend-up"></i></div>
                            <h3 class="text-lg font-bold text-blue-900 mb-2">3. Thúc đẩy Doanh thu</h3>
                            <ul class="text-sm text-slate-600 space-y-2 list-disc pl-4">
                                <li>Bán hàng đa kênh (Web, TMĐT: Shopee/TikTok)</li>
                                <li>Đồng bộ đơn hàng & tồn kho tự động</li>
                                <li>Tích điểm & Gửi tin nhắn chăm sóc khách (CRM)</li>
                                <li>Website bán hàng miễn phí, chuyên nghiệp</li>
                            </ul>
                        </div>
                    </div>
                </div>

                <!-- DYNAMIC TABS WILL BE INJECTED HERE -->
                
                <!-- TAB: ALL CHATS -->
                <div id="tab-all-chats" class="tab-content hidden animate-fade-in-up"></div>

                <!-- TAB: SUMMARY -->
                <div id="tab-summary" class="tab-content hidden animate-fade-in-up">
                    <h2 class="text-xl font-bold text-blue-700 mb-6 border-l-4 border-slate-400 pl-3">Bảng so sánh: Lầm tưởng & Sự thật</h2>
                    <div class="bg-white rounded-xl shadow-lg border border-slate-200 overflow-hidden">
                        <table class="w-full table-fixed border-collapse">
                            <thead>
                                <tr class="bg-slate-100 text-slate-600 text-sm uppercase tracking-wider">
                                    <th class="w-16 py-4 border-r border-slate-200 text-center">#</th>
                                    <th class="w-[45%] py-4 border-r border-slate-200 text-center text-red-600 bg-red-50/50">Lầm tưởng (Sai)</th>
                                    <th class="w-[45%] py-4 text-center text-green-600 bg-green-50/50">Sự thật (Đúng)</th>
                                </tr>
                            </thead>
                            <tbody id="summaryTableBody" class="text-sm"></tbody>
                        </table>
                    </div>
                </div>

                <!-- TAB: GAME -->
                <div id="tab-game" class="tab-content hidden animate-fade-in-up">
                    <!-- GAME START -->
                    <div id="game-start" class="text-center py-20 bg-white/60 backdrop-blur rounded-3xl border border-white/50 shadow-xl">
                        <div class="inline-block p-6 rounded-full bg-orange-100 mb-6 animate-bounce"><i class="fa-solid fa-gamepad text-5xl md:text-6xl text-orange-500"></i></div>
                        <h2 class="text-2xl md:text-3xl font-black text-slate-800 mb-4 tracking-tight">Quiz Game: Bậc Thầy Giải Pháp</h2>
                        <p class="text-slate-600 mb-6 max-w-lg mx-auto leading-relaxed text-sm md:text-base">Hệ thống sẽ hiển thị ngẫu nhiên các nhận định về tính năng.<br><strong>Đạt 80% để nhận Chứng chỉ KiotViet.</strong></p>
                        <div class="mb-8 flex justify-center"><input type="text" id="player-name" placeholder="Nhập tên của bạn..." class="px-5 py-3 rounded-lg border border-slate-300 w-full max-w-md text-center font-medium shadow-inner focus:outline-none focus:ring-2 focus:ring-blue-500"></div>
                        <div class="grid grid-cols-1 md:grid-cols-3 gap-3 max-w-3xl mx-auto px-4">
                            <button id="btn-mode-standard" onclick="startGame('standard')" class="bg-white border border-blue-200 text-blue-700 px-4 py-3 rounded-lg font-bold shadow-sm text-sm hover:bg-blue-50 transition"><div class="text-base mb-1">Tiêu Chuẩn</div><div class="text-xs font-normal text-slate-500">5 Câu hỏi ngẫu nhiên</div></button>
                            <button id="btn-mode-pro" onclick="startGame('pro')" class="bg-white border border-purple-200 text-purple-700 px-4 py-3 rounded-lg font-bold shadow-sm text-sm hover:bg-purple-50 transition"><div class="text-base mb-1">Pro</div><div class="text-xs font-normal text-slate-500">8 Câu hỏi ngẫu nhiên</div></button>
                            <button id="btn-mode-promax" onclick="startGame('promax')" class="bg-gradient-to-r from-orange-500 to-red-500 text-white px-4 py-3 rounded-lg font-bold shadow-lg text-sm hover:opacity-90 transition"><div class="text-base mb-1" id="btn-promax-text">Promax (Full)</div><div class="text-xs font-normal text-white/80">Toàn bộ 10 câu hỏi</div></button>
                        </div>
                    </div>
                    <!-- GAME PLAYING -->
                    <div id="game-playing" class="hidden max-w-2xl mx-auto py-6">
                        <div class="flex justify-between items-center mb-6 px-2">
                            <div class="text-slate-400 font-bold uppercase text-xs tracking-wider">Câu hỏi: <span id="q-progress" class="text-blue-600 text-base">1/10</span></div>
                            <div class="text-xs font-bold bg-white px-3 py-1.5 rounded-full border border-slate-200 shadow-sm text-slate-600">Score: <span id="current-score" class="text-green-600">0</span></div>
                        </div>
                        
                        <!-- GAME CARD - SIMPLE CONTAINER (NO FLIP) -->
                        <div id="game-card-container" class="w-full min-h-[300px] mb-6 relative z-10">
                            <!-- Card Body -->
                            <div id="game-card-content" class="w-full h-full bg-white rounded-3xl shadow-xl p-8 flex flex-col justify-center items-center text-center border border-slate-100 relative overflow-hidden transition-all duration-300">
                                 <div class="absolute top-0 left-0 w-full h-2 bg-gradient-to-r from-blue-400 to-green-400"></div>
                                 <!-- Question Content -->
                                 <h3 id="question-text" class="text-lg md:text-xl font-extrabold text-slate-800 leading-snug animate-fade-in-up py-4">Loading...</h3>
                                 <!-- Result Notification (Hidden by default) -->
                                 <div id="result-notification" class="hidden absolute inset-0 bg-white/95 flex flex-col justify-center items-center z-20">
                                     <!-- JS will populate this -->
                                 </div>
                            </div>
                        </div>

                        <!-- Buttons -->
                        <div class="grid grid-cols-2 gap-4">
                            <button id="btn-true" onclick="answerGame(true)" class="py-3 md:py-4 rounded-2xl bg-white border-2 border-green-100 hover:border-green-500 hover:bg-green-50 text-green-600 font-bold text-base md:text-xl shadow-sm hover:shadow-lg transition-all transform active:scale-95 group"><i class="fa-solid fa-check-circle mb-1 block text-xl md:text-2xl group-hover:scale-110 transition-transform"></i> ĐÚNG</button>
                            <button id="btn-false" onclick="answerGame(false)" class="py-3 md:py-4 rounded-2xl bg-white border-2 border-red-100 hover:border-red-500 hover:bg-red-50 text-red-600 font-bold text-base md:text-xl shadow-sm hover:shadow-lg transition-all transform active:scale-95 group"><i class="fa-solid fa-times-circle mb-1 block text-xl md:text-2xl group-hover:scale-110 transition-transform"></i> SAI</button>
                        </div>
                    </div>
                    
                    <!-- GAME RESULT -->
                    <div id="game-result" class="hidden flex flex-col items-center">
                        <div id="certificate" class="w-full max-w-4xl aspect-video bg-white shadow-2xl flex overflow-hidden certificate-container mx-auto">
                            <div class="w-1/3 bg-blue-900 flex flex-col items-center justify-center text-white p-6 relative">
                                <div class="mb-6"><i class="fa-solid fa-award text-6xl text-yellow-400"></i></div>
                                <div class="text-center z-10"><p class="uppercase tracking-widest text-[10px] opacity-70 mb-1">Cấp bởi</p><p class="font-bold text-sm leading-tight">KiotViet LND Department</p></div>
                                <div class="absolute bottom-0 left-0 w-full h-2 bg-green-500"></div><div class="absolute top-0 right-0 w-2 h-full bg-black/10"></div>
                            </div>
                            <div class="w-2/3 p-8 md:p-12 flex flex-col justify-center relative bg-white">
                                <div id="fail-watermark" class="watermark hidden">Suýt đạt</div>
                                <h1 class="text-3xl md:text-4xl font-black text-blue-900 uppercase mb-1 font-sans tracking-tight">GIẤY CHỨNG NHẬN</h1>
                                <p class="text-slate-500 italic text-sm mb-6 border-b border-slate-100 pb-4">Đã hoàn thành xuất sắc nội dung đào tạo sản phẩm</p>
                                <div class="space-y-1 mb-6"><p class="text-[10px] text-slate-400 uppercase font-bold tracking-wider">Trao tặng cho:</p><h2 class="text-2xl md:text-3xl font-bold text-blue-700 uppercase leading-tight" id="certificate-name">TÊN HỌC VIÊN</h2></div>
                                <div class="space-y-1 mb-6"><p class="text-[10px] text-slate-400 uppercase font-bold tracking-wider">Học phần:</p><h3 class="text-xl font-bold text-slate-800 uppercase">TỔNG QUAN GIẢI PHÁP KIOTVIET</h3></div>
                                <div class="flex justify-between items-end mt-auto pt-4 border-t border-slate-100">
                                    <div><p class="text-[10px] text-slate-400 uppercase font-bold">Ngày hoàn thành</p><p class="text-sm font-medium text-slate-600" id="cert-date">dd/mm/yyyy</p></div>
                                    <div class="text-right"><p class="text-[10px] text-slate-400 uppercase font-bold">Điểm số</p><p class="text-xl font-black text-green-600" id="final-score-cert">100%</p></div>
                                </div>
                            </div>
                        </div>
                        <div id="fail-message-container" class="hidden mt-6 bg-red-50 px-6 py-4 rounded-xl border border-red-100 text-center">
                            <p class="text-red-600 font-bold"><i class="fa-solid fa-triangle-exclamation mr-2"></i>Chưa đạt yêu cầu nhận chứng nhận (Cần >80%)</p>
                            <p class="text-sm text-slate-600 mt-1">Hãy ôn lại kiến thức và thử lại nhé!</p>
                        </div>
                        <div class="flex flex-wrap justify-center gap-4 mt-8 mb-12">
                            <button onclick="playAgain()" class="bg-white border-2 border-blue-600 text-blue-700 px-6 py-3 rounded-full font-bold shadow-sm hover:bg-blue-50 transition"><i class="fa-solid fa-rotate-right mr-2"></i> Chơi lại</button>
                            <button onclick="switchTab('cheatsheet')" class="bg-white border border-slate-200 text-slate-700 px-6 py-3 rounded-full font-bold shadow hover:bg-slate-50 transition flex items-center gap-2"><i class="fa-solid fa-bolt text-yellow-500"></i> Xem Cẩm nang</button>
                            <button id="btn-download" onclick="downloadCertificate()" class="bg-blue-600 text-white px-8 py-3 rounded-full font-bold shadow-lg hover:bg-blue-700 transition hidden"><i class="fa-solid fa-download mr-2"></i> Tải chứng nhận</button>
                        </div>
                        <div class="max-w-4xl mx-auto bg-white rounded-2xl shadow-lg border border-slate-200 overflow-hidden w-full">
                            <h3 class="text-xl font-bold text-blue-900 px-6 py-4 bg-slate-50 border-b border-slate-100">Chi tiết kết quả</h3>
                            <table class="min-w-full divide-y divide-slate-100"><thead class="bg-white"><tr><th class="px-6 py-4 text-center text-xs font-bold text-slate-500 uppercase">Câu hỏi</th><th class="px-6 py-4 text-center text-xs font-bold text-slate-500 uppercase w-32">Bạn chọn</th><th class="px-6 py-4 text-center text-xs font-bold text-slate-500 uppercase w-40">Kết quả</th></tr></thead><tbody id="review-body" class="bg-white divide-y divide-slate-100 text-sm"></tbody></table>
                        </div>
                    </div>
                </div>

            </div>
        </main>
    </div>

    <script>
        // DỮ LIỆU BÀI HỌC (APPROVED STEP 1 CONTENT - FULL TEXT)
        const lessonData = [
            {
                id: 1,
                title: "Tối ưu Vận hành",
                icon: "fa-solid fa-rocket",
                chat: [
                    { role: "customer", text: "Chào em. Cửa hàng anh dạo này đông khách nhưng quy trình chậm quá. Nhân viên tìm mã hàng lâu, bán xong lại phải trừ kho sổ sách, rồi xuất hóa đơn đỏ riêng nữa, rất dễ nhầm lẫn." },
                    { role: "consultant", text: "Dạ em hiểu ạ. Với nhóm <b>Giải pháp Tối ưu Vận hành</b> của KiotViet, anh sẽ xử lý được ngay vấn đề này. Tại màn hình bán hàng, nhân viên có thể tìm hàng ngay bằng tên hoặc mã vạch, hệ thống sẽ <b>tự động trừ tồn kho</b> ngay khi đơn hoàn tất." },
                    { role: "customer", text: "Thế còn việc giao hàng và hóa đơn thì sao?" },
                    { role: "consultant", text: "Tất cả trên một màn hình anh nhé. Hệ thống kết nối sẵn với các hãng vận chuyển để tạo vận đơn, đồng thời tích hợp <b>Hóa đơn điện tử</b> để phát hành ngay lập tức, không cần dùng phần mềm kế toán riêng lẻ đâu ạ." }
                ],
                cards: [
                    {
                        id: 101,
                        isTrue: false,
                        question: "Khi bán hàng, nhân viên phải tự ghi chép để trừ tồn kho thủ công sau khi giao dịch hoàn tất.",
                        wrong: "Khi bán hàng, nhân viên phải tự ghi chép để trừ tồn kho thủ công sau khi giao dịch hoàn tất.",
                        right: "Hệ thống tự động trừ tồn kho và ghi nhận doanh thu ngay khi giao dịch bán hàng hoàn tất.",
                        detail: "Giúp loại bỏ hoàn toàn sai sót do quên ghi chép và tiết kiệm thời gian vận hành."
                    },
                    {
                        id: 102,
                        isTrue: false,
                        question: "Tại màn hình bán hàng, người dùng bắt buộc phải nhớ chính xác mã sản phẩm để nhập liệu bằng tay.",
                        wrong: "Tại màn hình bán hàng, người dùng bắt buộc phải nhớ chính xác mã sản phẩm để nhập liệu bằng tay.",
                        right: "Hệ thống hỗ trợ tìm kiếm nhanh chóng thông qua tên, quét mã vạch hoặc bộ lọc thuộc tính.",
                        detail: "Nhân viên mới có thể bán hàng ngay mà không cần học thuộc mã sản phẩm."
                    },
                    {
                        id: 103,
                        isTrue: false,
                        question: "Khi khách trả hàng, hệ thống chỉ nhận lại hàng hóa chứ không cập nhật lại dòng tiền hay công nợ.",
                        wrong: "Khi khách trả hàng, hệ thống chỉ nhận lại hàng hóa chứ không cập nhật lại dòng tiền hay công nợ.",
                        right: "Quy trình trả hàng trên hệ thống tự động cập nhật lại số lượng tồn kho và điều chỉnh dòng tiền tương ứng.",
                        detail: "Đảm bảo báo cáo doanh thu và công nợ khách hàng luôn chính xác thực tế."
                    },
                    {
                        id: 104,
                        isTrue: false,
                        question: "Để ship hàng, cửa hàng phải truy cập app riêng của đơn vị vận chuyển để tạo đơn, sau đó nhập lại mã vận đơn vào KiotViet.",
                        wrong: "Để ship hàng, cửa hàng phải truy cập app riêng của đơn vị vận chuyển để tạo đơn, sau đó nhập lại mã vận đơn vào KiotViet.",
                        right: "Hệ thống tích hợp sẵn các hãng vận chuyển, cho phép tạo và theo dõi vận đơn ngay trên một nền tảng duy nhất.",
                        detail: "Tự động tính phí ship và cập nhật trạng thái giao hàng, giảm thiểu thao tác thừa."
                    }
                ]
            },
            {
                id: 2,
                title: "Tối ưu Quản lý",
                icon: "fa-solid fa-chart-pie",
                chat: [
                    { role: "customer", text: "Nghe ổn đấy. Nhưng anh lo nhất là quản lý từ xa. Sợ nhân viên biết hết giá vốn, rồi thất thoát tiền nong cuối ngày không khớp." },
                    { role: "consultant", text: "Về việc này anh yên tâm dùng nhóm <b>Giải pháp Tối ưu Quản lý</b>. Hệ thống cho phép <b>phân quyền chi tiết</b>, nhân viên thu ngân chỉ được bán hàng, không xem được giá vốn hay báo cáo lợi nhuận." },
                    { role: "customer", text: "Còn tiền thu chi hàng ngày thì sao?" },
                    { role: "consultant", text: "Mọi khoản thu chi đều được <b>Sổ quỹ</b> ghi nhận tự động. Anh có thể xem <b>Báo cáo kinh doanh</b> tức thời trên điện thoại mọi lúc mọi nơi để ra quyết định nhập hàng hay cắt giảm chi phí mà không cần đợi cuối tháng tổng hợp tay." }
                ],
                cards: [
                    {
                        id: 105,
                        isTrue: false,
                        question: "Mọi nhân viên khi đăng nhập vào hệ thống đều có quyền xem toàn bộ dữ liệu giá vốn và lợi nhuận của cửa hàng.",
                        wrong: "Mọi nhân viên khi đăng nhập vào hệ thống đều có quyền xem toàn bộ dữ liệu giá vốn và lợi nhuận của cửa hàng.",
                        right: "Hệ thống cho phép phân quyền chi tiết, đảm bảo nhân viên chỉ truy cập được các chức năng và dữ liệu cần thiết.",
                        detail: "Bảo mật thông tin kinh doanh quan trọng và giảm thiểu rủi ro gian lận."
                    },
                    {
                        id: 106,
                        isTrue: false,
                        question: "Cuối ngày, chủ cửa hàng phải tự cộng sổ sách thủ công để đối chiếu các khoản thu chi tiền mặt.",
                        wrong: "Cuối ngày, chủ cửa hàng phải tự cộng sổ sách thủ công để đối chiếu các khoản thu chi tiền mặt.",
                        right: "Mọi khoản thu chi được hệ thống ghi nhận tự động, giúp việc tổng kết sổ quỹ cuối ngày chính xác và minh bạch.",
                        detail: "Tiết kiệm thời gian kết ca và dễ dàng truy soát khi có chênh lệch."
                    },
                    {
                        id: 107,
                        isTrue: false,
                        question: "Chủ cửa hàng phải đợi nhân viên tổng hợp số liệu ra file Excel thì mới xem được báo cáo doanh thu cuối tháng.",
                        wrong: "Chủ cửa hàng phải đợi nhân viên tổng hợp số liệu ra file Excel thì mới xem được báo cáo doanh thu cuối tháng.",
                        right: "Hệ thống cung cấp báo cáo trực quan tức thời về doanh thu và lợi nhuận, hỗ trợ ra quyết định mọi lúc mọi nơi.",
                        detail: "Giúp chủ cửa hàng nắm bắt tình hình kinh doanh ngay lập tức trên điện thoại."
                    }
                ]
            },
            {
                id: 3,
                title: "Thúc đẩy Doanh thu",
                icon: "fa-solid fa-arrow-trend-up",
                chat: [
                    { role: "customer", text: "Tốt quá. Anh đang tính bán thêm trên Shopee và TikTok Shop, nhưng sợ quản lý nhiều nơi rối tung lên." },
                    { role: "consultant", text: "Đây là lúc anh cần nhóm <b>Giải pháp Thúc đẩy Doanh thu</b>. KiotViet giúp anh quản lý tập trung: Đơn hàng từ sàn TMĐT (Shopee, TikTok, Lazada) sẽ <b>tự động đồng bộ</b> về phần mềm." },
                    { role: "customer", text: "Thế còn việc chăm sóc khách cũ?" },
                    { role: "consultant", text: "Hệ thống hỗ trợ tích điểm, gửi tin nhắn Zalo/SMS chăm sóc khách hàng tự động. Anh cũng có thể tạo website bán hàng miễn phí ngay trên KiotViet để mở rộng kênh tiếp cận nữa ạ." }
                ],
                cards: [
                    {
                        id: 108,
                        isTrue: false,
                        question: "Đơn hàng phát sinh trên Shopee hoặc TikTok Shop cần được nhập liệu lại bằng tay vào KiotViet để trừ kho.",
                        wrong: "Đơn hàng phát sinh trên Shopee hoặc TikTok Shop cần được nhập liệu lại bằng tay vào KiotViet để trừ kho.",
                        right: "Đơn hàng từ các sàn TMĐT được đồng bộ tự động về KiotViet, giúp quản lý tồn kho và đơn hàng tập trung.",
                        detail: "Tránh tình trạng bán quá số lượng tồn kho thực tế và tiết kiệm nhân lực nhập liệu."
                    },
                    {
                        id: 109,
                        isTrue: false,
                        question: "Dữ liệu khách hàng chỉ dùng để lưu địa chỉ giao hàng, không hỗ trợ phân tích hay chăm sóc lại.",
                        wrong: "Dữ liệu khách hàng chỉ dùng để lưu địa chỉ giao hàng, không hỗ trợ phân tích hay chăm sóc lại.",
                        right: "Hệ thống lưu trữ lịch sử mua sắm để phân tích hành vi, hỗ trợ tích điểm và gửi tin nhắn chăm sóc cá nhân hóa.",
                        detail: "Giúp gia tăng tỷ lệ khách hàng quay lại và giá trị vòng đời khách hàng."
                    },
                    {
                        id: 110,
                        isTrue: false,
                        question: "Cửa hàng phải thuê đơn vị lập trình bên ngoài để xây dựng website và cập nhật sản phẩm thủ công.",
                        wrong: "Cửa hàng phải thuê đơn vị lập trình bên ngoài để xây dựng website và cập nhật sản phẩm thủ công.",
                        right: "KiotViet Web hỗ trợ tạo website bán hàng nhanh chóng, tự động đồng bộ sản phẩm và tồn kho với phần mềm quản lý.",
                        detail: "Giúp chủ cửa hàng sở hữu kênh bán online chuyên nghiệp với chi phí 0 đồng."
                    }
                ]
            }
        ];

        // GLOBAL VARIABLES
        const completedCards = new Set();
        const totalCards = lessonData.reduce((acc, curr) => acc + curr.cards.length, 0);

        // UI FUNCTIONS
        function toggleSidebar() {
            const body = document.getElementById('app-body');
            if (body.classList.contains('sidebar-closed')) {
                body.classList.remove('sidebar-closed');
                body.classList.add('sidebar-open');
            } else {
                body.classList.remove('sidebar-open');
                body.classList.add('sidebar-closed');
            }
        }

        function switchTab(tabId) {
            // Hide all tabs
            document.querySelectorAll('.tab-content').forEach(el => el.classList.add('hidden'));
            // Show selected tab
            const selectedTab = document.getElementById('tab-' + tabId);
            if(selectedTab) {
                selectedTab.classList.remove('hidden');
                // Re-trigger animation
                selectedTab.classList.remove('animate-fade-in-up');
                void selectedTab.offsetWidth; // trigger reflow
                selectedTab.classList.add('animate-fade-in-up');
            }

            // Update Nav Active State
            document.querySelectorAll('.nav-link').forEach(el => el.classList.remove('active'));
            const navBtn = document.getElementById('nav-' + tabId);
            if(navBtn) navBtn.classList.add('active');
            
            // Close mobile sidebar if open
            if(window.innerWidth < 768) {
                document.getElementById('app-body').classList.remove('sidebar-open');
                document.getElementById('app-body').classList.add('sidebar-closed');
            }
        }

        function updateProgress() {
            const percent = Math.round((completedCards.size / totalCards) * 100);
            document.getElementById('totalProgress').style.width = percent + '%';
            document.getElementById('completedCount').innerText = `${completedCards.size}/${totalCards}`;
        }

        // RENDER FUNCTIONS
        function renderNav() {
            const container = document.getElementById('dynamic-nav-container');
            const chatContainer = document.getElementById('tab-all-chats');
            const summaryBody = document.getElementById('summaryTableBody');
            let summaryHTML = '';
            let allChatsHTML = '<h2 class="text-xl font-bold text-blue-700 mb-6 border-l-4 border-slate-400 pl-3">Tổng hợp hội thoại</h2><div class="space-y-8 max-w-3xl mx-auto">';

            let navHTML = '';
            let contentHTML = '';

            lessonData.forEach((topic, index) => {
                // 1. Build Nav Button
                navHTML += `<button onclick="switchTab('topic-${topic.id}')" id="nav-topic-${topic.id}" class="nav-link w-full text-left px-3 py-3 rounded-lg flex items-center gap-3"><i class="${topic.icon} w-6 text-center text-blue-500"></i><span class="font-medium text-sm">${topic.title}</span></button>`;

                // 2. Build Topic Content (Chat + Cards)
                let cardsHTML = topic.cards.map(card => `
                    <div class="h-[500px] w-full perspective-1000 group">
                        <div class="card-inner w-full h-full duration-500" id="card-container-${card.id}">
                            <!-- FRONT -->
                            <div class="card-face p-6 flex flex-col justify-between items-center text-center border-2 border-slate-100 type-card bg-white">
                                <div class="w-12 h-12 bg-blue-50 rounded-full flex items-center justify-center text-blue-600 font-bold text-lg mb-2">${card.id}</div>
                                <h3 class="text-slate-700 text-lg leading-snug font-normal select-none">${card.question}</h3>
                                <div class="mt-4 flex gap-3 w-full">
                                    <button onclick="flipCard(${card.id}, true)" class="flex-1 py-3 bg-green-50 text-green-600 rounded-xl font-bold hover:bg-green-100 transition text-sm border border-green-200">ĐÚNG</button>
                                    <button onclick="flipCard(${card.id}, false)" class="flex-1 py-3 bg-red-50 text-red-600 rounded-xl font-bold hover:bg-red-100 transition text-sm border border-red-200">SAI</button>
                                </div>
                                <div class="absolute top-3 right-3 text-slate-300"><i class="fa-solid fa-rotate"></i></div>
                            </div>
                            <!-- BACK -->
                            <div class="card-face card-back"></div>
                        </div>
                    </div>`).join('');

                let chatHTML = `<div class="bg-white rounded-2xl p-6 shadow-sm border border-slate-100 mb-8"><h3 class="font-bold text-blue-800 mb-4 border-b border-slate-100 pb-2 flex items-center gap-2"><i class="fa-regular fa-comments"></i> Hội thoại: ${topic.title}</h3><div class="space-y-4">` + 
                    topic.chat.map(c => `
                        <div class="flex ${c.role === 'customer' ? 'justify-start' : 'justify-end'}">
                            <div class="chat-bubble ${c.role === 'customer' ? 'chat-bubble-customer' : 'chat-bubble-consultant'}">
                                <div class="text-[10px] font-bold opacity-70 mb-1 uppercase">${c.role === 'customer' ? 'Chủ cửa hàng' : 'KiotViet'}</div>
                                ${c.text}
                            </div>
                        </div>`).join('') + 
                    `</div></div>`;
                
                // Add to All Chats Tab
                allChatsHTML += chatHTML;

                // Add to Summary Table
                topic.cards.forEach(c => {
                    summaryHTML += `
                        <tr class="border-b border-slate-100 hover:bg-slate-50 transition">
                            <td class="py-4 text-center font-bold text-slate-400">${c.id}</td>
                            <td class="py-4 px-4 text-red-600 border-r border-slate-100 bg-red-50/20">${c.wrong}</td>
                            <td class="py-4 px-4 text-green-600 bg-green-50/20">${c.right}</td>
                        </tr>`;
                });

                // Add Topic Tab to DOM
                const topicDiv = document.createElement('div');
                topicDiv.id = `tab-topic-${topic.id}`;
                topicDiv.className = 'tab-content hidden animate-fade-in-up';
                topicDiv.innerHTML = `
                    <h2 class="text-2xl font-bold text-blue-800 mb-6 flex items-center gap-3"><i class="${topic.icon}"></i> ${topic.title}</h2>
                    ${chatHTML}
                    <h3 class="font-bold text-slate-600 mb-4 mt-8 flex items-center gap-2"><i class="fa-solid fa-layer-group"></i> Bài tập nhận định (Flashcard)</h3>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6 pb-12">${cardsHTML}</div>
                `;
                document.getElementById('lessonContainer').insertBefore(topicDiv, document.getElementById('tab-all-chats'));

            });

            container.innerHTML = navHTML;
            chatContainer.innerHTML = allChatsHTML + '</div>';
            summaryBody.innerHTML = summaryHTML;
        }

        // FLASHCARD LOGIC
        function flipCard(id, choice, prefix = '') {
            const containerId = prefix + 'card-container-' + id;
            const inner = document.getElementById(containerId);
            if (!inner) return;
            
            const backFace = inner.querySelector('.card-back');
            
            let item; lessonData.forEach(t => { const found = t.cards.find(c => c.id === id); if(found) item = found; });
            if (!item) return;

            const isCorrect = (choice === item.isTrue);
            const resultHeader = isCorrect 
                ? '<div class="mb-3 font-bold text-lg text-green-600 flex items-center justify-center gap-2"><i class="fa-solid fa-circle-check text-2xl"></i> Chính xác!</div>' 
                : '<div class="mb-3 font-bold text-lg text-red-600 flex items-center justify-center gap-2"><i class="fa-solid fa-circle-xmark text-2xl"></i> Chưa chính xác!</div>';
            
            const badgeClass = item.isTrue ? 'bg-green-100 text-green-700 border-green-200' : 'bg-red-100 text-red-700 border-red-200';
            const badgeText = item.isTrue ? 'ĐÚNG' : 'SAI'; 
            const backBorderClass = isCorrect ? 'border-green-200 bg-green-50' : 'border-red-200 bg-red-50';
            
            backFace.className = `card-face card-back p-5 border-2 flex flex-col rounded-2xl text-center ${backBorderClass}`;
            backFace.innerHTML = `
                <div class="flex flex-col h-full overflow-y-auto custom-scrollbar">
                    ${resultHeader}
                    <div class="mb-3 text-sm text-slate-500 italic px-2">"${item.question}"</div>
                    <div class="mb-4"><span class="px-4 py-1.5 rounded-full text-xs font-bold border ${badgeClass}">${badgeText}</span></div>
                    <div class="bg-white p-4 rounded-xl border border-blue-100 shadow-sm text-left flex-1">
                        <p class="text-xs text-blue-600 font-bold uppercase mb-2 flex items-center gap-2"><i class="fa-solid fa-lightbulb"></i> Sự thật là:</p>
                        <p class="text-slate-700 text-sm leading-relaxed font-medium mb-2">${item.right}</p>
                        <p class="text-slate-500 text-xs pt-2 border-t border-slate-100">${item.detail || ''}</p>
                    </div>
                    <button onclick="event.stopPropagation(); resetCard(${item.id}, '${prefix}')" class="mt-4 py-2 text-xs text-slate-400 font-bold hover:text-blue-600 uppercase tracking-wider flex items-center justify-center gap-2 transition"><i class="fa-solid fa-rotate-left"></i> Xem lại câu hỏi</button>
                </div>`;
            
            inner.classList.add('flipped');
            if (!prefix && !completedCards.has(id)) { 
                completedCards.add(id); 
                updateProgress(); 
                if(completedCards.size === totalCards) confetti({particleCount: 100, spread: 70, origin: { y: 0.6 }});
            }
        }

        function resetCard(id, prefix = '') {
            const containerId = prefix + 'card-container-' + id;
            const inner = document.getElementById(containerId);
            if(inner) inner.classList.remove('flipped');
        }

        // GAME LOGIC
        let gameQuestions = [];
        let currentQIndex = 0;
        let score = 0;
        let userAnswers = [];

        function startGame(mode) {
            const nameInput = document.getElementById('player-name').value.trim();
            if(!nameInput) { alert('Vui lòng nhập tên của bạn!'); return; }
            
            // Flatten all cards
            let allCards = [];
            lessonData.forEach(t => allCards.push(...t.cards));
            
            // Randomize Logic
            // In a real scenario we might want to randomize True/False condition too, 
            // but here data is static isTrue, so we just shuffle cards.
            // To make it interesting, let's randomly flip the statement logic for the game? 
            // - Simplified: Use static isTrue from data. 
            // - Advanced: Dynamically generate Wrong statement as Question (isTrue=False) OR Right statement as Question (isTrue=True).
            // Current Data has `question` which is usually the "Wrong" statement or a neutral statement? 
            // Looking at data: Question is usually a specific scenario. isTrue is explicitly set.
            // Let's stick to the data provided.

            allCards.sort(() => Math.random() - 0.5);

            if(mode === 'standard') gameQuestions = allCards.slice(0, 5);
            else if(mode === 'pro') gameQuestions = allCards.slice(0, 8);
            else gameQuestions = allCards; // Promax

            currentQIndex = 0;
            score = 0;
            userAnswers = [];
            
            document.getElementById('certificate-name').innerText = nameInput;
            document.getElementById('game-start').classList.add('hidden');
            document.getElementById('game-playing').classList.remove('hidden');
            document.getElementById('game-result').classList.add('hidden');
            
            loadQuestion();
        }

        function loadQuestion() {
            const q = gameQuestions[currentQIndex];
            document.getElementById('q-progress').innerText = `${currentQIndex + 1}/${gameQuestions.length}`;
            document.getElementById('current-score').innerText = score;
            document.getElementById('question-text').innerText = q.question;
            
            // Reset UI
            document.getElementById('result-notification').classList.add('hidden');
            document.getElementById('btn-true').disabled = false;
            document.getElementById('btn-false').disabled = false;
            document.getElementById('game-card-content').className = "w-full h-full bg-white rounded-3xl shadow-xl p-8 flex flex-col justify-center items-center text-center border border-slate-100 relative overflow-hidden transition-all duration-300";
        }

        function answerGame(userChoice) {
            const q = gameQuestions[currentQIndex];
            const isCorrect = (userChoice === q.isTrue);
            
            // Disable buttons
            document.getElementById('btn-true').disabled = true;
            document.getElementById('btn-false').disabled = true;

            // UI Feedback
            const resultDiv = document.getElementById('result-notification');
            resultDiv.classList.remove('hidden');
            
            if(isCorrect) {
                score += 10;
                document.getElementById('current-score').innerText = score;
                resultDiv.innerHTML = `<i class="fa-solid fa-circle-check text-6xl text-green-500 mb-4 animate-bounce"></i><h3 class="text-2xl font-bold text-green-600">CHÍNH XÁC!</h3>`;
                confetti({particleCount: 50, spread: 50, origin: { y: 0.7 }});
            } else {
                resultDiv.innerHTML = `<i class="fa-solid fa-circle-xmark text-6xl text-red-500 mb-4 animate-pulse"></i><h3 class="text-2xl font-bold text-red-600">SAI RỒI!</h3><p class="text-slate-500 mt-2">Đáp án là: ${q.isTrue ? 'ĐÚNG' : 'SAI'}</p>`;
            }

            userAnswers.push({
                q: q.question,
                choice: userChoice,
                correct: q.isTrue,
                isCorrect: isCorrect
            });

            setTimeout(() => {
                currentQIndex++;
                if(currentQIndex < gameQuestions.length) {
                    loadQuestion();
                } else {
                    endGame();
                }
            }, 1500);
        }

        function endGame() {
            document.getElementById('game-playing').classList.add('hidden');
            document.getElementById('game-result').classList.remove('hidden');
            
            const maxScore = gameQuestions.length * 10;
            const percent = (score / maxScore) * 100;
            const passed = percent >= 80;

            document.getElementById('final-score-cert').innerText = `${Math.round(percent)}%`;
            document.getElementById('cert-date').innerText = new Date().toLocaleDateString('vi-VN');
            
            const certContainer = document.getElementById('certificate');
            const failWatermark = document.getElementById('fail-watermark');
            const failMessage = document.getElementById('fail-message-container');
            const btnDownload = document.getElementById('btn-download');

            // Render Review Table
            const tbody = document.getElementById('review-body');
            tbody.innerHTML = userAnswers.map((ans, i) => `
                <tr>
                    <td class="px-6 py-4 text-slate-700">${i+1}. ${ans.q}</td>
                    <td class="px-6 py-4 text-center font-bold ${ans.choice ? 'text-green-600' : 'text-red-600'}">${ans.choice ? 'ĐÚNG' : 'SAI'}</td>
                    <td class="px-6 py-4 text-center">
                        ${ans.isCorrect ? '<span class="px-2 py-1 bg-green-100 text-green-700 rounded-full text-xs font-bold">Đạt</span>' : '<span class="px-2 py-1 bg-red-100 text-red-700 rounded-full text-xs font-bold">Sai</span>'}
                    </td>
                </tr>
            `).join('');

            if(passed) {
                certContainer.classList.remove('grayscale-filter');
                failWatermark.classList.add('hidden');
                failMessage.classList.add('hidden');
                btnDownload.classList.remove('hidden');
                confetti({particleCount: 200, spread: 100, origin: { y: 0.6 }});
            } else {
                certContainer.classList.add('grayscale-filter');
                failWatermark.classList.remove('hidden');
                failMessage.classList.remove('hidden');
                btnDownload.classList.add('hidden');
            }
        }

        function playAgain() {
            document.getElementById('game-result').classList.add('hidden');
            document.getElementById('game-start').classList.remove('hidden');
            document.getElementById('player-name').value = '';
        }

        function downloadCertificate() {
            const certNode = document.getElementById('certificate');
            html2canvas(certNode, { scale: 2 }).then(canvas => {
                const link = document.createElement('a');
                link.download = `ChungNhan_KiotViet_${new Date().getTime()}.png`;
                link.href = canvas.toDataURL();
                link.click();
            });
        }

        // INIT
        window.onload = function() {
            renderNav();
            switchTab('cheatsheet');
        }
    </script>
</body>
</html>
